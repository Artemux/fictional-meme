"use strict";function getWindowKey(windowName){return"window."+windowName+".id"}function getWindowIdByName(windowName){return stbStorage.getItem(getWindowKey(windowName))}function openWindow(windowName,url){var windowInfo,windowKey=getWindowKey(windowName),windowID=stbStorage.getItem(windowKey);if(windowID)try{windowInfo=JSON.parse(stbWindowMgr.windowInfo(windowID)),-1===windowInfo.result.url.indexOf(url)&&stbWebWindow.messageSend(windowID,"window.load",url),windowName===WINDOWS.BROWSER?(windowID=stbWindowMgr.openWebFace(url),stbStorage.setItem(windowKey,windowID)):stbWindowMgr.windowShow(windowID)}catch(e){echo(e),stbWindowMgr.openWebFace(url)}else windowID=windowName===WINDOWS.BROWSER?stbWindowMgr.openWebFace(url):stbWindowMgr.windowInit(JSON.stringify({url:url,backgroundColor:"#000"})),stbStorage.setItem(windowKey,windowID)}function openWindowHelp(path){openWindow(WINDOWS.HELP,PATH_ROOT+"public/app/help/index.html?path="+path)}function elattr(obj,attr){if(obj&&obj.nodeType&&attr&&attr instanceof Object)for(var key in attr)attr.hasOwnProperty(key)&&(obj[key]=attr[key]);return obj}function element(name,attr,data){var tag=document.createElement(name);return elattr(tag,attr),elchild(tag,data),tag}function elchild(obj,value){if(obj&&value)if(value.nodeType)obj.appendChild(value);else if(Array.isArray(value))for(var i=0;i<value.length;i++)elchild(obj,value[i]);else obj.appendChild(document.createTextNode(value));return obj}function elclear(obj){if(null!==obj&&obj.nodeName&&obj.hasChildNodes())for(;obj.hasChildNodes();)obj.removeChild(obj.firstChild);return obj}function loadScript(src,onload,onerror){var elem=document.createElement("script");elem.type="text/javascript",elem.src=src,"function"==typeof onload&&(elem.onload=onload),"function"==typeof onerror&&(elem.onerror=onerror),document.head.appendChild(elem)}function getCurrentLanguage(langList){var langEnv=JSON.parse(gSTB.GetEnv('{"varList":["language"]}')),langVal="en";return langList=langList||["en","ru","uk","de"],!langEnv.errMsg&&langEnv.result&&langEnv.result.language&&"string"==typeof langEnv.result.language&&(langEnv.result.language=langEnv.result.language.toLowerCase(),-1!==langList.indexOf(langEnv.result.language)&&(langVal=langEnv.result.language)),langVal}function getEnvList(list){var data;try{if(data=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:list}))),""!==data.errMsg)throw new Error(data.errMsg);return data.result}catch(e){echo(e)}return!1}function getEnv(name){var data=getEnvList([name]);return data!==!1&&void 0!==data[name]?data[name]:data}function setEnv(key,value){var vars={};return vars[key]=value,setEnvList(vars)}function setEnvList(hash){try{return gSTB.SetEnv(JSON.stringify(hash))}catch(e){echo(e)}return!1}function eventPrepare(event,stopBubble,label){return void 0!==event.code?!0:(event.code=event.keyCode||event.which,0===event.code?!1:(event.shiftKey&&(event.code+=1e3),event.altKey&&(event.code+=2e3),event.code===KEYS.USB_MOUNTED||event.code===KEYS.USB_UNMOUNTED?!1:(stopBubble!==!1&&event.stopPropagation(),echo(event.code+"	"+event.shiftKey+"	"+event.ctrlKey+"	"+event.altKey+"	"+event.srcElement.id+"	"+event.target.id+"	"+(label||""),"keyDown [code/shift/ctrl/alt/src/target]"),!0)))}function ajax(method,url,callback,headers,type){var hname,jdata=null,timeout=null,xhr=new XMLHttpRequest,title="AJAX "+method.toUpperCase()+" "+url;if(xhr.onreadystatechange=function(){if(4===xhr.readyState)if(clearTimeout(timeout),ajax.stop)echo(xhr.status,title),"function"==typeof callback&&callback(null,null,null);else{if(echo("status:"+xhr.status+", length:"+xhr.responseText.length,title),echo(xhr.responseText,title),"json"===type)try{jdata=JSON.parse(xhr.responseText)}catch(e){echo(e,"AJAX JSON.parse"),jdata=null}"function"==typeof callback&&callback("xml"===type?xhr.responseXML:"json"===type?jdata:xhr.responseText,xhr.status,xhr)}},xhr.open(method,url,!0),headers)for(hname in headers)headers.hasOwnProperty(hname)&&xhr.setRequestHeader(hname,headers[hname]);return xhr.send(),echo("sent",title),timeout=setTimeout(function(){xhr.abort(),echo("ABORT on timeout",title)},6e4),xhr}function imageLoader(imgList,callback){var count=1,onload=function(){imgList.length===count&&"function"==typeof callback?callback():count++};Array.isArray(imgList)&&imgList.length>0?imgList.forEach(function(item){var img=new Image;img.src=item,img.onload=onload,img.onerror=function(){throw"Image "+item+" load fail"}}):0===imgList.length&&callback()}function getStorageInfo(){var snList={},info=JSON.parse(gSTB.GetStorageInfo("{}"));Array.isArray(info.result)&&""===info.errMsg&&info.result.length>0?(info.result.forEach(function(item){item.mediaType="000022272228"===item.sn?3:item.mediaType,item.label=item.label.trim(),snList[item.sn]?snList[item.sn]++:snList[item.sn]=1}),info.result.forEach(function(item){item.label||(item.label=item.vendor+" "+item.model.replace(/\//,""),snList[item.sn]>1&&(item.label+=" #"+item.partitionNum))}),info.result.sort(function(a,b){return a.mountPath<b.mountPath?-1:1}),STORAGE_INFO=info.result):STORAGE_INFO=[];try{HDD_INFO=JSON.parse(gSTB.RDir("get_hdd_info")||"[]")}catch(e){echo(e,"get_hdd_info"),HDD_INFO=[]}echo(STORAGE_INFO,"STORAGE_INFO"),echo(HDD_INFO,"HDD_INFO")}function parseUri(str){for(var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)}),uri}function validateUrl(url,sol){var solReg="((ffmpeg|auto|rtp|rtsp|mp3|mpegps|mpegts|mp4|ifm|fm|ffrt|ffrt2|ffrt3|ffrt4)(\\s))?";return new RegExp("^"+(sol?solReg:"")+"((http|https|udp|rtp|rtsp|mms|mmsh|mmst|rtmp):\\/\\/)?@?(([a-zA-Z0-9а-яА-Я$\\-_.+!*'(),;:&=]|%[0-9a-fA-Fа-яА-Я]{2})+@)?(((25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])(\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])){3})|localhost|([a-zA-Zа-яА-Я0-9\\-\\u00C0-\\u017F]+\\.)+([a-zA-Zа-яА-Я]{2,}))(:[0-9]+)?(\\/(([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-Fа-яА-Я]{2})*(\\/([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=]|%[0-9a-fA-Fа-яА-Я]{2})*)*)?(\\?([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-Fа-яА-Я]{2})*)?(\\#([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-Fа-яА-Я]{2})*)?)?$").test(url)}function extend(target,source,override){var _target=override===!1?extend({},target):target||{};for(var prop in source)_target[prop]="object"!=typeof _target[prop]||"object"!=typeof source[prop]||Array.isArray(_target[prop])||Array.isArray(source[prop])?source[prop]:extend(_target[prop],source[prop],override);return _target}function base64Encode(data){return btoa(unescape(encodeURIComponent(data)))}function base64Decode(data){try{return decodeURIComponent(escape(atob(data)))}catch(error){echo(error,"base64Decode Error")}}function cutTextWithEllipsis(text,length){return text.length>length?text.toString().slice(0,length)+"...":text}function parseDate(dateStr){if(!dateStr)return new Date(0/0);var date=new Date(dateStr.match(/\w{3}\s\w{3}\s\d{1,2}\s\d{1,2}:\d{1,2}:\d{1,2}/)+" "+dateStr.match(/\d{4}/)),timeZone=dateStr.match(/(\w{1,4})\s+\d{4}/)[1],offset=timeZoneOffsets[timeZone];return 0!==offset.index&&date.setMinutes(date.getMinutes()+(offset.minutes||0)*offset.index-date.getTimezoneOffset()),date}function getMediaType(file){var extension=file.split(".").pop();if(extension&&-1!==configuration.registersTypes.indexOf(extension))for(var type,i=0;i<MEDIA_TYPES.length,type=MEDIA_TYPES[i];i++)if(-1!==MEDIA_EXTENSION[type].indexOf(extension))return type;return MEDIA_TYPE_NONE}function Update(events){this.bind(events),this.check_url=this.update_url="",this.checked=!1}function CBase(parent){this.name="CBase",this.handle=null,this.parent=null,this.handleInner=null,this.showAttr="block",this.baseClass="",this.prevFocus=null,this.isActive=!1,this.activeChild=null,this.isVisible=!0,this.SetParent(parent)}function CBreadCrumb(parent){CBase.call(this,parent),this.name="CBreadCrumb",this.baseClass="cbcrumb-main",this.path="",this.leftItems=3,this.rightItems=2}function CPage(parent){CBase.call(this,parent||null),this.name="CPage",this.previous=null,this.isVisible=!1}function CButtonPanel(parent){CBase.call(this,parent),this.name="CButtonPanel",this.baseClass="cbpanel-main",this.path="",this.isActive=!0}function CModal(parent){CPage.call(this,parent),this.name="CModal",this.baseClass="cmodal-main",this.showAttr="table",this.focusList=[],this.focusPos=0}function CModalBox(parent){CModal.call(this,parent),this.name="CModalBox",this.header=element("div",{className:"cmodal-header"}),this.content=element("div",{className:"cmodal-content"}),this.footer=element("div",{className:"cmodal-footer"})}function CModalHint(parent,data,time,isForced){if(data){CModalBox.call(this,parent),this.name="CModalHint";var self=this;this.SetHeader(),this.SetContent(data),this.SetFooter(),this.onHide=function(){self.Free()},this.onClick=function(){self.Show(!1)},this.Init(),this.Show(!0),isForced!==!0&&(this.EventHandler=function(event){self.Show(!1),self.timer&&clearTimeout(self.timer),event.preventDefault()}),time&&(this.timer=setTimeout(function(){self.Show(!1)},time||5e3))}}function CModalAlert(parent,title,data,btnExitTitle,btnExitClick){if(data){CModalBox.call(this,parent),this.name="CModalAlert";var self=this;this.bpanel=new CButtonPanel,this.bpanel.Init(CMODAL_IMG_PATH),this.bpanel.Add(KEYS.EXIT,"exit.png",btnExitTitle||"",function(){"function"==typeof btnExitClick&&btnExitClick.call(self),self.Show(!1)}),this.SetHeader(title),this.SetContent(data),this.SetFooter(this.bpanel.handle),this.onHide=function(){elclear(self.bpanel.handle),delete self.bpanel,self.Free()},this.EventHandler=function(e){eventPrepare(e,!0,this.name)&&self.bpanel.EventHandler(e)},this.Init(),this.Show(!0)}}function CModalConfirm(parent,title,data,btnExitTitle,btnExitClick,btnOKTitle,btnOKClick){CModalAlert.call(this,parent,title,data,btnExitTitle,btnExitClick),this.name="CModalConfirm";var self=this;this.bpanel.Add(KEYS.OK,"ok.png",btnOKTitle,function(){self.Show(!1),"function"==typeof btnOKClick&&(btnOKClick.call(self),btnOKClick=null)})}function CCheckBox(parent,parameters){var parentNode,_default=!!parameters.checked,self=this;if(CBase.call(this,parent||null),this.parameters=parameters||{},this.parameters.attributes=parameters.attributes||{},this.name=parameters.name||"input",this.type=this.tagName="checkbox",this.style=parameters.style||"",this.events=parameters.events||{},void 0===(parentNode=parameters.parent)){if(void 0===parameters.element)throw"parentNode or element parameter must be specified";parentNode=parameters.element.parentNode}this.bind(this.events),this.IsChanged=function(){return _default!==self.IsChecked()},this.Init(parentNode)}function CInput(parent,parameters){var _default="",self=this;if(this.parameters=parameters,this.attributes={input:{className:"cinput-input"},hint:{className:"cinput-hint cinput-input"},icon:{className:"cinput-icon"},wrapper:{className:"cinput-wrapper"},"text-wrapper":{className:"cinput-text-wrapper"}},this.SetAutocomplete(parameters.autocomplete),this.FoldedClass="folded",void 0!==parameters.attributes&&extend(this.attributes,parameters.attributes),parameters.folded===!0&&(this.attributes.wrapper.className+=" "+this.FoldedClass),void 0!==parameters.style&&(this.attributes.wrapper.className+=" "+parameters.style),this.events=parameters.events||{},CBase.call(this,parent||null),this.bind(this.events),this.type="input",this.name=parameters.name||"input",!(this.parentNode=parameters.parent)){if(void 0===parameters.input)throw"parent or input parameter must be specified";this.parentNode=parameters.input.parentNode}this.parameters.icons=this.parameters.icons||[],this.icons={},self.IsChanged=function(){return _default!==self.GetValue()},self.GetDefault=function(){return _default},self.SetDefault=function(def){_default=def},this.Init(this.GenerateHandle()),elchild(this.parentNode,this.handle)}function CFilterInput(parent,parameters){parameters=extend({style:"main-filter-input",icons:[{name:"ico_search",type:"left",style:"black_search"},{name:"ico_search2",type:"left",style:"white_search"},{name:"f4",click:function(){this.Fold(!this.IsFolded(),!0),this.trigger("onKey")}}]},parameters),CInput.call(this,parent||null,parameters)}function CScrollList(parent){CBase.call(this,parent),this.name="CScrollList",this.baseClass="cslist-main",this.multipleSelection=!0,this.activeItem=null,this.states={},this.manageFocus=!0,this.defaultParams={hidden:!1,marked:!1,disabled:!1,focused:!1,href:"#",self:this,manageFocus:!0,oncontextmenu:EMULATION?null:function(){return!1},onclick:function(){return this.self.Focused(this,!0),!1},onmouseover:function(){return this.self.Focused(this,!0),!1}},this.defaultFilter={hidden:!1,disabled:!1},this.scrollMode=2,this.RENDER_MODE_SINGLE=1,this.RENDER_MODE_BULK=2,this.renderMode=this.RENDER_MODE_SINGLE,this.fragment=document.createDocumentFragment()}function CSimpleSelect(parent,parameters){this.parameters=parameters||{},this.tagName="SELECT",this.attributes={content:{className:"csimple-select-content"},left_arrow:{className:"csimple-select-arrow left"},right_arrow:{className:"csimple-select-arrow right"},wrapper:{className:"csimple-select-wrapper",tabIndex:"1"},content_wrapper:{className:"csimple-content-wrapper"},hint:{className:"csimple-select-hint csimple-select-content"}},this.style=parameters.style||"",this.type="select",void 0!==parameters.attributes&&extend(this.attributes,parameters.attributes),this.bind(parameters.events||{}),CBase.call(this,parent||null),(this.parentNode=parameters.parent)||(this.parentNode=void 0===parameters.content?element("div"):parameters.content.parentNode)}function CSelectBox(parent,parameters){CSimpleSelect.call(this,parent||null,parameters),this.attributes.wrapper.className+=" cselect-box",this.Init(this.GenerateHandle());var _selectedIndex,_default,_data=parameters.data||[],idField=parameters.idField||"id",nameField=parameters.nameField||"name",_autocomplete="",self=this;this.name=parameters.name||"CSelectBox",this.dropdown=new CSelectDropdown(this,{select:this,scrollMode:2,container:parameters.container}),this.SetData=function(data){if(0===data.length)throw"data cannot be empty";_data=data||[],data.length-1<_selectedIndex&&(_selectedIndex=data.length-1),self.RefreshContent(),self.trigger("dataChanged")},this.GetNameField=function(){return nameField},this.GetIdField=function(){return idField},this.GetData=function(){return _data},this.Autocomplete=function(keyCode){var find=!1,text="";if(text=keyCode===KEYS.BACK?_autocomplete.slice(0,-1):_autocomplete+String.fromCharCode(keyCode).toLowerCase(),""!==text){for(var el,i=0;i<_data.length,el=_data[i];i++)if("object"==typeof el&&(el=el[nameField]),0===el.toLowerCase().indexOf(text)){this.SetIndex(i),find=!0;break}find===!0&&(self.handle.classList.add("autocomplete"),_autocomplete=text),text=this.GetLabel().substr(0,_autocomplete.length),self.SetHint(text)}else self.ClearAutocomplete()},this.ClearAutocomplete=function(){self.handle.classList.remove("autocomplete"),self.SetHint(_autocomplete="")},this.GetSelected=function(){return _data[_selectedIndex]},this.Next=function(){_selectedIndex<_data.length-1&&this.SetIndex(++_selectedIndex)},this.Previous=function(){0!==_selectedIndex&&this.SetIndex(--_selectedIndex)},this.GetValue=function(){var selected=self.GetSelected();return"object"==typeof selected?selected[idField]:selected},this.GetLabel=function(){var selected=self.GetSelected();return"object"==typeof selected?selected[nameField]:selected},this.RefreshContent=function(){return self.SetContent(self.GetLabel()),self.value=self.GetValue(),1===self.GetData().length?(self.DisableElement(self.leftArrow,!0),void self.DisableElement(self.rightArrow,!0)):void(0===self.GetIndex()?(self.DisableElement(self.leftArrow,!0),self.DisableElement(self.rightArrow,!1)):self.GetIndex()===self.GetData().length-1?(self.DisableElement(self.rightArrow,!0),self.DisableElement(self.leftArrow,!1)):(self.DisableElement(self.leftArrow,!1),self.DisableElement(self.rightArrow,!1)))},this.SelectById=function(id,quiet){for(var i=0;i<_data.length;i++)if(_data[i][idField]===id)return self.SetIndex(i,quiet),i},this.IsChanged=function(){return _selectedIndex!==_default},this.GetIndex=function(){return _selectedIndex},this.SetIndex=function(index,quiet){var old=this.GetSelected();self.ClearAutocomplete(),_selectedIndex=void 0===index||index>=_data.length?0:index,self.RefreshContent(),quiet!==!0&&self.trigger("onChange",{"new":self.GetSelected(),old:old})},this.SetIndex(parameters.selected,!0),void 0!==parameters.selectedId&&this.SelectById(parameters.selectedId,!0),_default=_selectedIndex,this.EventHandler=function(event){switch(eventPrepare(event),event.stopped=!0,event.code){case KEYS.FRAME:this.dropdown.Show(!this.dropdown.isVisible,!1);break;case KEYS.LEFT:case KEYS.RIGHT:this.dropdown.isVisible||(CSimpleSelect.prototype.EventHandler.call(this,event),this.dropdown.EventHandler(event));break;case KEYS.OK:case KEYS.UP:case KEYS.DOWN:case KEYS.PAGE_UP:case KEYS.PAGE_DOWN:event.stopped=!1,this.dropdown.isVisible&&(this.dropdown.EventHandler(event,null,!1),event.stopped=!0);break;case KEYS.EXIT:this.dropdown.isVisible?this.dropdown.Show(!1,!1):event.stopped=!1;break;default:event.stopped=!1}},this.handle.onkeypress=function(event){event.ctrlKey!==!0&&event.altKey!==!0&&self.Autocomplete(event.charCode)},this.dropdown.Refresh(),this.bind("onBlur",function(){self.ClearAutocomplete()})}function CSelectDropdown(parent,options){CScrollList.call(this,parent||null,options);var self=this;this.isVisible=!1,this.manageFocus=!1,this.multipleSelection=!1,this.attributes={wrapper:{className:"csimple-select-dropdown"},element:{className:"dropdown-element"}},this.select=null,this.baseClass="csimple-dropdown-main",CSelectDropdown.parameters.forEach(function(key){void 0!==options[key]&&(self[key]=options[key])}),this.base=this.select.handle,this.Init(element("div",this.attributes.wrapper)),this.base.parentNode.appendChild(this.handle),this.select.bind("dataChanged",function(){self.Refresh()}),this.select.bind("onChange",function(){if(self.isVisible){var item=self.handleInner.children[this.GetIndex()];self.SetPosition(item,!0,!1),self.Focused(item,!0),self.Marked(item,!0)}}),this.select.bind("onBlur",function(){setTimeout(function(){self.Show(!1,self.manageFocus)},100)}),this.select.handle.addEventListener("click",function(event){self.Show(!self.isVisible,self.manageFocus),event.stopPropagation(),event.stopImmediatePropagation(),event.preventDefault()}),this.Show(!1,self.manageFocus)}function CIntervalBox(parent,parameters){var _default,self=this,_value=0;CSimpleSelect.call(this,parent||null,parameters),this.attributes.wrapper.className+=" cinterval-box",void 0===parameters.align&&(this.attributes.content.className+=" center"),void 0!==parameters.contentStyle&&(this.attributes.content.className+=" "+parameters.contentStyle),this.Init(this.GenerateHandle()),this.name=parameters.name||"input",this.type="interval",this.parameters=parameters,void 0!==parameters.align&&(this.content.className+=" "+parameters.align,this.content.style.textAlign=parameters.align),this.max=parameters.max,this.min=parameters.min,this.interval=parameters.interval||1,void 0!==parameters.value?_value=void 0!==this.max&&parameters.value>this.max?this.max:void 0!==this.min&&parameters.value<this.min?this.min:parameters.value:void 0!==this.min?_value=this.min:void 0!==this.max&&(_value=this.max),_default=_value=parseInt(_value),this.SetValue=function(value){_value=parseInt(value),self.SetContent(_value),self.trigger("onChange",_value)},this.GetValue=function(){return _value},this.Next=function(){if(CSimpleSelect.prototype.Next.call(),void 0!==self.max){if(!(_value+self.interval<=self.max))return;_value+=self.interval}else _value+=self.interval;self.RefreshContent(),self.trigger("onNext",self.GetValue()),self.trigger("onChange",self.GetValue())},this.Previous=function(){if(CSimpleSelect.prototype.Next.call(),void 0!==self.min){if(!(_value-self.interval>=self.min))return;_value-=self.interval}else _value-=self.interval;self.RefreshContent(),self.trigger("onPrevious",self.GetValue()),self.trigger("onChange",self.GetValue())},this.RefreshContent=function(){this.SetContent(self.GetValue()),self.value=self.GetValue(),self.DisableElement(self.leftArrow,!1),self.DisableElement(self.rightArrow,!1),void 0!==self.min&&_value-self.interval<self.min&&self.DisableElement(self.leftArrow,!0),void 0!==self.max&&_value+self.interval>self.max&&self.DisableElement(self.rightArrow,!0)},this.IsChanged=function(){return _value!==_default},this.RefreshContent()}function mainEventListener(event){if(eventPrepare(event,!1,"mainEventListener "+currCPage.name)){if(currCPage&&"function"==typeof currCPage.EventHandler&&currCPage.EventHandler(event))return event.preventDefault(),void event.stopPropagation();switch(event.code){case 220:echo("\n\n\n<html><head>\n"+document.head.innerHTML+"\n</head>\n<body>\n"+document.body.innerHTML+"\n</body>\n</html>\n");break;case KEYS.POWER:stbWebWindow.messageSend(getWindowIdByName(WINDOWS.PORTAL)||getWindowIdByName(WINDOWS.PORTALS_LOADER),"portal.standbyMode","");break;case KEYS.WEB:stbWindowMgr.LoadUrl("http://www.google.ru"),stbWindowMgr.raiseWebWindow()}}}function init_menu(){var dict;list.main=[],back_index=0,back_element=[0],dict=[{name:_("Network"),rId:"Network",className:"network_settings",func:network_load},{name:_("Servers"),rId:"Servers",className:"servers",func:servers_load},{name:_("Video"),rId:"Video",className:"video",func:video_load},{name:_("Audio"),rId:"Audio",className:"audio",func:audio_load},{name:_("Advanced settings"),rId:"AdvancedSettings",className:"advSet",func:advSet_load},{name:_("Keyboard layout"),rId:"KeyboardLayout",className:"keyboard_layout",func:keyboard_layout_load},{name:_("Network info"),rId:"NetworkInfo",className:"net_info",func:netInfo_load},{name:_("Device info"),rId:"DeviceInfo",className:"dev_info",func:devInfo_load},{name:_("Reboot portal"),rId:"RebootPortal",className:"reload",func:reload_message},{name:_("Reboot device"),rId:"RebootDevice",className:"reboot",func:reboot_message},{name:_("Reset settings"),rId:"ResetSettings",className:"reset",func:reset_message},{name:_("Clear user data"),rId:"ClearUserData",className:"clear_ico",func:clear_message},{name:_("Software update"),rId:"SoftwareUpdate",className:"update",func:function(){UpdatePage.Show()}}],dict.forEach(function(menuItem){RULES[menuItem.rId]&&list.main.push(menuItem)}),SettingsPage.Init(document.body.querySelector(".page.main")),SettingsPage.BCrumb.Reset(),SettingsPage.BCrumb.SetName(_("System settings")),SettingsPage.BCrumb.Push("","settings_blue.png",""),UpdatePage.Init(),generate(list.main),UpdateFooter()}function generate(arr){var ico,text,obj=[],div=element("div",{className:"list"});sett_changes=0,navigation.element=back_element[back_index],div.onscroll=function(){scroll_position=div.scrollTop},document.getElementById(as.page_list[as.page]).style.display="none",elclear(document.getElementById(as.page_list[as.page]));for(var i=0;i<arr.length;i++)ico=element("div",{className:"ico"}),text=element("div",{className:"text",innerHTML:"<div>"+arr[i].name+"</div>"}),obj[i]=element("a",{className:arr[i].className,href:"#",onclick:arr[i].func,number:i,onmouseover:mouse_over},[ico,text]);elchild(div,obj),elchild(document.getElementById(as.page_list[as.page]),div),navigation.elements=div.getElementsByTagName("a"),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",document.getElementById(as.page_list[as.page]).style.display="block",navigation.elements[navigation.element].focus(),scroll_position>0&&navigation.elements[navigation.element].scrollIntoView()}function UpdateFooter(additionally,volumeUp,volumeDown){SettingsPage.bpanel.Rename(SettingsPage.bpanel.AdditionalBtn,_("More")),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.AdditionalBtn,additionally!==!0),SettingsPage.bpanel.Rename(SettingsPage.bpanel.SaveBtn,_("Save")),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!0),SettingsPage.bpanel.Rename(SettingsPage.bpanel.VolumeUp,_("Up")),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,volumeUp!==!0),SettingsPage.bpanel.Rename(SettingsPage.bpanel.VolumeDown,_("Down")),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,volumeDown!==!0)}function generate_table(arr){var obj=[],d=document.getElementById(as.page_list[as.page]);elclear(d);for(var i=0;i<arr.length;i++)if(arr[i].title||0==arr[i].title||1==arr[i].title)if(arr[i].value||0==arr[i].value||1==arr[i].value){var left=element("td",{className:"left"},arr[i].title),right=element("td",{className:"right"},arr[i].value);obj[i]=element("tr",{},[left,right])}else{var left=element("td",{className:"info_header",colSpan:"2"},arr[i].title);obj[i]=element("tr",{},left)}else{var right=element("td",{className:"center",colSpan:"2"},arr[i].value);obj[i]=element("tr",{},right)}var table=element("table",{},obj),div=element("div",{className:"box"},table);elchild(d,div),d.style.display="block",d.focus()}function generate_elements(arr,generate_only,no_component){var input,obj=[],inputs=[],d=element("div",{className:"list"}),change=function(){this.IsChanged()===!0?(this._is_changed||sett_changes++,this._is_changed=!0):this._is_changed&&(this._is_changed=!1,sett_changes--),("advSet"!==SettingsPage.BCrumb.Tip().iid||0!==navigation.element)&&SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,0===sett_changes)};generate_only||(navigation.elements=[]);for(var i=0;i<arr.length;i++){var text=element("div",{className:"vertical"},element("div",{className:"title",innerHTML:arr[i].title})),elem=element("div",{className:"control"});switch(arr[i].element){case"ip":var input2,input3,input4,div=element("div");""==arr[i].value&&(arr[i].value="...");var ip=arr[i].value.split(".");input=element("input",{type:"text",onfocus:ip_onFocus,oninput:check_leng_ip,maxLength:"3",value:""!=ip[0]?ip[0]:0,"default":""!=ip[0]?ip[0]:0,className:"elements ip sub_elements"+i}),input2=element("input",{type:"text",onfocus:ip_onFocus,oninput:check_leng_ip,maxLength:"3",value:""!=ip[1]?ip[1]:0,"default":""!=ip[0]?ip[1]:0,className:"ip sub_elements"+i}),input3=element("input",{type:"text",onfocus:ip_onFocus,oninput:check_leng_ip,maxLength:"3",value:""!=ip[2]?ip[2]:0,"default":""!=ip[0]?ip[2]:0,className:"ip sub_elements"+i}),input4=element("input",{type:"text",onfocus:ip_onFocus,oninput:check_leng_ip,maxLength:"3",value:""!=ip[3]?ip[3]:0,"default":""!=ip[0]?ip[3]:0,className:"ip sub_elements"+i}),arr[i].no_save!==!0&&(inputs.push(input),inputs.push(input2),inputs.push(input3),inputs.push(input4)),elchild(div,[input," . ",input2," . ",input3," . ",input4]),elchild(elem,div);break;case"select":var selected,j;if(no_component===!0){if(select=element("select",{className:"elements"}),arr[i].onChange&&(select.onchange=arr[i].onChange,select.specChange="true"),arr[i].no_save!==!0&&inputs.push(select),arr[i].option)for(var j=0;j<arr[i].option.length;j++){var s=element("option",{value:arr[i].option[j].value},arr[i].option[j].title);arr[i].option[j].value==arr[i].selected&&(s.selected=!0,void 0===arr[i]["default"]&&(s["default"]=!0)),void 0!==arr[i]["default"]&&arr[i]["default"]==arr[i].option[j].value&&(s["default"]=!0),elchild(select,s)}elchild(elem,select)}else{for(j=0;j<arr[i].option.length;j++)arr[i].option[j].value==arr[i].selected&&(selected=j);input=new CSelectBox(SettingsPage,{parent:elem,data:arr[i].option,idField:"value",nameField:"title",selected:selected,style:"elements",events:{onChange:function(onChange,no_save){return function(){no_save!==!0&&change.call(this,arguments),"function"==typeof onChange&&onChange.call(this,arguments)}}(arr[i].onChange,arr[i].no_save)}})}break;case"button":input=element("input",{type:"button",value:arr[i].value,onclick:arr[i].onClick,className:"elements wide500"}),arr[i].no_save!==!0&&inputs.push(input),elchild(elem,input);break;case"input":input=element("input",{type:arr[i].type,"default":arr[i].value,value:arr[i].value,className:"elements wide500"}),arr[i].id&&(input.id=arr[i].id),arr[i].no_save!==!0&&inputs.push(input),arr[i].disabled&&(input.disabled=!0,input.className="elements wide500 disabled"),elchild(elem,input);break;case"checkbox":var label=element("label");label.setAttribute("for",arr[i].id?arr[i].id:"checkbox-id"+i),input=element("input",{type:"checkbox",className:"elements",id:arr[i].id?arr[i].id:"checkbox-id"+i,code:arr[i].code?arr[i].code:"",onchange:arr[i].onChange?arr[i].onChange:function(){}}),arr[i].no_save!==!0&&inputs.push(input),("true"==arr[i].checked||arr[i].checked===!0)&&(input.checked=!0),input["default"]=!!input.checked,elchild(elem,[input,label]);break;case"input_spec":if(no_component===!0){var div1=element("div",{className:"decrease",onclick:arr[i].left,number:i}),div2=element("div",{className:"increase",onclick:arr[i].right,number:i});input=element("input",{className:"elements arrow",type:"text","default":arr[i].value,value:arr[i].value,interval:arr[i].interval,maxsize:arr[i].maxsize,minsize:arr[i].minsize?arr[i].minsize:0}),arr[i].no_save!==!0&&inputs.push(input),input.readonly=!0,input.disabled=!0,arr[i].onChange&&(input.onchange=arr[i].onChange),elchild(elem,[div1,div2,input])}else input=new CIntervalBox(SettingsPage,{parent:elem,max:arr[i].maxsize,min:arr[i].minsize||0,interval:arr[i].interval,value:arr[i].value,style:"elements",events:{onChange:function(onChange,no_save){return function(){no_save!==!0&&change.call(this,arguments),"function"==typeof onChange&&onChange.call(this,arguments)}}(arr[i].onChange,arr[i].no_save),onNext:arr[i].right,onPrevious:arr[i].left}});break;case"input_check":if(no_component===!0){var div1=element("div",{className:"decrease",onclick:arr[i].left,number:i}),div2=element("div",{className:"increase",onclick:arr[i].right,number:i});input=element("input",{className:"elements check",type:"text","default":arr[i].value,value:arr[i].value,interval:arr[i].interval,maxsize:arr[i].maxsize,minsize:arr[i].minsize?arr[i].minsize:0}),arr[i].no_save!==!0&&inputs.push(input),input.readonly=!0,input.disabled=!0,arr[i].onChange&&(input.onchange=arr[i].onChange),elchild(elem,[div1,div2,input])}else{var style;style="servers_additional_portals"===SettingsPage.BCrumb.Tip().iid?"elements small-cinterval-box":"elements",input=new CIntervalBox(SettingsPage,{parent:elem,max:arr[i].maxsize,min:arr[i].minsize||0,interval:arr[i].interval,value:arr[i].value,style:style,events:{onChange:function(onChange,no_save){return function(){no_save!==!0&&change.call(this,arguments),"function"==typeof onChange&&onChange.call(this,arguments)}}(arr[i].onChange,arr[i].no_save),onNext:arr[i].right,onPrevious:arr[i].left}})}}navigation.elements.push(input),obj[i]=element("a",{href:"#",className:"item",onmouseover:mouse_over_element,number:i},[text,elem]),void 0!==arr[i].sub_id&&(obj[i].id=arr[i].sub_id)}return inputs.forEach(function(input){input.onchange=function(onChange){return function(){var changed=!1;switch("function"==typeof onChange&&onChange.call(this),sett_changes=sett_changes||0,echo(this.tagName),this.tagName.toLowerCase()){case"select":"video_additionally"===SettingsPage.BCrumb.Tip().iid&&0===navigation.element&&alert_framerate_msg&&(new CModalAlert(SettingsPage,_("Notice"),_("During file playback, video output frame rate will be automatically adjusted<br/>according to played content.<br />Notes:<br />- works only with HDMI 720p/1080i/1080p video modes<br />- make sure your TV supports required video mode"),_("Close")),alert_framerate_msg=!1),"video_additionally"===SettingsPage.BCrumb.Tip().iid&&1===navigation.element&&alert_hdmi_msg&&(new CModalAlert(SettingsPage,_("Notice"),_('<span style="color: red">With option enabled in DIV mode<br/>HDMI audio will be missing</span>'),_("Close")),alert_hdmi_msg=!1),selected=this.options[this.selectedIndex],echo(selected.value,"Value"),echo(selected["default"],"Default"),changed=!(selected.selected===!0&&selected["default"]===!0);
break;case"input":switch(this.type){case"text":changed=this.value!=this["default"];break;case"password":changed=this.value!=this["default"];break;case"checkbox":changed=this.checked!=this["default"]}}changed===!0?(this._is_changed||sett_changes++,this._is_changed=!0):this._is_changed&&(this._is_changed=!1,sett_changes--),layoutOrderChanged||SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,0===sett_changes)}}(input.onchange),"input"!==input.tagName.toLowerCase()||"text"!==input.type&&"password"!==input.type||(input.onkeyup=input.onchange)}),generate_only!==!0&&(sett_changes=0,document.getElementById(as.page_list[as.page]).style.display="none",elclear(document.getElementById(as.page_list[as.page])),elchild(d,obj),elchild(document.getElementById(as.page_list[as.page]),d),navigation.pre_elements=d.getElementsByClassName("item"),navigation.element=0,navigation.oldClass=navigation.pre_elements[navigation.element].className,navigation.pre_elements[navigation.element].className+=" active",document.getElementById(as.page_list[as.page]).style.display="block",navigation.pre_elements[navigation.element].focus(),navigation.elements[navigation.element].focus()),obj}function load_main(){back_function=function(){},to_save="",save_function=function(){},back_element[back_element[0]],back_index=0,navigation.element=back_element[0],SettingsPage.BCrumb.Reset(),SettingsPage.BCrumb.SetName(_("System settings")),SettingsPage.BCrumb.Push("","settings_blue.png","","load_main"),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.MAIN,UpdateFooter(),generate(list.main||[])}function network_load(){var dict;(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),to_save="",save_function=function(){},back_function=load_main,"network"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_lan.png",_("Network"),"network"),elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.LIST,0==list.lan.length&&(list.lan=[],dict=[{name:_("Wired (Ethernet)"),rId:"Network/Wired(Ethernet)",className:"ico_folder",func:wired_load},{name:_("PPPoE"),rId:"Network/PPPoE",className:"ico_folder",func:pppoe_load},{name:_("Wireless (Wi-Fi)"),rId:"Network/Wireless(Wi-Fi)",className:"ico_folder",func:wifi_load}],dict.forEach(function(menuItem){RULES[menuItem.rId]&&list.lan.push(menuItem)})),UpdateFooter(),generate(list.lan)}function servers_load(){var dict;(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),back_function=load_main,"servers"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_servers.png",_("Servers"),"servers"),elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.LIST,0==list.servers.length&&(list.servers=[],dict=[{name:_("General"),rId:"Servers/General",className:"ico_folder_serversset",func:servers_general_load},{name:_("Portals"),rId:"Servers/Portals",className:"ico_folder_serversset",func:servers_portals_load},{name:_("More"),rId:"Servers/More",className:"ico_folder_serversset",func:servers_additionally_load}],dict.forEach(function(menuItem){RULES[menuItem.rId]&&list.servers.push(menuItem)})),UpdateFooter(),generate(list.servers)}function servers_general_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=servers_general_save,back_function=servers_load,read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["ntpurl"]}))),"servers_general"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_serversset.png",_("General"),"servers_general"),elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS;var arr=[{element:"input",type:"text",title:_("NTP server:"),value:read.result.ntpurl}];UpdateFooter(),generate_elements(arr)}function servers_portals_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=servers_portals_save,back_function=servers_load,read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["portal1","portal2"]}))),read.result.portal1=decodeURI(read.result.portal1),read.result.portal2=decodeURI(read.result.portal2),"servers_portals"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_serversset.png",_("Portals"),"servers_portals"),elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS;var file=gSTB.LoadUserData("portals.json");if(""===file){portals={enable:!1,time:60,def:0,portals:[]};for(var i=0;8>i;i++)portals.portals[i]={},portals.portals[i].name="",portals.portals[i].url="",portals.portals[i].enable=!1}else{portals=JSON.parse(file),echo(portals,portals);for(var i=0;8>i;i++)"object"!=typeof portals.portals[i]&&(portals.portals[i]={},portals.portals[i].name="",portals.portals[i].url="",portals.portals[i].enable=!1)}var arr=[{element:"input",type:"text",title:_("Portal 1 URL"),value:read.result.portal1,disabled:portals.enable},{element:"input",type:"text",title:_("Portal 2 URL"),value:read.result.portal2,disabled:portals.enable}];new RegExp(AuraHD_ID).test(MODEL_TYPE)&&RULES["Servers/Portals/More"]?UpdateFooter(!0):UpdateFooter(),generate_elements(arr)}function servers_additional_portals_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),checkInp=1,butUdDownDisable=!1,save_function=servers_additional_portals_save,back_function=servers_portals_load,read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["portal1","portal2","useExtPortalsPage"]}))),read.result.portal1=decodeURI(read.result.portal1),read.result.portal2=decodeURI(read.result.portal2),"servers_additional_portals"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","settings.png",_("More"),"servers_additional_portals"),elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS;var file=gSTB.LoadUserData("portals.json");if(""===file){portals={enable:!1,time:60,def:0,portals:[]};for(var i=0;8>i;i++)portals.portals[i]={},portals.portals[i].name="",portals.portals[i].url="",portals.portals[i].enable=!1}else{portals=JSON.parse(file),echo(portals,portals);for(var i=0;8>i;i++)"object"!=typeof portals.portals[i]&&(portals.portals[i]={},portals.portals[i].name="",portals.portals[i].url="",portals.portals[i].enable=!1)}var portLoadDelayArray=[{title:"1"+_("sec."),value:"1"},{title:"5"+_("sec."),value:"5"},{title:"10"+_("sec."),value:"10"},{title:"30"+_("sec."),value:"30"},{title:"1"+_("min."),value:"60"},{title:"2"+_("min."),value:"120"},{title:_("Without auto start"),value:"0"}],arr=[{element:"checkbox",checked:portals.enable,title:_("Use portals:"),onChange:servers_hideElement},{element:"select",title:_("Default portal:"),option:checkDefaultPortals(),selected:portals.def},{element:"select",title:_("Portal load delay:"),option:portLoadDelayArray,selected:portals.time||60},{element:"input_check",type:"text",title:_("Portal:"),value:1,left:check_input_left,right:check_input_right,interval:1,maxsize:8,minsize:1,no_save:!0},{element:"checkbox",checked:portals.portals[0].enable,title:_("Use portal")+" 1:",id:"chPortal_1",sub_id:"sub_chPortal_1",onChange:refreshDefaultPortals},{element:"input",type:"text",title:_("Name")+" 1:",value:portals.portals[0].name,id:"namePortal_1",sub_id:"sub_namePortal_1",disabled:!portals.portals[0].enable},{element:"input",type:"text",title:_("URL")+" 1:",value:portals.portals[0].url||read.result.portal1,id:"urlPortal_1",sub_id:"sub_urlPortal_1",disabled:!portals.portals[0].enable}];UpdateFooter(),generate_elements(arr),servers_hideElement()}function servers_additionally_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=servers_additionally_save,back_function=servers_load,read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["use_portal_dhcp","portal_dhcp","bootstrap_url","update_url","update_channel_url"]}))),echo(read,"read"),"servers_additionally"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_serversset.png",_("More"),"servers_additionally"),elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS;var arr=[{element:"checkbox",checked:read.result.use_portal_dhcp,title:_("Use DHCP portal:"),onChange:function(){this.value?(navigation.elements[1].disabled=!1,navigation.elements[1].className="elements wide500"):(navigation.elements[1].disabled=!0,navigation.elements[1].className="elements wide500 disabled")}},{element:"input",type:"text",title:_("DHCP portal:"),value:read.result.portal_dhcp,disabled:"true"!==read.result.use_portal_dhcp},{element:"input",type:"text",title:_("Bootstrap URL:"),value:read.result.bootstrap_url},{element:"input",type:"text",title:_("Update URL:"),value:read.result.update_url},{element:"input",type:"text",title:_("Control channel URL:"),value:read.result.update_channel_url}];UpdateFooter(),generate_elements(arr)}function servers_general_save(){var pr=!1,erm=[],wr="{";navigation.elements[0].value!==read.result.ntpurl&&(URLC(navigation.elements[0].value)||""===navigation.elements[0].value?(wr+=(pr?",":"")+'"ntpurl":"'+navigation.elements[0].value+'"',pr=!0,reload.device=!0):erm[erm.length]=_("NTP server:").replace(":","")),wr+="}",erm.length>0?new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel")):("{}"!=wr&&gSTB.SetEnv(wr),servers_general_load())}function servers_portals_save(){var portal1=!1,portal2=!1,pr=!1,erm=[],wr="{";navigation.elements[0].value!==read.result.portal1&&(URLC(navigation.elements[0].value)||""===navigation.elements[0].value?(wr+='"portal1":"'+encodeURI(navigation.elements[0].value)+'"',pr=!0):erm[erm.length]=_("Portal 1 URL")),navigation.elements[0].value!==portals.portals[0].url&&(portals.portals[0].url=navigation.elements[0].value,write=!0),navigation.elements[1].value!==read.result.portal2&&(URLC(navigation.elements[1].value)||""===navigation.elements[1].value?(wr+=(pr?",":"")+'"portal2":"'+encodeURI(navigation.elements[1].value)+'"',pr=!0):erm[erm.length]=_("Portal 2 URL")),navigation.elements[1].value!==portals.portals[1].url&&(portals.portals[1].url=navigation.elements[1].value,write=!0),""!==navigation.elements[0].value&&(portal1=!0),""!==navigation.elements[1].value&&(portal2=!0),wr+="}",erm.length>0?(saveError=!0,new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel"))):("{}"!=wr&&(gSTB.SetEnv(wr),setTimeout(saved_ok_msg,0)),write&&(gSTB.SaveUserData("portals.json",JSON.stringify(portals)),navigation.reloadPortalsLoader=!0),servers_portals_load())}function servers_additional_portals_save(){var pr=!1,erm=[],wr="{",write=!1;navigation.elements[0].checked!==read.result.useExtPortalsPage&&(wr+=(pr?",":"")+'"useExtPortalsPage":"'+navigation.elements[0].checked+'"',pr=!0),navigation.elements[0].checked!==portals.enable&&(portals.enable=navigation.elements[0].checked,write=!0),navigation.elements[1].value!=portals.def&&(portals.def=navigation.elements[1].value,write=!0),navigation.elements[2].value!=portals.time&&(portals.time=navigation.elements[2].value,write=!0);for(var i=0;i<portals.portals.length;i++){var ch=document.getElementById("chPortal_"+(i+1)).checked,name=document.getElementById("namePortal_"+(i+1)).value,url=document.getElementById("urlPortal_"+(i+1)).value;!ch!=portals.portals[i].enable&&(portals.portals[i].enable=ch,write=!0),name!=portals.portals[i].name&&(portals.portals[i].name=name,write=!0),url!=portals.portals[i].url&&(URLC(url)||""==url?(portals.portals[i].url=url,write=!0):erm[erm.length]="URL "+(i+1)),0==i&&url!=read.result.portal1&&(wr+=(pr?",":"")+'"portal1":"'+encodeURI(url)+'"',pr=!0),1==i&&url!=read.result.portal2&&(wr+=(pr?",":"")+'"portal2":"'+encodeURI(url)+'"',pr=!0)}wr+="}",erm.length>0?new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel")):("{}"!=wr&&gSTB.SetEnv(wr),write&&(gSTB.SaveUserData("portals.json",JSON.stringify(portals)),navigation.reloadPortalsLoader=!0),servers_additional_portals_load())}function servers_additionally_save(){var pr=!1,erm=[],wr="{";navigation.elements[0].checked!=("true"==read.result.use_portal_dhcp?!0:!1)&&(wr+=(pr?",":"")+'"use_portal_dhcp":"'+navigation.elements[0].checked+'"',pr=!0),navigation.elements[1].value!=read.result.portal_dhcp&&(URLC(navigation.elements[1].value)||""==navigation.elements[1].value?(reload.device=!0,wr+=(pr?",":"")+'"portal_dhcp":"'+navigation.elements[1].value+'"',pr=!0):erm[erm.length]=_("DHCP portal:").replace(":","")),navigation.elements[2].value!=read.result.bootstrap_url&&(URLC(navigation.elements[4].value)||""==navigation.elements[2].value?(wr+=(pr?",":"")+'"bootstrap_url":"'+navigation.elements[2].value+'"',pr=!0):erm[erm.length]=_("Bootstrap URL:").replace(":","")),navigation.elements[3].value!=read.result.update_url&&(URLC(navigation.elements[3].value)||""==navigation.elements[3].value?(wr+=(pr?",":"")+'"update_url":"'+navigation.elements[3].value+'"',pr=!0):erm[erm.length]=_("Update URL:").replace(":","")),navigation.elements[4].value!=read.result.update_channel_url&&(URLC(navigation.elements[4].value)||""==navigation.elements[4].value?(wr+=(pr?",":"")+'"update_channel_url":"'+navigation.elements[4].value+'"',pr=!0):erm[erm.length]=_("Control channel URL:").replace(":","")),wr+="}",erm.length>0?new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel")):("{}"!=wr&&gSTB.SetEnv(wr),servers_additionally_load())}function servers_hideElement(){if(navigation.elements[0].checked){for(var i=1;7>i;i++)document.getElementsByClassName("item")[i].style.display="table";for(var obj,arr=[],tmpNavElemArray=[],i=2;9>i;i++)arr=arr.concat([{element:"checkbox",checked:portals.portals[i-1].enable,title:_("Use portal")+" "+i+":",id:"chPortal_"+i,sub_id:"sub_chPortal_"+i,onChange:refreshDefaultPortals},{element:"input",type:"text",title:_("Name")+" "+i+":",value:portals.portals[i-1].name,id:"namePortal_"+i,sub_id:"sub_namePortal_"+i,disabled:!portals.portals[i-1].enable},{element:"input",type:"text",title:_("URL")+" "+i+":",value:2===i&&read.result.portal2?read.result.portal2:portals.portals[i-1].url,id:"urlPortal_"+i,sub_id:"sub_urlPortal_"+i,disabled:!portals.portals[i-1].enable}]);for(timer.checkLR={},timer.backClass={},obj=generate_elements(arr,!0,!0),i=0;i<obj.length;i++)obj[i].style.display="none";var d=document.getElementById(as.page_list[as.page]).getElementsByClassName("list")[0];elchild(d,obj),navigation.elements.splice(4),tmpNavElemArray=d.getElementsByClassName("elements");for(var i=4;i<tmpNavElemArray.length;i++)navigation.elements.push(tmpNavElemArray[i]);navigation.pre_elements=d.getElementsByClassName("item")}else for(var i=1;7>i;i++)document.getElementsByClassName("item")[i].style.display="none"}function advSet_load(){var langChangeTimeout;(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=advSet_save,"advSet"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_settings.png",_("Advanced settings"),"advSet"),read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["language","timezone_conf","upnp_conf","input_buffer_size"]}))),""==read.result.upnp_conf&&(read.result.rupnp_conf="off"),"true"==read.result.upnp_conf&&(read.result.rupnp_conf="lan"),read.result.input_buffer_size=""==read.result.input_buffer_size?0:parseInt(read.result.input_buffer_size,10),""==read.result.timezone_conf&&(read.result.timezone_conf="Europe/Kiev");var tt,option,selected_lang,selected_timezone,l=advSet_load.new_lang||read.result.language,lg=gSTB.RDir("tempfile read languages_utf8.txt").split("\n"),lang_options=[],timez_options=[];for(var timeZone in TIME_ZONES)option={value:TIME_ZONES[timeZone].id,title:"GMT"+TIME_ZONES[timeZone].offset+" "+(TIME_ZONES[timeZone].name||TIME_ZONES[timeZone].id)},TIME_ZONES[timeZone].id===read.result.timezone_conf&&(selected_timezone=TIME_ZONES[timeZone].id),timez_options.push(option);for(selected_timezone||(option={value:read.result.timezone_conf,title:read.result.timezone_conf},selected_timezone=read.result.timezone_conf,timez_options.push(option)),i=0;i<lg.length;i++)if(""!=lg[i]){if(tt=lg[i].split('"'),"bg"===tt[1]||"es"===tt[1])continue;option={value:tt[1],title:decode(tt[3])},tt[1]==l&&(selected_lang=tt[1]),lang_options.push(option)}advSet_load.language=l,gettext.init({name:l},function(){SettingsPage.BCrumb.Pop(),"advSet"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_settings.png",_("Advanced settings"),"advSet"),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=load_main;var arr=[{element:"select",title:_("Language:"),onChange:function(){var self=this;clearTimeout(langChangeTimeout),langChangeTimeout=setTimeout(function(){self.GetValue()!==advSet_load.language&&(advSet_load.new_lang=self.GetValue(),setTimeout(advSet_load,0))},400)},option:lang_options,selected:selected_lang,"default":read.result.language},{element:"select",title:_("Time zone:"),option:timez_options,"default":read.result.timezone_conf,selected:selected_timezone},{element:"select",title:_("UPnP client enabled:"),option:[{value:"off",title:_("Off")},{value:"lan",title:"LAN"},{value:"wlan",title:_("Wireless")}],selected:read.result.upnp_conf},{element:"input_spec",type:"text",title:_("Buffer size (ms):"),value:read.result.input_buffer_size,interval:100,maxsize:2e4}];UpdateFooter(RULES["AdvancedSettings/more"]),generate_elements(arr),advSet_load.language!==read.result.language?(sett_changes=1,SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!1)):SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!0)})}function advSet_additionally_load(){(this.number||0==this.number||void 0===this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=advSet_additionally_save,read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["igmp_conf","mc_proxy_enabled","mc_proxy_url"]}))),""==read.result.igmp_conf&&(read.result.igmp_conf="V2"),gettext.init({name:main_lang},function(){"advSet_additionally"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","settings.png",_("More"),"advSet_additionally"),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=advSet_load;var arr=[{element:"select",title:_("IGMP version:"),option:[{title:"V2",value:"V2"},{title:"V3",value:"V3"}],selected:read.result.igmp_conf},{element:"checkbox",checked:read.result.mc_proxy_enabled,title:_("Multicast proxy enabled:"),onChange:function(){this.value?(navigation.elements[2].disabled=!1,navigation.elements[2].className="elements wide500"):(navigation.elements[2].disabled=!0,navigation.elements[2].className="elements wide500 disabled")}},{element:"input",type:"text",title:_("Multicast proxy URL:"),value:read.result.mc_proxy_url,disabled:"true"!==read.result.mc_proxy_enabled}];UpdateFooter(),generate_elements(arr)})}function advSet_save(){var pr=!1,langf=!1,timezoneF=!1,upnpRestart=!1;bufferF=!1,keyboardFile={layouts:[],order:[]};var wr="{";if(navigation.elements[0].value!=read.result.language&&(pr=!0,wr+='"language":"'+navigation.elements[0].value+'"',main_lang=navigation.elements[0].value,langf=!0),navigation.elements[1].value!=read.result.timezone_conf&&(wr+=(pr?",":"")+'"timezone_conf":"'+navigation.elements[1].value+'"',pr=!0,timezoneF=!0),navigation.elements[2].value!=read.result.upnp_conf&&(wr+=(pr?",":"")+'"upnp_conf":"'+navigation.elements[2].value+'"',pr=!0,upnpRestart=!0),navigation.elements[3].value!=read.result.input_buffer_size&&(wr+=(pr?",":"")+'"input_buffer_size":"'+navigation.elements[3].value+'"',bufferF=!0),wr+="}","{}"!=wr){if(gSTB.SetEnv(wr),timezoneF&&gSTB.ExecAction("timezone "+navigation.elements[1].value),bufferF){var by=Math.floor(768*navigation.elements[3].value);gSTB.SetBufferSize(navigation.elements[3].value,by)}langf&&(reload.portal=!0,UpdatePage.RefreshPage(),lang_clear(),gSTB.SetUiLang(main_lang)),upnpRestart&&gSTB.ServiceControl("upnp-service","restart")}gSTB.SaveUserData("keyboard.json",JSON.stringify(keyboardFile))}function advSet_additionally_save(){var pr=!1,multicastF=!1,proksiF=!1,erm=[],url=/^https?:\/\/([a-z0-9._\/-]+):(([0-9]{1,4})|([0-6]{1,}[0-4]{1,}[0-9]{1,3})|(65[0-4]{1,}[0-9]{1,2})|(655[0-2]{1,}[0-9]{1,})|(6553[0-5]{1,}))$/,regURL=/(^https?:\/\/)?[a-zA-Z0-9~_\-\.]+\.[a-zA-Z]{2,9}(\/|:|\?[!-~]*)?$/i,wr="{";navigation.elements[0].value!=read.result.igmp_conf&&(wr+=(pr?",":"")+'"igmp_conf":"'+navigation.elements[0].value+'"',pr=!0),navigation.elements[1].checked!=("true"==read.result.mc_proxy_enabled?!0:!1)&&(wr+=(pr?",":"")+'"mc_proxy_enabled":"'+navigation.elements[1].checked+'"',pr=!0,proksiF=!0),navigation.elements[2].value!=read.result.mc_proxy_url&&(url.test(navigation.elements[2].value)||regURL.test(navigation.elements[2].value)||""==navigation.elements[2].value?(wr+=(pr?",":"")+'"mc_proxy_url":"'+navigation.elements[2].value+'"',multicastF=!0,pr=!0):erm[erm.length]=_("Multicast proxy URL:").replace(":","")),wr+="}",erm.length>0?new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Close")):"{}"!=wr&&(gSTB.SetEnv(wr),multicastF&&gSTB.SetMulticastProxyURL(navigation.elements[2].value),proksiF&&gSTB.EnableMulticastProxy(navigation.elements[1].checked),advSet_additionally_load())}function video_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=video_save,"video"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_tv.png",_("Video"),"video"),read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["tvsystem","graphicres"]}))),document.getElementById(as.page_list[as.page]).style.display="none",UpdateFooter(RULES["Video/More"]),as.page=as.pages.ELEMENTS,back_function=load_main;var arr=[{element:"select",title:_("Video output mode:"),option:[{value:"PAL",title:"PAL (576i)"},{value:"576p-50",title:"576p-50"},{value:"720p-50",title:"720p-50"},{value:"1080i-50",title:"1080i-50"},{value:"1080p-50",title:"1080p-50"},{value:"NTSC",title:"NTSC (480i)"},{value:"720p-60",title:"720p-60"},{value:"1080i-60",title:"1080i-60"},{value:"1080p-60",title:"1080p-60"}],selected:read.result.tvsystem,onChange:function(){navigation.elements[1].SetData(checkResolution()),navigation.elements[1].SetIndex("PAL"===navigation.elements[0].GetValue()||"NTSC"===navigation.elements[0].GetValue()||"576p-50"===navigation.elements[0].GetValue()?0:2)}},{element:"select",title:_("Graphic resolution:"),option:checkResolution(read.result.tvsystem),selected:read.result.graphicres}];"mag200"==model.toLowerCase()&&(arr[0]={element:"select",title:_("Video output mode:"),option:[{value:"PAL",title:"PAL (576i)"},{value:"576-50",title:"576-50"},{value:"720p-50",title:"720p-50"},{value:"1080i-50",title:"1080i-50"},{value:"NTSC",title:"NTSC (480i)"},{value:"720p-60",title:"720p-60"},{value:"1080i-60",title:"1080i-60"}],selected:read.result.tvsystem}),generate_elements(arr),read.result.graphicres!==navigation.elements[1].value&&(navigation.elements[1].value=read.result.graphicres)}function video_additionally_load(){var alert_framerate_msg=!0,alert_hdmi_msg=!0,read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["auto_framerate","force_dvi"]})));back_function=video_load,save_function=video_additionally_save,(this.number||0==this.number||void 0===this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),"video_additionally"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","settings.png",_("More"),"video_additionally"),""==read.result.auto_framerate&&(read.result.auto_framerate="Disabled"),""==read.result.force_dvi&&(read.result.force_dvi=0),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS;var arr=[{element:"select",title:_("Auto frame rate:"),option:[{value:"Disabled",title:_("Disabled")},{value:"50_60",title:"50/60 Hz"},{value:"24_50_60",title:"24/50/60 Hz"},{value:"24_50",title:"24/50 Hz"},{value:"24_60",title:"24/60 Hz"}],selected:read.result.auto_framerate,onChange:function(){alert_framerate_msg&&(new CModalAlert(SettingsPage,_("Notice"),_("During file playback, video output frame rate will be automatically adjusted<br/>according to played content.<br />Notes:<br />- works only with HDMI 720p/1080i/1080p video modes<br />- make sure your TV supports required video mode"),_("Close")),alert_framerate_msg=!1)}},{element:"select",title:_("HDMI/DVI:"),option:[{value:0,title:_("HDMI")},{value:1,title:_("DVI")}],selected:read.result.force_dvi,onChange:function(){alert_hdmi_msg&&1===navigation.elements[1].value&&(new CModalAlert(SettingsPage,_("Notice"),_('<span style="color: red">With option enabled in DIV mode<br/>HDMI audio will be missing</span>'),_("Close")),alert_hdmi_msg=!1)}}];UpdateFooter(),generate_elements(arr)}function video_save(){var pr=!1,wr="{";navigation.elements[0].value!=read.result.tvsystem&&(wr+='"tvsystem":"'+navigation.elements[0].value+'"',pr=!0,reload.device=!0),navigation.elements[1].value!=read.result.graphicres&&(wr+=(pr?",":"")+'"graphicres":"'+navigation.elements[1].value+'"',pr=!0,reload.device=!0),wr+="}","{}"!=wr&&(gSTB.SetEnv(wr),video_load())}function video_additionally_save(){var frameRates={Disabled:0,"50_60":6,"24_50_60":7,"24_50":3,"24_60":5},pr=!1,flau=!1,wr="{";if(navigation.elements[0].value!=read.result.auto_framerate&&(wr+='"auto_framerate":"'+navigation.elements[0].value+'"',pr=!0,flau=!0),navigation.elements[1].value!=read.result.force_dvi&&(wr+=(pr?",":"")+'"force_dvi":"'+navigation.elements[1].value+'"',pr=!0),wr+="}","{}"!=wr)if(flau){if(to_save=wr,navigation.elements[0].value!=read.result.auto_framerate){var to_af=0;switch(navigation.elements[0].value){case"50_60":to_af=6;break;case"24_50_60":to_af=7;break;case"24_50":to_af=3;break;case"24_60":to_af=5}}gSTB.SetEnv(to_save),gSTB.SetAutoFrameRate(frameRates[navigation.elements[0].value]),video_additionally_load(),saved_ok_msg()}else gSTB.SetEnv(wr),video_additionally_load(),saved_ok_msg()}function audio_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),"audio"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_sound.png",_("Audio"),"audio"),back_function=audio_back,save_function=audio_save,read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["audio_initial_volume","audio_stereo_out_mode"]}))),""==read.result.audio_initial_volume&&(read.result.audio_initial_volume=100),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS;var arr=[{element:"input_spec",type:"text",title:_("Initial volume:"),value:read.result.audio_initial_volume,interval:5,maxsize:100},{element:"select",title:_("Audio output mode:"),onChange:SSM,option:[{value:"STEREO",title:_("Stereo")},{value:"MONO",title:_("Mono")},{value:"MONO_LEFT",title:_("Mono Left")},{value:"MONO_RIGHT",title:_("Mono Right")},{value:"LT_RT",title:"Lt/Rt"}],selected:read.result.audio_stereo_out_mode}];UpdateFooter(RULES["Audio/More"]),generate_elements(arr)}function audio_additionally_load(){(this.number||0==this.number||void 0===this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),"audio_additionally"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","settings.png",_("More"),"audio_additionally"),back_function=audio_additionally_back,save_function=audio_additionally_save,read=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["audio_dyn_range_comp","audio_operational_mode","audio_spdif_mode","audio_hdmi_audio_mode"]}))),""==read.result.audio_spdif_mode&&(read.result.audio_spdif_mode="BITSTEAM"),""==read.result.audio_hdmi_audio_mode&&(read.result.audio_hdmi_audio_mode="PCM"),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS;var arr=[{element:"select",title:_("Dynamic range compression:"),onChange:SetDRC,option:[{value:"OFF",title:_("Off")},{value:"1",title:"1/8"},{value:"2",title:"2/8"},{value:"3",title:"3/8"},{value:"4",title:"4/8"},{value:"5",title:"5/8"},{value:"6",title:"6/8"},{value:"7",title:"7/8"},{value:"MAX",title:_("Max")}],selected:read.result.audio_dyn_range_comp},{element:"select",title:_("Operating mode:"),onChange:SAOM,option:[{value:"RF_MODDE",title:"RF Mode"},{value:"LINE_MODE",title:"Line Mode"},{value:"CUSTOM0",title:"Custom 0"},{value:"CUSTOM1",title:"Custom 1"}],selected:read.result.audio_operational_mode},{element:"select",title:_("SPDIF Mode:"),option:[{value:"PCM",title:"PCM"},{value:"BITSTEAM",title:"Bitstream"}],selected:read.result.audio_spdif_mode},{element:"select",title:_("HDMI Audio:"),option:[{value:"PCM",title:"PCM"},{value:"SPDIF",title:"SPDIF"}],selected:read.result.audio_hdmi_audio_mode}];UpdateFooter(),generate_elements(arr)}function audio_save(){var pr=!1,wr="{";navigation.elements[0].value!=read.result.audio_initial_volume&&(pr=!0,wr+='"audio_initial_volume":"'+navigation.elements[0].value+'"'),navigation.elements[1].value!=read.result.audio_stereo_out_mode&&(wr+=(pr?",":"")+'"audio_stereo_out_mode":"'+navigation.elements[1].value+'"',pr=!0),wr+="}","{}"!=wr&&(gSTB.SetEnv(wr),audio_load())}function audio_additionally_save(){var pr=!1,wr="{";navigation.elements[0].value!=read.result.audio_dyn_range_comp&&(wr+=(pr?",":"")+'"audio_dyn_range_comp":"'+navigation.elements[0].value+'"',pr=!0),navigation.elements[1].value!=read.result.audio_operational_mode&&(wr+=(pr?",":"")+'"audio_operational_mode":"'+navigation.elements[1].value+'"',pr=!0),navigation.elements[2].value!=read.result.audio_spdif_mode&&(wr+=(pr?",":"")+'"audio_spdif_mode":"'+navigation.elements[2].value+'"',pr=!0,gSTB.SetupSPdif("PCM"==navigation.elements[2].value?1:2)),navigation.elements[3].value!=read.result.audio_hdmi_audio_mode&&(wr+=(pr?",":"")+'"audio_hdmi_audio_mode":"'+navigation.elements[3].value+'"',gSTB.SetHDMIAudioOut("SPDIF"==navigation.elements[3].value?1:0)),wr+="}","{}"!=wr&&(gSTB.SetEnv(wr),audio_additionally_load())}function audio_back(){read.audio_stereo_out_mode!=navigation.elements[1].value&&SSM(read.audio_stereo_out_mode),load_main()}function audio_additionally_back(){read.audio_dyn_range_comp!=navigation.elements[0].value&&SetDRC(read.audio_dyn_range_comp),read.audio_operational_mode!=navigation.elements[1].value&&SAOM(read.audio_operational_mode),audio_load()}function netInfo_load(){var dict;(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),to_save="",save_function=function(){},back_function=load_main,"netInfo"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_network_info.png",_("Network info"),"netInfo"),UpdateFooter(),elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.LIST,0==list.lanInfo.length&&(list.lanInfo=[],dict=[{name:_("Wired (Ethernet)"),rId:"NetworkInfo/Wired(Ethernet)",className:"ico_folder",func:wired_load_info},{name:_("PPPoE"),rId:"NetworkInfo/PPPoE",className:"ico_folder",func:pppoe_load_info},{name:_("Wireless (Wi-Fi)"),rId:"NetworkInfo/Wireless(Wi-Fi)",className:"ico_folder",func:wifi_load_info}],dict.forEach(function(menuItem){RULES[menuItem.rId]&&list.lanInfo.push(menuItem)})),generate(list.lanInfo)
}function devInfo_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),to_save="",document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.INFO,save_function=function(){},back_function=load_main,"devInfo"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","device_info.png",_("Device info"),"devInfo");var t_model,version=gSTB.GetDeviceImageVersion();if(parseInt(version,10)>=214)try{t_model=gSTB.GetDeviceModelExt()}catch(e){t_model=gSTB.GetDeviceModel()}else t_model=gSTB.GetDeviceModel();var arr=[{title:_("Model:"),value:t_model},{title:_("Serial number:"),value:gSTB.GetDeviceSerialNumber()},{title:_("MAC address:"),value:gSTB.GetDeviceMacAddress()},{title:_("Vendor:"),value:gSTB.GetDeviceVendor()},{title:_("Hardware version:"),value:gSTB.GetDeviceVersionHardware()},{title:_("Active bank:"),value:gSTB.GetDeviceActiveBank()},{title:_("Image version:"),value:version},{title:_("Image description:"),value:gSTB.GetDeviceImageDesc()},{title:_("RootFS version:"),value:gSTB.GetDeviceImageVersionCurrent()}];UpdateFooter(),generate_table(arr)}function reset_message(){new CModalConfirm(SettingsPage,_("Confirm"),_("Reset settings?"),_("Cancel"),null,_("Ok"),reset_confirm)}function reset_confirm(){gSTB.ServiceControl("local-config","reset"),stbStorage.removeItem(getWindowKey(WINDOWS.SYSTEM_SETTINGS))}function reload_message(){new CModalConfirm(SettingsPage,_("Confirm"),_("Reboot portal?"),_("Cancel"),null,_("Ok"),reload_confirm)}function reload_confirm(){var portalWinId=parseInt(getWindowIdByName(WINDOWS.PORTAL)||getWindowIdByName(WINDOWS.PORTALS_LOADER)),currentWinId=stbWebWindow.windowId(),windowList=JSON.parse(stbWindowMgr.windowList());document.body.style.display="none",gSTB.Stop();for(var i=0;i<windowList.result.length;i++)windowList.result[i]!==portalWinId&&windowList.result[i]!==currentWinId&&stbWindowMgr.closeWindow(windowList.result[i]);stbStorage.clear(),stbWebWindow.messageSend(portalWinId,"window.reload",""),stbWindowMgr.closeWindow(currentWinId)}function reboot_message(){new CModalConfirm(SettingsPage,_("Confirm"),_("Device is going to reboot. Are you sure?"),_("Cancel"),null,_("Ok"),reboot_confirm)}function reboot_confirm(){gSTB.ExecAction("reboot")}function clear_message(){new CModalConfirm(SettingsPage,_("Confirm"),_('<span style="color: red">User data will be lost!</span><br>We strongly recommend read Menu Guide.<br>Do you want to do it?'),_("Cancel"),null,_("Ok"),clear_confirm)}function clear_confirm(){gSTB.ResetUserFs(),setEnv("weather_place","")}function wired_load(){var dict;(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),to_save="",save_function=function(){},back_function=network_load,"wired"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Wired (Ethernet)"),"wired"),UpdateFooter(),elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.LIST,0==list.lan_wired.length&&(list.lan_wired=[],dict=[{name:_("Auto (DHCP)"),rId:"Network/Wired(Ethernet)/Auto(DHCP)",className:"ico_folder",func:wired_auto_load},{name:_("Auto (DHCP), manual DNS"),rId:"Network/Wired(Ethernet)/Auto(DHCP),manualDNS",className:"ico_folder",func:wired_autoManual_load},{name:_("Manual"),rId:"Network/Wired(Ethernet)/Manual",className:"ico_folder",func:wired_manual_load},{name:_("No IP"),rId:"Network/Wired(Ethernet)/NoIP",className:"ico_folder",func:wired_noip_load}],dict.forEach(function(menuItem){RULES[menuItem.rId]&&list.lan_wired.push(menuItem)})),generate(list.lan_wired)}function wired_auto_load(){new CModalConfirm(SettingsPage,_("Confirm"),_("Confirm change(s)?"),_("Cancel"),null,_("Ok"),wired_auto_confirm)}function wired_auto_confirm(){gSTB.SetEnv('{"lan_noip":"","ipaddr_conf":"","dnsip":""}');gSTB.ServiceControl("network","restart")}function wired_autoManual_load(){var arr=[];(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=wired_autoManual_save,"wired_autoManual"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Auto (DHCP), manual DNS"),"wired_autoManual"),UpdateFooter(),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=wired_load,read=JSON.parse(gSTB.GetEnv('{"varList":["dnsip"]}')),arr=[{element:"ip",title:"DNS:",value:read.result.dnsip}],generate_elements(arr)}function wired_autoManual_save(){var erm=[],dns=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements0")),wr='{"lan_noip":"","ipaddr_conf":""';dns="0.0.0.0"==dns?"":dns,dns!=read.result.dnsip&&(cIP(dns)?wr+=',"dnsip":"'+dns+'"':erm[erm.length]="DNS"),erm.length>0?new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel")):(wr+="}",gSTB.SetEnv(wr),saved_ok_msg(),navigation.back())}function wired_manual_load(){var dict;(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),"wired_manual"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Manual"),"wired_manual"),UpdateFooter(),save_function=wired_manual_save,document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=wired_load,read=JSON.parse(gSTB.GetEnv('{"varList":["ipaddr_conf","netmask","gatewayip","dnsip"]}')),dict=[{element:"ip",title:_("IP address:"),value:read.result.ipaddr_conf},{element:"ip",title:_("Network mask:"),value:read.result.netmask},{element:"ip",title:_("Gateway:"),value:read.result.gatewayip},{element:"ip",title:_("DNS server:"),value:read.result.dnsip}],generate_elements(dict)}function wired_manual_save(){var erm=[],t1=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements0")),t2=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements1")),t3=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements2")),t4=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements3")),wr='{"lan_noip":""';if(t1="0.0.0.0"==t1?"":t1,t1!=read.result.ipaddr_conf&&(cIP(t1)?wr+=',"ipaddr_conf":"'+t1+'"':erm[erm.length]=_("IP address:").replace(":","")),t2="0.0.0.0"==t2?"":t2,t2!=read.result.netmask&&(cIP(t2)?wr+=',"netmask":"'+t2+'"':erm[erm.length]=_("Network mask:").replace(":","")),t3="0.0.0.0"==t3?"":t3,t3!=read.result.gatewayip&&(cIP(t3)?wr+=',"gatewayip":"'+t3+'"':erm[erm.length]=_("Gateway:").replace(":","")),t4="0.0.0.0"==t4?"":t4,t4!=read.result.dnsip&&(cIP(t4)?wr+=',"dnsip":"'+t4+'"':erm[erm.length]=_("DNS server:").replace(":","")),wr+="}",erm.length>0)new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel"));else{gSTB.SetEnv(wr);{gSTB.ServiceControl("network","restart")}saved_ok_msg(),navigation.back()}}function wired_noip_load(){new CModalConfirm(SettingsPage,_("Confirm"),_("Confirm change(s)?"),_("Cancel"),null,_("Ok"),wired_noip_confirm)}function wired_noip_confirm(){gSTB.SetEnv('{"lan_noip":"true"}');gSTB.ServiceControl("network","restart")}function pppoe_load(){var dict;(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),to_save="",save_function=function(){},"pppoe"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("PPPoE"),"pppoe"),UpdateFooter(),back_function=network_load,elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.LIST,0==list.lan_pppoe.length&&(list.lan_pppoe=[],dict=[{name:_("Auto (DHCP)"),rId:"Network/PPPoE/Auto(DHCP)",className:"ico_folder",func:pppoe_auto_load},{name:_("Auto (DHCP), manual DNS"),rId:"Network/PPPoE/Auto(DHCP),manualDNS",className:"ico_folder",func:pppoe_autoManual_load},{name:_("Disable PPPoE"),rId:"Network/PPPoE/DisablePPPoE",className:"ico_folder",func:pppoe_disable_load}],dict.forEach(function(menuItem){RULES[menuItem.rId]&&list.lan_pppoe.push(menuItem)})),generate(list.lan_pppoe)}function pppoe_auto_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=pppoe_auto_save,"pppoe_auto"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Auto (DHCP)"),"pppoe_auto"),UpdateFooter(),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=pppoe_load,read=JSON.parse(gSTB.GetEnv('{"varList":["pppoe_login","pppoe_pwd"]}'));var arr=[{element:"input",type:"text",title:_("Login:"),value:read.result.pppoe_login},{element:"input",type:"password",title:_("Password:"),value:""}];generate_elements(arr)}function pppoe_auto_save(){var wr='{"pppoe_dns1":"true"',t=navigation.elements[0].value;t!=read.result.pppoe_login&&(wr+=',"pppoe_login":"'+t+'"'),t=navigation.elements[1].value,t!=read.result.pppoe_pwd&&(wr+=',"pppoe_pwd":"'+t+'"'),wr+="}",gSTB.ServiceControl("pppoe","restart"),gSTB.SetEnv(wr),saved_ok_msg(),navigation.back()}function pppoe_autoManual_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=pppoe_autoManual_save,"pppoe_autoManual"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Auto (DHCP), manual DNS"),"pppoe_autoManual"),UpdateFooter(),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=pppoe_load,read=JSON.parse(gSTB.GetEnv('{"varList":["pppoe_login","pppoe_pwd","pppoe_dns1"]}'));var arr=[{element:"input",type:"text",title:_("Login:"),value:read.result.pppoe_login},{element:"input",type:"password",title:_("Password:"),value:""},{element:"ip",title:"DNS:",value:read.result.pppoe_dns1}];generate_elements(arr)}function pppoe_autoManual_save(){var erm=[],wr='{"pppoe_enabled":"true"',t=navigation.elements[0].value;t!=read.result.pppoe_login&&(wr+=',"pppoe_login":"'+t+'"'),t=navigation.elements[1].value,t!=read.result.pppoe_pwd&&(wr+=',"pppoe_pwd":"'+t+'"'),t=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements2")),t="0.0.0.0"==t?"":t,t!=read.result.pppoe_dns1&&(cIP(t)?wr+=',"pppoe_dns1":"'+t+'"':erm[0]="DNS"),wr+="}",echo(wr,"TO SAVE"),erm.length>0?new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel")):(gSTB.SetEnv(wr),gSTB.ServiceControl("pppoe","restart"),saved_ok_msg(),navigation.back())}function pppoe_disable_load(){new CModalConfirm(SettingsPage,_("Confirm"),_("Confirm change(s)?"),_("Cancel"),null,_("Ok"),pppoe_disable_confirm)}function pppoe_disable_confirm(){gSTB.SetEnv('{"pppoe_enabled":""}')}function wifi_load(){var dict;""===gSTB.GetNetworkWifiMac()?new CModalAlert(SettingsPage,_("Notice"),_("Wi-Fi adapter not connected"),_("Close")):((this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),back_index>2&&(back_index=2),"wifi"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Wireless (Wi-Fi)"),"wifi"),UpdateFooter(),to_save="",save_function=function(){},back_function=network_load,elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.LIST,0==list.lan_wifi.length&&(list.lan_wifi=[],dict=[{name:_("Auto (DHCP)"),rId:"Network/Wireless(Wi-Fi)/Auto(DHCP)",className:"ico_folder",func:wifi_auto_load},{name:_("Auto (DHCP), manual DNS"),rId:"Network/Wireless(Wi-Fi)/Auto(DHCP),manualDNS",className:"ico_folder",func:wifi_autoManual_load},{name:_("Manual"),rId:"Network/Wireless(Wi-Fi)/Manual",className:"ico_folder",func:wifi_manual_load}],dict.forEach(function(menuItem){RULES[menuItem.rId]&&list.lan_wifi.push(menuItem)})),generate(list.lan_wifi))}function wifi_auto_load(){switch(this.number||0==this.number?(back_element[back_index]=this.number,back_index++,back_element[back_index]=0,wifi_load_variation=0):(back_element[back_index]=0,back_index++,back_element[back_index]=0),read=JSON.parse(gSTB.GetWifiGroups()),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.WIFI,elclear(document.getElementById(as.page_list[as.page])),document.getElementById(as.page_list[as.page]).style.display="none",wifi_load_variation){case 1:back_function=wifi_autoManual_load;break;case 2:back_function=wifi_manual_load;break;default:"wifi_auto"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Auto (DHCP)"),"wifi_auto"),UpdateFooter(),to_save='"wifi_int_ip":""',back_function=wifi_load}var obj=[],d=element("div",{className:"wifi_title"},_("Select Wi-Fi group from list:"));elchild(document.getElementById(as.page_list[as.page]),d);for(var div=element("div",{className:"container"}),i=0;i<read.result.length;i++){var signal=read.result[i].signalInfo<=-80?1:read.result[i].signalInfo<=-70?2:read.result[i].signalInfo<=-50?3:4,ico=element("div",{className:"signal"+signal}),text=read.result[i].ssid+" "+read.result[i].rfInfo;obj[i]=element("a",{className:"wifi_item",href:"#",onclick:wifi_auto_save,number:i,onmouseover:mouse_over_wifi},[ico,text])}elchild(div,obj),navigation.element=0,navigation.elements=div.getElementsByTagName("a"),read.result.length>0?(navigation.wifi_auch=element("div",{className:"wifi_auth"},_("Authentication method:")+" "+read.result[0].auth),navigation.wifi_encrypt=element("div",{className:"wifi_auth"},_("Encryption:")+" "+read.result[0].enc),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active"):(navigation.wifi_auch=element("div",{className:"wifi_auth"},_("Authentication method:")),navigation.wifi_encrypt=element("div",{className:"wifi_auth"},_("Encryption:")));var div_d=element("div",{className:"wifi_list"},div);elchild(document.getElementById(as.page_list[as.page]),div_d),elchild(document.getElementById(as.page_list[as.page]),[navigation.wifi_auch,navigation.wifi_encrypt]),document.getElementById(as.page_list[as.page]).style.display="block",navigation.elements.length>0&&navigation.elements[navigation.element].focus()}function wifi_auto_save(){if(read.result[navigation.element].ssid.length<1)new CModalAlert(SettingsPage,_("Notice"),_("Invalid format"),_("Cancel"));else{var re=JSON.parse(gSTB.GetEnv('{"varList":["wifi_ssid"]}'));wifi_ssid_save=[],wifi_ssid_save[0]=read.result[navigation.element].ssid,wifi_ssid_save[1]=read.result[navigation.element].auth,wifi_ssid_save[2]=read.result[navigation.element].enc,read.result[navigation.element].ssid!=re.result.wifi_ssid&&(to_save+=',"wifi_ssid":"'+read.result[navigation.element].ssid+'"'),wifi_password_load()}}function wifi_autoManual_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=wifi_autoManual_save,"wifi_autoManual"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Auto (DHCP), manual DNS"),"wifi_autoManual"),UpdateFooter(),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=wifi_load,read=JSON.parse(gSTB.GetEnv('{"varList":["wifi_int_dns"]}'));var arr=[{element:"ip",title:"DNS1:",value:read.result.wifi_int_dns}];generate_elements(arr)}function wifi_autoManual_save(){var t=document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements0"),dns=toIp(t);to_save+='"wifi_int_ip":""',dns="0.0.0.0"==dns?"":dns,dns!=read.result.wifi_int_dns?cIP(dns)?(to_save+=',"wifi_int_dns":"'+dns+'"',wifi_load_variation=1,saved_ok_msg(),wifi_auto_load()):new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />DNS1",_("Cancel")):(wifi_load_variation=1,wifi_auto_load())}function wifi_manual_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),save_function=wifi_manual_save,to_save="","wifi_manual"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Manual"),"wifi_manual"),UpdateFooter(),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=wifi_load,read=JSON.parse(gSTB.GetEnv('{"varList":["wifi_int_ip","wifi_int_mask","wifi_int_gw","wifi_int_dns"]}'));var arr=[{element:"ip",title:_("IP address:"),value:read.result.wifi_int_ip},{element:"ip",title:_("Network mask:"),value:read.result.wifi_int_mask},{element:"ip",title:_("Gateway:"),value:read.result.wifi_int_gw},{element:"ip",title:"DNS1:",value:read.result.wifi_int_dns}];generate_elements(arr)}function wifi_manual_save(){var erm=[],pr=!1,t1=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements0")),t2=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements1")),t3=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements2")),t4=toIp(document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements3"));t1="0.0.0.0"==t1?"":t1,t1!=read.result.wifi_int_ip&&(cIP(t1)?(to_save+='"wifi_int_ip":"'+t1+'"',pr=!0):erm[erm.length]=_("IP address:").replace(":","")),t2="0.0.0.0"==t2?"":t2,t2!=read.result.wifi_int_mask&&(cIP(t2)?to_save+=(pr?",":"")+'"wifi_int_mask":"'+t2+'"':erm[erm.length]=_("Network mask:").replace(":","")),t3="0.0.0.0"==t3?"":t3,t3!=read.result.wifi_int_gw&&(cIP(t3)?to_save+=(pr?",":"")+'"wifi_int_gw":"'+t3+'"':erm[erm.length]=_("Gateway:").replace(":","")),t4="0.0.0.0"==t4?"":t4,t4!=read.result.wifi_int_dns&&(cIP(t4)?to_save+=(pr?",":"")+'"wifi_int_dns":"'+t4+'"':erm[erm.length]="DNS1"),erm.length>0?new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel")):(wifi_load_variation=2,saved_ok_msg(),wifi_auto_load())}function wifi_password_load(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),back_function=wifi_auto_load,save_function=wifi_password_save,"wifi_password"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Auto (DHCP), manual DNS"),"wifi_password"),UpdateFooter(),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,read=JSON.parse(gSTB.GetEnv('{"varList":["wifi_ssid","wifi_auth","wifi_enc","wifi_psk","wifi_wep_key1"]}'));var aut="",encode="";switch(wifi_ssid_save[1]){case"WPA2":aut="wpa2psk";break;case"WPAAUTO":aut="wep_auto";break;case"WPA":aut="wpapsk";break;default:aut="open"}switch(wifi_ssid_save[2]){case"TKIP":encode="tkip";break;case"WEP":encode="wep";break;case"CCMP":encode="aes";break;default:encode="none"}var arr=[{element:"input",type:"text",title:"SSID:",value:""!=wifi_ssid_save[0]?wifi_ssid_save[0]:read.result.wifi_ssid},{element:"select",title:_("Authentication mode:"),option:[{title:_("Open"),value:"open"},{title:_("Shared key"),value:"shared"},{title:_("Auto Open/Shared key"),value:"wep_auto"},{title:"WPA PSK",value:"wpapsk"},{title:"WPA2 PSK",value:"wpa2psk"}],selected:aut},{element:"select",onChange:encoding_check,title:_("Encryption:"),option:[{title:_("NONE"),value:"none"},{title:"WEP",value:"wep"},{title:"TKIP",value:"tkip"},{title:"AES",value:"aes"}],selected:encode},{element:"input",type:"password",title:_("Key or passphrase:"),value:""},{element:"button",onClick:wifi_keys,title:"",value:_("Keys and encoding setup")}];generate_elements(arr),encoding_check()}function wifi_password_save(){var erm=[],hex=/^[a-fA-F0-9]+$/;navigation.elements[1].value!=read.result.wifi_auth&&(to_save+=',"wifi_auth":"'+navigation.elements[1].value+'"'),navigation.elements[2].value!=read.result.wifi_enc&&(to_save+=',"wifi_enc":"'+navigation.elements[2].value+'"');var fw="wep"!=navigation.elements[3].value;if("none"==navigation.elements[3].value)to_save+=',"wifi_psk":"","wifi_wep_key1":"","wifi_wep_key2":"","wifi_wep_key3":"","wifi_wep_key4":""';else{var t=navigation.elements[3].value;if(fw)t!=read.result.wifi_psk&&(t.length<1?erm[erm.length]=_("Key or passphrase:").replace(":",""):t.split("").reduce(function(prev,curr){return prev&&curr.charCodeAt(0)>=32&&curr.charCodeAt(0)<=126},!0)&&t.length>1?(to_save+=',"wifi_psk":"'+t+'"',to_save+=',"wifi_wep_key1":"","wifi_wep_key2":"","wifi_wep_key3":"","wifi_wep_key4":""'):erm[erm.length]=_("Key or passphrase:").replace(":",""));else if(t!=read.result.wifi_wep_key1)switch(t.length){case 5:case 13:t.split("").reduce(function(prev,curr){return prev&&curr.charCodeAt(0)>=32&&curr.charCodeAt(0)<=126},!0)&&t.length>1?to_save+=',"wifi_psk":"","wifi_wep_key1":"'+t+'","wifi_wep_key2":"'+t+'","wifi_wep_key3":"'+t+'","wifi_wep_key4":"'+t+'"':erm[erm.length]=_("Key or passphrase:").replace(":","");break;case 10:case 26:hex.test(t)?to_save+=',"wifi_psk":"","wifi_wep_key1":"'+t+'","wifi_wep_key2":"'+t+'","wifi_wep_key3":"'+t+'","wifi_wep_key4":"'+t+'"':erm[erm.length]=_("Key or passphrase:").replace(":","");break;default:erm[erm.length]=_("Key or passphrase:").replace(":","")}}if(erm.length>0)new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel"));else{echo(to_save),gSTB.SetEnv("{"+to_save+"}");{gSTB.ServiceControl("wifi","restart")}saved_ok_msg(),load_main()}}function wifi_keys(){back_element[back_index]=0,back_index++,back_element[back_index]=0,save_function=wifi_keys_save,document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=wifi_password_load,read=JSON.parse(gSTB.GetEnv('{"varList":["wifi_wep_def_key","wifi_wep_key1","wifi_wep_key2","wifi_wep_key3","wifi_wep_key4"]}'));var arr=[{element:"input",type:"password",title:_("Passphrase:"),value:""},{element:"button",onClick:gen64,title:"",value:_("Generate WEP 64 keys")},{element:"button",onClick:gen128,title:"",value:_("Generate WEP 128 keys")},{element:"input",type:"password",title:_("Default key")+" (1-4):",value:read.result.wifi_wep_def_key},{element:"input",type:"password",title:_("Key")+" 1 (5,10,13,26 "+_("symbols")+"):",value:read.result.wifi_wep_key1},{element:"input",type:"password",title:_("Key")+" 2 (5,10,13,26 "+_("symbols")+"):",value:read.result.wifi_wep_key2},{element:"input",type:"password",title:_("Key")+" 3 (5,10,13,26 "+_("symbols")+"):",value:read.result.wifi_wep_key3},{element:"input",type:"password",title:_("Key")+" 4 (5,10,13,26 "+_("symbols")+"):",value:read.result.wifi_wep_key4}];generate_elements(arr)}function gen64(){var a=navigation.elements[0].value;if(a.length>=1){var key=JSON.parse(gSTB.GetWepKey64ByPassPhrase(a));navigation.elements[4].value=key.result["wep64-key1"],navigation.elements[5].value=key.result["wep64-key2"],navigation.elements[6].value=key.result["wep64-key3"],navigation.elements[7].value=key.result["wep64-key4"]}else new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+_("Passphrase:").replace(":",""),_("Cancel"))}function gen128(){var a=navigation.elements[0].value;if(a.length>=1){var key=JSON.parse(gSTB.GetWepKey128ByPassPhrase(a));navigation.elements[4].value=key.result["wep128-key1"],navigation.elements[5].value=key.result["wep128-key1"],navigation.elements[6].value=key.result["wep128-key1"],navigation.elements[7].value=key.result["wep128-key1"]}else new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+_("Passphrase:").replace(":",""),_("Cancel"))}function wifi_keys_save(){var erm=[],pars=/^[1-4]$/,hex=/^[a-fA-F0-9]+$/;to_save+=""!=to_save?',"wifi_psk":""':'"wifi_psk":""';var t=navigation.elements[3].value;t!=read.result.wifi_wep_def_key&&(pars.test(t)?to_save+=',"wifi_wep_def_key":"'+t+'"':erm[erm.length]=_("Default key")),t=navigation.elements[4].value;var a=t.length;if(t!=read.result.wifi_wep_key1)switch(t.length){case 5:case 13:t.split("").reduce(function(prev,curr){return prev&&curr.charCodeAt(0)>=32&&curr.charCodeAt(0)<=126},!0)&&t.length>1?to_save+=',"wifi_wep_key1":"'+t+'"':erm[erm.length]=_("Key")+" 1";break;case 10:case 26:hex.test(t)?to_save+=',"wifi_wep_key1":"'+t+'"':erm[erm.length]=_("Key")+" 1";break;default:erm[erm.length]=_("Key")+" 1"}if(t=navigation.elements[5].value,a==t.length){if(t!=read.result.wifi_wep_key2)switch(t.length){case 5:case 13:t.split("").reduce(function(prev,curr){return prev&&curr.charCodeAt(0)>=32&&curr.charCodeAt(0)<=126},!0)&&t.length>1?to_save+=',"wifi_wep_key2":"'+t+'"':erm[erm.length]=_("Key")+" 2";break;case 10:case 26:hex.test(t)?to_save+=',"wifi_wep_key2":"'+t+'"':erm[erm.length]=_("Key")+" 2";break;default:erm[erm.length]=_("Key")+" 2"}}else erm[erm.length]=_("Key")+" 2";if(t=navigation.elements[6].value,a==t.length){if(t!=read.result.wifi_wep_key3)switch(t.length){case 5:case 13:t.split("").reduce(function(prev,curr){return prev&&curr.charCodeAt(0)>=32&&curr.charCodeAt(0)<=126},!0)&&t.length>1?to_save+=',"wifi_wep_key3":"'+t+'"':erm[erm.length]=_("Key")+" 3";break;case 10:case 26:hex.test(t)?to_save+=',"wifi_wep_key3":"'+t+'"':erm[erm.length]=_("Key")+" 3";break;default:erm[erm.length]=_("Key")+" 3"}}else erm[erm.length]=_("Key")+" 3";if(t=navigation.elements[7].value,a==t.length){if(t!=read.result.wifi_wep_key4)switch(t.length){case 5:case 13:t.split("").reduce(function(prev,curr){return prev&&curr.charCodeAt(0)>=32&&curr.charCodeAt(0)<=126},!0)&&t.length>1?to_save+=',"wifi_wep_key4":"'+t+'"':erm[erm.length]=_("Key")+" 4";break;case 10:case 26:hex.test(t)?to_save+=',"wifi_wep_key4":"'+t+'"':erm[erm.length]=_("Key")+" 4";break;default:erm[erm.length]=_("Key")+" 4"}}else erm[erm.length]=_("Key")+" 4";if(erm.length>0)new CModalAlert(SettingsPage,_("Notice"),_("Following fields filled in incorrectly:")+"<br />"+erm.join(", "),_("Cancel"));else{gSTB.SetEnv("{"+to_save+"}");{gSTB.ServiceControl("wifi","restart")}saved_ok_msg(),load_main()}}function wired_load_info(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),to_save="",document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.INFO,save_function=function(){},back_function=netInfo_load,"wired_load_info"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Wired (Ethernet)"),"wired_load_info"),read=JSON.parse(gSTB.GetEnv('{"varList":["lan_noip","ipaddr_conf","dnsip"]}'));var tt=gSTB.GetNetworkGateways(),tt1=gSTB.GetNetworkNameServers();if("true"!=read.result.lan_noip){var tcur="";cIP(read.result.ipaddr_conf)?tcur=_("Static IP"):(tcur="DHCP",cIP(read.result.dnsip)&&(tcur+="("+_("Manual DNS")+")"))}else var tcur=_("No config");var arr=[{title:_("Current configuration")},{value:tcur},{title:_("Current status")},{title:_("Link status:"),value:gSTB.GetLanLinkStatus()?"UP":"DOWN"},{title:_("MAC address:"),value:gSTB.GetDeviceMacAddress()},{title:_("IP address:"),value:gSTB.RDir("IPAddress")},{title:_("Network mask:"),value:gSTB.RDir("IPMask")},{title:_("Gateway:"),value:""==tt?"n/a":tt.replace(/\r\n|\r|\n/g,", ")},{title:_("DNS server:"),value:""==tt1?"n/a":tt1.replace(/\r\n|\r|\n/g,", ")}];UpdateFooter(),generate_table(arr)}function pppoe_load_info(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),to_save="",document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.INFO,save_function=function(){},back_function=netInfo_load,"pppoe_load_info"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("PPPoE"),"pppoe_load_info"),read=JSON.parse(gSTB.GetEnv('{"varList":["pppoe_enabled","pppoe_login","pppoe_dns1"]}'));var tcur="";"true"!=read.result.pppoe_enabled?tcur=_("Disabled"):(tcur=read.result.pppoe_login,cIP(read.result.pppoe_dns1)&&(tcur+="("+_("Manual DNS")+")"));var tip=gSTB.GetPppoeIp(),tt=gSTB.GetNetworkGateways(),tt1=gSTB.GetNetworkNameServers(),arr=[{title:_("Current configuration")},{value:tcur},{title:_("Current status")},{title:_("Link status:"),value:gSTB.GetPppoeLinkStatus()?"UP":"DOWN"},{title:_("IP address:"),value:""==tip?"n/a":tip},{title:_("Gateway:"),value:""==tt?"n/a":tt.replace(/\r\n|\r|\n/g,", ")},{title:_("DNS server:"),value:""==tt1?"n/a":tt1.replace(/\r\n|\r|\n/g,", ")}];UpdateFooter(),generate_table(arr)}function wifi_load_info(){(this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),to_save="",document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.INFO,save_function=function(){},back_function=netInfo_load,"wifi_load_info"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder.png",_("Wireless (Wi-Fi)"),"wifi_load_info"),read=JSON.parse(gSTB.GetEnv('{"varList":["wifi_ssid","wifi_int_ip"]}'));var tcur="",tt=gSTB.GetNetworkGateways(),tt1=gSTB.GetNetworkNameServers(),tcur='"'+read.result.wifi_ssid+'" ( ';tcur+=cIP(read.result.wifi_int_ip)?_("Static IP")+")":"DHCP)";var tmac=gSTB.GetNetworkWifiMac(),tip=gSTB.RDir("WiFi_ip"),arr=[{title:_("Current configuration")},{value:tcur},{title:_("Current status")},{title:_("Link status:"),value:gSTB.GetWifiLinkStatus()?"UP":"DOWN"},{title:_("MAC address:"),value:""==tmac?"n/a":tmac},{title:_("IP address:"),value:""==tip?"n/a":tip},{title:_("Gateway:"),value:""==tt?"n/a":tt.replace(/\r\n|\r|\n/g,", ")},{title:_("DNS server:"),value:""==tt1?"n/a":tt1.replace(/\r\n|\r|\n/g,", ")}];UpdateFooter(),generate_table(arr)}function check_input_left(){clearTimeout(timer.checkLR),clearTimeout(timer.backClass),butUdDownDisable=!0,timer.checkLR=setTimeout(check_portal,600)}function check_input_right(){clearTimeout(timer.checkLR),clearTimeout(timer.backClass),butUdDownDisable=!0,timer.checkLR=setTimeout(check_portal,600)}function check_portal(){butDisable=!0;var tmpNavElemArray=[];echo(checkInp,"checkInp");var ch=document.getElementById("sub_chPortal_"+checkInp),name=document.getElementById("sub_namePortal_"+checkInp),url=document.getElementById("sub_urlPortal_"+checkInp);document.getElementById("chPortal_"+checkInp).className="",document.getElementById("namePortal_"+checkInp).className="wide500",document.getElementById("urlPortal_"+checkInp).className="wide500",checkInp=navigation.elements[navigation.element].value,echo(checkInp,"checkInp");var ch1=document.getElementById("sub_chPortal_"+checkInp),name1=document.getElementById("sub_namePortal_"+checkInp),url1=document.getElementById("sub_urlPortal_"+checkInp);document.getElementById("chPortal_"+checkInp).checked?(document.getElementById("chPortal_"+checkInp).className="elements sub_active",document.getElementById("namePortal_"+checkInp).className="elements wide500 sub_active",document.getElementById("urlPortal_"+checkInp).className="elements wide500 sub_active"):(document.getElementById("chPortal_"+checkInp).className="elements",document.getElementById("namePortal_"+checkInp).className="elements wide500 disabled",document.getElementById("urlPortal_"+checkInp).className="elements wide500 disabled"),ch.className="noitem",name.className="noitem",url.className="noitem",ch1.className="item",name1.className="item",url1.className="item",ch.style.display="none",name.style.display="none",url.style.display="none",ch1.style.display="",name1.style.display="",url1.style.display="";var d=document.getElementById(as.page_list[as.page]).getElementsByClassName("list")[0];navigation.elements.splice(4),tmpNavElemArray=d.getElementsByClassName("elements");for(var i=4;i<tmpNavElemArray.length;i++)navigation.elements.push(tmpNavElemArray[i]);navigation.pre_elements=d.getElementsByClassName("item"),butDisable=!1,butUdDownDisable=!1,timer.backClass=setTimeout(function(){document.getElementById("chPortal_"+checkInp).checked?(document.getElementById("chPortal_"+checkInp).className="elements",document.getElementById("namePortal_"+checkInp).className="elements wide500",document.getElementById("urlPortal_"+checkInp).className="elements wide500"):(document.getElementById("chPortal_"+checkInp).className="elements",document.getElementById("namePortal_"+checkInp).className="elements wide500 disabled",document.getElementById("urlPortal_"+checkInp).className="elements wide500 disabled")
},400)}function SetDRC(a){switch(this.value&&(a=this.value),echo("SetDRC : "+a),a){case"Off":gSTB.SetDRC(0,0);break;case"MAX":gSTB.SetDRC(255,255);break;default:var a=parseInt(a,10);gSTB.SetDRC(31*a,31*a)}}function SAOM(a){switch(this.value&&(a=this.value),echo("SAOM : "+a),a){case"RF_MODDE":gSTB.SetAudioOperationalMode(0);break;case"LINE_MODE":gSTB.SetAudioOperationalMode(1);break;case"CUSTOM0":gSTB.SetAudioOperationalMode(2);break;case"CUSTOM1":gSTB.SetAudioOperationalMode(3)}}function SSM(a){switch(this.value&&(a=this.value),echo("SSM : "+a),a){case"STEREO":gSTB.SetStereoMode(0);break;case"MONO":gSTB.SetStereoMode(1);break;case"MONO_LEFT":gSTB.SetStereoMode(2);break;case"MONO_RIGHT":gSTB.SetStereoMode(3);break;case"LT_RT":gSTB.SetStereoMode(4)}}function check_leng_ip(){var tt=/^([0-9]+)$/;if(tt.test(this.value))this.value>255&&(this.value=255),3==this.value.length&&(navigation.sub_element<3?(navigation.sub_element++,setTimeout(ip_input_change,50)):navigation.element<3&&(navigation.element++,navigation.sub_element=0,setTimeout(ip_input_change,50)));else{if(this.value=0,navigation.sub_element>0)return navigation.sub_element--,void setTimeout(ip_input_change,50);if(navigation.element>0)return navigation.element--,navigation.sub_element=3,void setTimeout(ip_input_change,50);setTimeout(function(){document.activeElement.select()},50)}}function ip_input_change(){document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements"+navigation.element)[navigation.sub_element].focus()}function mouse_over(){navigation.elements[navigation.element].className=navigation.oldClass,navigation.element=this.number,navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active"}function mouse_over_wifi(){navigation.elements[navigation.element].className=navigation.oldClass,navigation.element=this.number,navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.wifi_auch.innerHTML=_("Authentication method:")+" "+read.result[navigation.element].auth,navigation.wifi_encrypt.innerHTML=_("Encryption:")+" "+read.result[navigation.element].enc}function mouse_over_element(){navigation.pre_elements[navigation.element]!==navigation.pre_elements[this.number]&&(navigation.pre_elements[navigation.element].className=navigation.oldClass,navigation.element=this.number,navigation.oldClass=navigation.pre_elements[navigation.element].className,navigation.pre_elements[navigation.element].className+=" active",navigation.pre_elements[navigation.element].focus(),navigation.elements[navigation.element].focus())}function lang_clear(){var dict;list.main=[],list.lan=[],list.servers=[],list.lanInfo=[],list.lan_pppoe=[],list.lan_wifi=[],list.lan_wired=[],list.main=[],dict=[{name:_("Network"),rId:"Network",className:"network_settings",func:network_load},{name:_("Servers"),rId:"Servers",className:"servers",func:servers_load},{name:_("Video"),rId:"Video",className:"video",func:video_load},{name:_("Audio"),rId:"Audio",className:"audio",func:audio_load},{name:_("Advanced settings"),rId:"AdvancedSettings",className:"advSet",func:advSet_load},{name:_("Keyboard layout"),rId:"KeyboardLayout",className:"keyboard_layout",func:keyboard_layout_load},{name:_("Network info"),rId:"NetworkInfo",className:"net_info",func:netInfo_load},{name:_("Device info"),rId:"DeviceInfo",className:"dev_info",func:devInfo_load},{name:_("Reboot portal"),rId:"RebootPortal",className:"reload",func:reload_message},{name:_("Reboot device"),rId:"RebootDevice",className:"reboot",func:reboot_message},{name:_("Reset settings"),rId:"ResetSettings",className:"reset",func:reset_message},{name:_("Clear user data"),rId:"ClearUserData",className:"clear_ico",func:clear_message},{name:_("Software update"),rId:"SoftwareUpdate",className:"update",func:function(){UpdatePage.Show()}}],dict.forEach(function(menuItem){RULES[menuItem.rId]&&list.main.push(menuItem)})}function encoding_check(){switch(this.value||(button=navigation.elements[4],sub_button=navigation.pre_elements[4],password=navigation.elements[3],sub_password=navigation.pre_elements[3]),navigation.elements[2].value){case"none":password.className="elements_skip wide500",button.className="elements_skip wide500",sub_password.style.display="none",sub_button.style.display="none";break;case"tkip":case"aes":password.className="elements wide500",button.className="elements_skip wide500",sub_password.style.display="table",sub_button.style.display="none";break;case"wep":button.className="elements wide500",password.className="elements wide500",sub_password.style.display="table",sub_button.style.display="table"}document.getElementById(as.page_list[as.page]).style.display="block",navigation.elements[navigation.element].focus()}function saved_ok_msg(){new CModalHint(SettingsPage,_("Successfully saved"),2e3)}function checkResolution(mode){mode=mode||navigation.elements[0].GetValue();var resolutions=[{value:"tvsystem_res",title:_("Same as video"),exceptions:[]},{value:"720",title:"720x576",exceptions:[]},{value:"1280",title:"1280x720",exceptions:["PAL","NTSC","576p-50"]},{value:"1920",title:"1920x1080",exceptions:["PAL","NTSC","576p-50","720p-50","720p-60"]}],data=[];return resolutions.forEach(function(res){-1===res.exceptions.indexOf(mode)&&data.push(res)}),data}function checkDefaultPortals(){for(var portArray=[{title:_("Internal portal"),value:"0"}],i=0;i<portals.portals.length;i++)portals.portals[i].enable===!0&&(portArray=portArray.concat(""!==portals.portals[i].name?[{title:_("Portal:")+" "+(i+1)+" ("+portals.portals[i].name+")",value:i+1}]:[{title:_("Portal:")+" "+(i+1),value:i+1}]));return portArray}function refreshDefaultPortals(){inputDisable(this);var id=this.id.replace("chPortal_","");id-=1;for(var portArray=[{title:_("Internal portal"),value:"0"}],i=0;i<portals.portals.length;i++)i===id&&portals.portals[i].enable!==this.checked&&(portals.portals[i].enable=this.checked),portals.portals[i].enable===!0&&(portArray=portArray.concat(""!==portals.portals[i].name?[{title:_("Portal:")+" "+(i+1)+" ("+portals.portals[i].name+")",value:i+1}]:[{title:_("Portal:")+" "+(i+1),value:i+1}]));navigation.elements[1].SetData(portArray),this.checked||navigation.elements[1].SetIndex(0)}function inputDisable(element){var id=element.id.replace("chPortal_","");element.checked?(document.getElementById("namePortal_"+id).disabled=!1,document.getElementById("namePortal_"+id).className="elements wide500",document.getElementById("urlPortal_"+id).disabled=!1,document.getElementById("urlPortal_"+id).className="elements wide500"):(document.getElementById("namePortal_"+id).disabled=!0,document.getElementById("namePortal_"+id).className="elements wide500 disabled",document.getElementById("urlPortal_"+id).disabled=!0,document.getElementById("urlPortal_"+id).className="elements wide500 disabled")}function parseDate(dateStr){return new Date(dateStr.match(/\w{3}\s\w{3}\s\d{1,2}\s\d{1,2}:\d{1,2}:\d{1,2}/)+" "+dateStr.match(/\d{4}/))}function keyboard_layout_load(){var keyboardFile,array=[],keyboardLayouts=[],langTitles={ru:_("Russian"),uk:_("Ukrainian"),en:_("English"),de:_("German")};(this.number||0===this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),"keyboard_layout"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Push("","folder_keyboard_layout.png",_("Keyboard layout"),"keyboard_layout"),document.getElementById(as.page_list[as.page]).style.display="none",as.page=as.pages.ELEMENTS,back_function=load_main,save_function=keyboard_layout_save,layoutsString="",keyboardFile=gSTB.LoadUserData("keyboard.json");try{keyboardFile=JSON.parse(keyboardFile)}catch(error){echo(error,"keyboard.json parse")}if(keyboardFile&&keyboardFile.layouts&&keyboardFile.layouts.length>0){for(var i=0;i<keyboardFile.order.length;i++)keyboardLayouts.push({code:keyboardFile.order[i],title:langTitles[keyboardFile.order[i]]});for(var i=0;i<keyboardLayouts.length;i++)for(var j=0;j<keyboardFile.layouts.length;j++)keyboardLayouts[i].code===keyboardFile.layouts[j]&&(keyboardLayouts[i].enable=!0)}else{for(var arr=[],i=0;i<keyboards[main_lang][0].length;i++)-1===arr.indexOf(keyboards[main_lang][0][i])&&arr.push(keyboards[main_lang][0][i]);for(var i=0;i<keyboards.codes.length;i++)-1===arr.indexOf(keyboards.codes[i])&&arr.push(keyboards.codes[i]);for(var i=0;i<arr.length;i++)keyboardLayouts.push({code:arr[i],title:langTitles[arr[i]]});for(var i=0;i<keyboardLayouts.length;i++)for(var j=0;j<keyboards[main_lang].length;j++)keyboardLayouts[i].code===keyboards[main_lang][j][0]&&(keyboardLayouts[i].enable=!0)}for(var i=0;i<keyboardLayouts.length;i++)array[i]={element:"checkbox",title:_(keyboardLayouts[i].title)+":",code:keyboardLayouts[i].code,checked:keyboardLayouts[i].enable},layoutsString+=keyboardLayouts[i].code;echo(layoutsString,"!!!! layoutsString !!!!"),generate_elements(array),UpdateFooter(!1,!1,!0)}function keyboard_layout_save(){for(var keyboardFile={layouts:[],order:[]},i=0;i<navigation.elements.length;i++)navigation.elements[i].checked&&keyboardFile.layouts.push(navigation.elements[i].code),keyboardFile.order.push(navigation.elements[i].code);gSTB.SaveUserData("keyboard.json",JSON.stringify(keyboardFile)),layoutOrderChanged=!1,keyboard_layout_load(),0===keyboardFile.layouts.length?new CModalHint(SettingsPage,_("None of the proposed layouts selected.<br>Layouts will be selected according to the location."),6e3):saved_ok_msg()}function myConfirm(text,ok,exit){new CModalConfirm(SettingsPage,_("Confirm"),text,_("Cancel"),exit,_("Save"),ok)}function myAlert(text){return new CModalAlert(SettingsPage,"",text,_("Cancel"))}function decode(utftext){for(var string="",i=0,c=c1=c2=0;i<utftext.length;)c=utftext.charCodeAt(i),128>c?(string+=String.fromCharCode(c),i++):c>191&&224>c?(c2=utftext.charCodeAt(i+1),string+=String.fromCharCode((31&c)<<6|63&c2),i+=2):(c2=utftext.charCodeAt(i+1),c3=utftext.charCodeAt(i+2),string+=String.fromCharCode((15&c)<<12|(63&c2)<<6|63&c3),i+=3);return string}function URLC(url){var a=getIP(url);return 0!=a[0]?cIP(a[0])&&a[1]<=65535:checkURL(url)}function getIP(url){var tt;if(/^(https?|http|ftp|telnet|igmp):\/\/[0-9.]+:[0-9]+$/.test(url)){tt=url.split(":");var tip=tt[1].split("//"),a=[tip[1],tt[2],0];return a}if(/^(https?|http|ftp|telnet|igmp):\/\/[0-9.]+$/.test(url))return tt=url.split("//"),[tt[1],0,0];if(/^(https?|http|ftp|telnet|igmp):\/\/[0-9.]+:[0-9]+\//.test(url)){tt=url.split(":");for(var tip=tt[1].split("//"),tput=tt[2].split("/"),zput="",i=1;i<tput.length;i++)zput+="/"+tput[i];var a=[tip[1],tput[0],zput];return a}if(/^(https?|http|ftp|telnet|igmp):\/\/[0-9.]+\//.test(url)){tt=url.split("/");for(var zput="",i=3;i<tt.length;i++)zput+="/"+tt[i];return[tt[2],0,zput]}return[0,0,0]}function cIP(ip){if(""==ip||"0.0.0.0"==ip)return!1;var test=ip.split("."),pip=/^([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})$/;if(4!=test.length)return!1;if(!pip.test(ip))return!1;for(var i=0;4>i;i++)if(parseInt(test[i],10)<0||parseInt(test[i],10)>255)return!1;return!0}function toIp(t){var t1=parseInt(""!=t[0].value?t[0].value:0,10),t2=parseInt(""!=t[1].value?t[1].value:0,10),t3=parseInt(""!=t[2].value?t[2].value:0,10),t4=parseInt(""!=t[3].value?t[3].value:0,10);return t1+"."+t2+"."+t3+"."+t4}function ip_onFocus(){this.select(!0)}function checkURL(url){var regURLrf=/(^(https?|http|ftp|telnet|igmp):\/\/)?[а-я0-9~_\-\.]+\.[а-я]{2,9}(\/|:|\?[!-~]*)?$/i,regURL=/(^(https?|http|ftp|telnet|igmp):\/\/)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/i;return regURLrf.test(url)||regURL.test(url)}var DEBUG=!0,DEBUG_NAME="",DEBUG_SERVER="",EMULATION=!1,PATH_MODE_WEB=!1,PATH_ROOT="/home/web/",PATH_SYSTEM=PATH_ROOT+"system/",PATH_MEDIA="/media/",WINDOW_WIDTH=screen.width,WINDOW_HEIGHT=screen.height,URL_PARAMS={},proxy;["http:","https:"].indexOf(document.location.protocol)>=0&&(PATH_MODE_WEB=!0,Array.prototype.slice.call(document.getElementsByTagName("script")).forEach(function(tag){if(tag.src){var path=tag.src.split("/"),head=path.pop();0===head.indexOf("init.js")&&(PATH_SYSTEM=path.join("/")+"/",path.pop(),PATH_ROOT=path.join("/")+"/")}})),document.location.search&&document.location.search.substring(1).split("&").forEach(function(part){part=part.split("="),2===part.length&&(URL_PARAMS[part[0]]=decodeURIComponent(part[1]))}),void 0===window.gSTB?(DEBUG=EMULATION=!0,DEBUG_SERVER=DEBUG_SERVER||localStorage.getItem("DEBUG_SERVER"),DEBUG_NAME=DEBUG_NAME||localStorage.getItem("DEBUG_NAME"),WINDOW_WIDTH=parseInt(URL_PARAMS.width,10)||window.outerWidth,WINDOW_HEIGHT=parseInt(URL_PARAMS.height,10)||window.outerHeight,document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'gstb.js"></script>\n'),document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'debug.js"></script>\n'),document.write('<script type="text/javascript" src="http://'+DEBUG_SERVER+':8800/file/client.js"></script>\n'),document.write('<script type="text/javascript">if ( window.proxyClient ) {proxy = new proxyClient();if ( DEBUG_NAME && DEBUG_SERVER ) proxy.init({name:"'+DEBUG_NAME+'", host:"'+DEBUG_SERVER+'"}); }</script>\n'),window.addEventListener("load",function(){document.body.style.backgroundColor="black"})):(gSTB.SetNativeStringMode(!0),function(){var vars=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["debug","debug_name","debug_server"]})));!vars.errMsg&&vars.result&&(DEBUG="1"===vars.result.debug,DEBUG&&!URL_PARAMS.nodebug&&(document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'debug.js"></script>\n'),DEBUG_NAME=DEBUG_NAME||vars.result.debug_name,DEBUG_SERVER=DEBUG_SERVER||vars.result.debug_server,DEBUG_NAME&&DEBUG_SERVER&&document.write('<script type="text/javascript" src="http://'+DEBUG_SERVER+":8000/target/target-script-min.js#"+DEBUG_NAME+'"></script>\n')))}());var PATH_IMG_SYSTEM=PATH_SYSTEM+"img/"+WINDOW_WIDTH+"/",PATH_IMG_PUBLIC=PATH_ROOT+"public/img/"+WINDOW_WIDTH+"/",WINDOWS={PORTAL:"portal",HELP:"help",DOWNLOAD_MANAGER:"dlman",PVR:"recordsManager",BROWSER:"ibman",BROWSER_VIEW:"ibmanView",PORTALS_LOADER:"portalsLoader",SYSTEM_SETTINGS:"systemSettings"},KEYS={BACK:8,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,NUM0:48,DELETE:46,CHANNEL_PREV:1009,CHANNEL_NEXT:9,OK:13,EXIT:27,UP:38,DOWN:40,LEFT:37,RIGHT:39,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,VOLUME_UP:107,VOLUME_DOWN:109,F1:112,F2:113,F3:114,F4:115,REFRESH:116,FRAME:117,PHONE:119,SET:120,TV:121,MENU:122,WEB:123,MIC:2032,REWIND:2066,FORWARD:2070,APP:2076,USB_MOUNTED:2080,USB_UNMOUNTED:2081,PLAY_PAUSE:2082,STOP:2083,POWER:2085,RECORD:2087,INFO:2089,MUTE:2192,CLOCK:2032,AUDIO:2071};if(void 0===window.echo&&(window.echo=function(){}),ajax.stop=!1,parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},!("classList"in document.documentElement)){var prototype=Array.prototype,indexOf=prototype.indexOf,slice=prototype.slice,push=prototype.push,splice=prototype.splice,join=prototype.join;window.DOMTokenList=function(el){if(this._element=el,el.className!=this._classCache){if(this._classCache=el.className,!this._classCache)return;var i,classes=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/);for(i=0;i<classes.length;i++)push.call(this,classes[i])}},DOMTokenList.prototype={add:function(token){this.contains(token)||(push.call(this,token),this._element.className=slice.call(this,0).join(" "))},contains:function(token){return-1!==indexOf.call(this,token)},item:function(index){return this[index]||null},remove:function(token){var i=indexOf.call(this,token);-1!==i&&(splice.call(this,i,1),this._element.className=slice.call(this,0).join(" "))},toString:function(){return join.call(this," ")},toggle:function(token){return this.contains(token)?this.remove(token):this.add(token),this.contains(token)}},Object.defineProperty(Element.prototype,"classList",{get:function(){return new DOMTokenList(this)}})}var Events={bind:function(event,callback){if(this._events||(this._events={}),"object"==typeof event)for(var name in event)this.bind(name,event[name]);else"string"==typeof event&&"function"==typeof callback&&(void 0===this._events[event]&&(this._events[event]=[]),this._events[event].push(callback))},trigger:function(event,data){var result,results=[],self=this;return void 0!==event&&void 0!==this._events&&void 0!==this._events[event]&&this._events[event].forEach(function(ev){result=ev.call(self,data),void 0!=result&&results.push(result)}),results},unbind:function(event){delete this._events[event]},inject:function(obj){"function"==typeof obj?extend(obj.prototype,this):"object"==typeof obj&&extend(obj,this)}},timeZoneOffsets={A:{index:-1,minutes:60},ACDT:{index:-1,minutes:60},ACST:{index:-1,minutes:570},ADT:{index:1,minutes:180},AEDT:{index:-1,minutes:61},AEST:{index:-1,minutes:60},AFT:{index:-1,minutes:270},AKDT:{index:1,minutes:480},AKST:{index:1,minutes:540},ALMT:{index:-1,minutes:360},AMST:{index:1,minutes:180},AMT:{index:1,minutes:240},ANAST:{index:-1,minutes:62},ANAT:{index:-1,minutes:62},AQTT:{index:-1,minutes:300},ART:{index:1,minutes:180},AST:{index:1,minutes:240},AWDT:{index:-1,minutes:540},AWST:{index:-1,minutes:480},AZOST:{index:0,minutes:0},AZOT:{index:1,minutes:60},AZST:{index:-1,minutes:300},AZT:{index:-1,minutes:240},B:{index:-1,minutes:120},BNT:{index:-1,minutes:480},BOT:{index:1,minutes:240},BRST:{index:1,minutes:120},BRT:{index:1,minutes:180},BST:{index:-1,minutes:60},BTT:{index:-1,minutes:360},C:{index:-1,minutes:180},CAST:{index:-1,minutes:480},CAT:{index:-1,minutes:120},CCT:{index:-1,minutes:390},CDT:{index:1,minutes:300},CEST:{index:-1,minutes:120},CET:{index:-1,minutes:60},CHADT:{index:-1,minutes:63},CHAST:{index:-1,minutes:62},CKT:{index:1,minutes:60},CLST:{index:1,minutes:180},CLT:{index:1,minutes:240},COT:{index:1,minutes:300},CST:{index:1,minutes:360},CVT:{index:1,minutes:60},CXT:{index:-1,minutes:420},ChST:{index:-1,minutes:60},D:{index:-1,minutes:240},DAVT:{index:-1,minutes:420},E:{index:-1,minutes:300},EASST:{index:1,minutes:300},EAST:{index:1,minutes:360},EAT:{index:-1,minutes:180},ECT:{index:1,minutes:300},EDT:{index:-1,minutes:61},EEST:{index:-1,minutes:180},EET:{index:-1,minutes:120},EGST:{index:0,minutes:0},EGT:{index:1,minutes:60},EST:{index:1,minutes:300},ET:{index:1,minutes:300},F:{index:-1,minutes:360},FJST:{index:-1,minutes:63},FJT:{index:-1,minutes:62},FKST:{index:1,minutes:180},FKT:{index:1,minutes:240},FNT:{index:1,minutes:120},G:{index:-1,minutes:420},GALT:{index:1,minutes:360},GAMT:{index:1,minutes:540},GET:{index:-1,minutes:240},GFT:{index:1,minutes:180},GILT:{index:-1,minutes:62},GMT:{index:0,minutes:0},GST:{index:-1,minutes:240},GYT:{index:1,minutes:240},H:{index:-1,minutes:480},HAA:{index:1,minutes:180},HAC:{index:1,minutes:300},HADT:{index:1,minutes:540},HAE:{index:1,minutes:240},HAP:{index:1,minutes:420},HAR:{index:1,minutes:360},HAST:{index:1,minutes:60},HAT:{index:1,minutes:150},HAY:{index:1,minutes:480},HKT:{index:-1,minutes:480},HLV:{index:1,minutes:270},HNA:{index:1,minutes:240},HNC:{index:1,minutes:360},HNE:{index:1,minutes:300},HNP:{index:1,minutes:480},HNR:{index:1,minutes:420},HNT:{index:1,minutes:210},HNY:{index:1,minutes:540},HOVT:{index:-1,minutes:420},I:{index:-1,minutes:540},ICT:{index:-1,minutes:420},IDT:{index:-1,minutes:180},IOT:{index:-1,minutes:360},IRDT:{index:-1,minutes:270},IRKST:{index:-1,minutes:540},IRKT:{index:-1,minutes:540},IRST:{index:-1,minutes:210},IST:{index:-1,minutes:60},JST:{index:-1,minutes:540},K:{index:-1,minutes:60},KGT:{index:-1,minutes:360},KRAST:{index:-1,minutes:480},KRAT:{index:-1,minutes:480},KST:{index:-1,minutes:540},KUYT:{index:-1,minutes:240},L:{index:-1,minutes:61},LHDT:{index:-1,minutes:61},LHST:{index:-1,minutes:60},LINT:{index:-1,minutes:64},M:{index:-1,minutes:62},MAGST:{index:-1,minutes:62},MAGT:{index:-1,minutes:62},MART:{index:1,minutes:570},MAWT:{index:-1,minutes:300},MDT:{index:1,minutes:360},MESZ:{index:-1,minutes:120},MEZ:{index:-1,minutes:60},MHT:{index:-1,minutes:62},MMT:{index:-1,minutes:390},MSD:{index:-1,minutes:240},MSK:{index:-1,minutes:240},MST:{index:1,minutes:420},MUT:{index:-1,minutes:240},MVT:{index:-1,minutes:300},MYT:{index:-1,minutes:480},N:{index:1,minutes:60},NCT:{index:-1,minutes:61},NDT:{index:1,minutes:150},NFT:{index:-1,minutes:61},NOVST:{index:-1,minutes:420},NOVT:{index:-1,minutes:360},NPT:{index:-1,minutes:345},NST:{index:1,minutes:210},NUT:{index:1,minutes:61},NZDT:{index:-1,minutes:63},NZST:{index:-1,minutes:62},O:{index:1,minutes:120},OMSST:{index:-1,minutes:420},OMST:{index:-1,minutes:420},P:{index:1,minutes:180},PDT:{index:1,minutes:420},PET:{index:1,minutes:300},PETST:{index:-1,minutes:62},PETT:{index:-1,minutes:62},PGT:{index:-1,minutes:60},PHOT:{index:-1,minutes:63},PHT:{index:-1,minutes:480},PKT:{index:-1,minutes:300},PMDT:{index:1,minutes:120},PMST:{index:1,minutes:180},PONT:{index:-1,minutes:61},PST:{index:1,minutes:480},PT:{index:1,minutes:480},PWT:{index:-1,minutes:540},PYST:{index:1,minutes:180},PYT:{index:1,minutes:240},Q:{index:1,minutes:240},R:{index:1,minutes:300},RET:{index:-1,minutes:240},S:{index:1,minutes:360},SAMT:{index:-1,minutes:240},SAST:{index:-1,minutes:120},SBT:{index:-1,minutes:61},SCT:{index:-1,minutes:240},SGT:{index:-1,minutes:480},SRT:{index:1,minutes:180},SST:{index:1,minutes:61},T:{index:1,minutes:420},TAHT:{index:1,minutes:60},TFT:{index:-1,minutes:300},TJT:{index:-1,minutes:300},TKT:{index:-1,minutes:63},TLT:{index:-1,minutes:540},TMT:{index:-1,minutes:300},TVT:{index:-1,minutes:62},U:{index:1,minutes:480},ULAT:{index:-1,minutes:480},UTC:{index:0,minutes:0},UYST:{index:1,minutes:120},UYT:{index:1,minutes:180},UZT:{index:-1,minutes:300},V:{index:1,minutes:540},VET:{index:1,minutes:270},VLAST:{index:-1,minutes:61},VLAT:{index:-1,minutes:61},VUT:{index:-1,minutes:61},W:{index:1,minutes:60},WAST:{index:-1,minutes:120},WAT:{index:-1,minutes:60},WEST:{index:-1,minutes:60},WESZ:{index:-1,minutes:60},WET:{index:0,minutes:0},WEZ:{index:0,minutes:0},WFT:{index:-1,minutes:62},WGST:{index:1,minutes:120},WGT:{index:1,minutes:180},WIB:{index:-1,minutes:420},WIT:{index:-1,minutes:540},WITA:{index:-1,minutes:480},WST:{index:-1,minutes:63},WT:{index:0,minutes:0},X:{index:1,minutes:61},Y:{index:1,minutes:62},YAKST:{index:-1,minutes:60},YAKT:{index:-1,minutes:60},YAPT:{index:-1,minutes:60},YEKST:{index:-1,minutes:360},YEKT:{index:-1,minutes:360},Z:{index:0,minutes:0}},gettext=function(){var module={},data=null;return module.init=function(options,onReady){options.name=options.name||"en",options.ext=options.ext||"js",options.path=options.path||"lang",data=null,"en"!==options.name?loadScript(options.path+"/"+options.name+"."+options.ext,onReady,onReady):"function"==typeof onReady&&onReady()},module.load=function(input){data=input},module.data=function(key){return null===data?key:void 0!==data[key]?data[key]:key},module}(),_=gettext.data;Update.CrashStatuses=[1,2,3,4,7,17,19,20,22,25,27],Update.OkStatus=21,Update.StatusMessages={1:"Signature init error",2:"Wrong device model",3:"Section size exceeds partition size on FLASH",4:"Required FLASH section not found. Aborting update",5:"Updating kernel",6:"Updating image",7:"Internal error",8:"Inspecting firmware",9:"Updating environment variables",10:"Updating Bootstrap section",11:"Skipping Bootstrap section",12:"Updating User FS section",13:"Skipping User FS section",14:"Updating second boot",15:"Updating logotype",16:"Update finished OK",17:"Wrong signature",18:"Erasing flash section",19:"Flash write error",20:"File write error",21:"Idle",22:"Invalid file header",23:"Inspecting update file",24:"File check finished",25:"File not found",26:"Initialising",27:"Read error"},Update.StartTFTP=function(timeout){var bootstrap_url=parseUri(Update.DefaultUpdateUrls.bootstrap_url),lan_params=["ipaddr","gatewayip","dnsip","netmask","ipaddr_conf"],lan_config=getEnvList(lan_params),type="up_dhcp_tftp",count=0;if(lan_config.ipaddr_conf&&"0.0.0.0"!==lan_params.ipaddr_conf){for(var i=0;i<lan_params.length;i++)lan_config[lan_params[i]]&&count++;if(count!==lan_params.length)return!1;type="up_ip_tftp"}return this.CheckUpdateByTFTP()?(setEnvList({serverip_conf:bootstrap_url.host,tftp_path_conf:bootstrap_url.relative.substr(1)})&&setTimeout(function(){gSTB.ExecAction("UpdateSW "+type)},timeout||0),!0):!1},Update.CheckUpdateByTFTP=function(){var update_url=parseUri(Update.DefaultUpdateUrls.update_url),ip_regexp=/^((?:[0-9]{1,3}\.){3}[0-9]{1,3})$/,bootstrap_regexp=/^(tftp):\/\/((?:[0-9]{1,3}\.){3}[0-9]{1,3})(:[0-9]+)?(\/.+)+$/;return-1===["igmp","tftp","http"].indexOf(update_url.protocol)?!1:"igmp"===update_url.protocol&&""!==update_url.relative?!1:"tftp"!==update_url.protocol&&"igmp"!==update_url.protocol||update_url.host.match(ip_regexp)?"Aura"===gSTB.GetDeviceModelExt().substr(0,4)?!1:!!Update.DefaultUpdateUrls.bootstrap_url.match(bootstrap_regexp):!1},Update.StartMulticast=function(timeout){var bootstrap_url=parseUri(Update.DefaultUpdateUrls.bootstrap_url);return this.CheckUpdateByMulticast&&setEnvList({mcip_conf:bootstrap_url.host,mcport_conf:bootstrap_url.port})?(setTimeout(function(){gSTB.ExecAction("UpdateSW up_mc_url")},timeout||0),!0):!1},Update.CheckUpdateByMulticast=function(){var regexp=/^(igmp):\/\/((?:[0-9]{1,3}\.){3}[0-9]{1,3})(:[0-9]+)?$/;return"Aura"===gSTB.GetDeviceModelExt().substr(0,4)?!1:!!Update.DefaultUpdateUrls.bootstrap_url.match(regexp)&&!!Update.DefaultUpdateUrls.update_url.match(regexp)},Update.DefaultUpdateUrls=getEnvList(["update_url","bootstrap_url"]),Update.prototype.Start=function(update_url){var status=stbUpdate.getStatus(),activeBank=stbUpdate.getActiveBank(),modelTemp=gSTB.RDir("Model").toUpperCase();if(status==Update.OkStatus&&this.update_url===update_url){if(this.trigger("onStart"),this.SystemButtons(!1),"MAG250"!==modelTemp&&"MAG270"!==modelTemp&&"MAG275"!==modelTemp&&-1!=activeBank&&2!=stbUpdate.GetFlashBankCount())return void this.trigger("onError",{errorMessage:_("Unable to update active memory bank"),logMessage:"Unable to update active memory bank",status:30});0==activeBank?stbUpdate.startUpdate(1,update_url):stbUpdate.startUpdate(0,update_url)}else this.CheckUpdate(update_url,!0);this.CheckProgress()},Update.prototype.CheckProgress=function(){var status=stbUpdate.getStatus(),self=this;this.CheckError(status)&&(this.auto_start===!0&&status===Update.OkStatus&&(this.auto_start=!1,this.Start(this.update_url)),this.trigger("onProgress",{percent:stbUpdate.getPercents(),statusMessage:_(Update.StatusMessages[status]),logMessage:Update.StatusMessages[status],status:status}),this.progress_timeout=setTimeout(function(){self.CheckProgress()},1e3))},Update.prototype.CheckError=function(status){return-1!==Update.CrashStatuses.indexOf(status)?(this.trigger("onError",{errorMessage:_(Update.StatusMessages[status]),logMessage:Update.StatusMessages[status],status:status}),this.SystemButtons(!0),!1):!0},Update.prototype.CheckUpdate=function(update_url,start_on_ready){"string"==typeof update_url&&stbUpdate.startCheck(this.check_url=update_url);var status=stbUpdate.getStatus(),self=this;if(this.CheckError(status))return this.trigger("onCheck",{statusMessage:_(Update.StatusMessages[status]),logMessage:Update.StatusMessages[status],status:status}),status===Update.OkStatus?(this.update_url=this.check_url,this.trigger("onReady"),void(start_on_ready===!0&&this.Start(this.update_url))):void(this.check_update_timeout=setTimeout(function(){self.CheckUpdate(null,start_on_ready)},100))},Update.prototype.GetImageInfo=function(){return stbUpdate.getStatus()===Update.OkStatus?{date:parseDate(stbUpdate.getImageDateStr()),description:stbUpdate.getImageDescStr(),version:stbUpdate.getImageVersionStr()}:null},Update.prototype.GetCurrentImageInfo=function(){if(void 0===this.curr_info){var info=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["Image_Desc","Image_Date","Image_Version"]}))).result;this.curr_info={date:parseDate(info.Image_Date),description:info.Image_Desc,version:info.Image_Version}}return this.curr_info},Update.prototype.Clear=function(){clearTimeout(this.check_update_timeout),clearTimeout(this.progress_timeout),this.auto_start=!1,this.update_url=""},Update.prototype.SystemButtons=function(enable){gSTB.EnableServiceButton(enable),gSTB.EnableVKButton(enable),gSTB.EnableAppButton(enable),gSTB.EnableTvButton(enable)},Events.inject(Update),CBase.prototype.SetParent=function(parent){parent instanceof CBase&&(this.parent=parent)},CBase.prototype.Init=function(handle){if(handle&&handle.nodeName){this.handle=handle,this.handleInner=this.baseClass&&-1===handle.className.indexOf(this.baseClass)?this.handle.appendChild(element("div",{className:this.baseClass})):this.handle;var self=this;this.handle.addEventListener("click",function(event){"function"==typeof self.onClick&&self.onClick()===!1&&event.stopPropagation()}),"function"==typeof this.onInit&&this.onInit()}},CBase.prototype.Activate=function(active){this.isActive=active!==!1,this.isActive?("function"==typeof this.onActivate&&this.onActivate(),this.parent&&(this.parent.activeChild&&this.parent.activeChild!==this&&this.parent.activeChild.Activate(!1),this.parent.activeChild=this)):("function"==typeof this.onDeactivate&&this.onDeactivate(),this.parent&&(this.parent.activeChild=null))},CBase.prototype.Show=function(visible,manageFocus){var success=!1;return this.handle&&(this.isVisible=visible!==!1,this.isVisible?this.handle.style.display!==this.showAttr&&(this.prevFocus=document.activeElement,manageFocus!==!1&&document.activeElement&&document.activeElement.blur(),this.handle.style.display=this.showAttr,manageFocus!==!1&&this.handle.focus(),"function"==typeof this.onShow&&this.onShow(),success=!0):"none"!==this.handle.style.display&&(manageFocus!==!1&&document.activeElement&&document.activeElement.blur(),this.handle.style.display="none",manageFocus!==!1&&this.prevFocus&&this.prevFocus.focus(),"function"==typeof this.onHide&&this.onHide(),this.isActive&&this.Activate(!1),success=!0)),success},CBase.prototype.Visible=function(mode){this.handle.style.visibility=Boolean(mode)?"visible":"hidden"},CBase.prototype.EventHandler=null,CBase.prototype.onInit=null,CBase.prototype.onShow=null,CBase.prototype.onHide=null,CBase.prototype.onActivate=null,CBase.prototype.onDeactivate=null,CBase.prototype.onClick=function(){return this.Activate(!0),!0},CProgressBar=function(parent,parentNode){CBase.call(this,parent||null),void 0===parentNode&&(parentNode=element("div")),elchild(parentNode,this.$bar=element("div",{className:"cprogressbar"},element("div",{className:"progressbar_bg"},[this.$line=element("div",{className:"progressbar_line"}),this.$digit=element("div",{className:"progressbar_digit"},"0 %")]))),this.Init(parentNode)},CProgressBar.prototype=Object.create(CBase.prototype),CProgressBar.prototype.constructor=CProgressBar,CProgressBar.prototype.SetProgress=function(percent){this.$line.style.width=percent+"%",this.$digit.innerHTML=percent+"%"},CBreadCrumb.prototype=Object.create(CBase.prototype),CBreadCrumb.prototype.constructor=CBreadCrumb,CBreadCrumb.prototype.Init=function(path,handle,leftItems,rightItems){this.path=path,CBase.prototype.Init.call(this,handle),this.dom={},elchild(this.handleInner,[this.dom.list=element("div",{className:"cbcrumb-list"}),this.dom.name=element("div",{className:"cbcrumb-name"})]),this.leftItems=leftItems||this.leftItems,this.rightItems=rightItems||this.rightItems},CBreadCrumb.prototype.SetName=function(text){elclear(this.dom.name),elchild(this.dom.name,element("div",{innerHTML:text,className:"cbcrumb-name-text"})),this.DrawName()},CBreadCrumb.prototype.DrawName=function(){this.dom.name.style.display=1===this.dom.list.children.length?"table-cell":"none"
},CBreadCrumb.prototype.Push=function(path,icon,text,iid){var last=this.dom.list.lastChild;last&&(last.className="cbcrumb-item");var item=element("div",{className:"cbcrumb-item active",onclick:null,path:path},[icon?element("img",{className:"cbcrumb-icon",onclick:null,src:this.path+icon}):null,text?element("div",{className:"cbcrumb-text",onclick:null},text):null]);return iid&&(item.iid=iid),this.dom.list.children.length===this.leftItems&&elchild(this.dom.list,element("div",{className:"cbcrumb-item divider"},". . .")),elchild(this.dom.list,item),this.dom.list.children.length>this.leftItems+this.rightItems+1&&(this.dom.list.children[this.leftItems].style.display="table-cell",this.dom.list.children[this.dom.list.children.length-this.rightItems-1].style.display="none"),this.DrawName(),item},CBreadCrumb.prototype.Pop=function(){var item=this.dom.list.lastChild;return item&&(this.dom.list.removeChild(item),this.dom.list.children.length===this.leftItems+1?this.dom.list.removeChild(this.dom.list.lastChild):this.dom.list.children.length>this.leftItems+this.rightItems&&(this.dom.list.children[this.dom.list.children.length-this.rightItems].style.display="table-cell"),this.dom.list.children.length===this.leftItems+this.rightItems+1&&(this.dom.list.children[this.leftItems].style.display="none"),this.dom.list.lastChild&&(this.dom.list.lastChild.className="cbcrumb-item active"),this.DrawName()),item},CBreadCrumb.prototype.Tip=function(){return this.dom.list.lastChild},CBreadCrumb.prototype.Reset=function(){elclear(this.dom.list),this.DrawName()},CBreadCrumb.prototype.onClick=function(){return!1},CPage.prototype=Object.create(CBase.prototype),CPage.prototype.constructor=CPage,CPage.prototype.Show=function(visible,previous){visible===!1?(this.activeChild&&this.activeChild.Activate(!1),CBase.prototype.Show.call(this,!1,!0,!0),window.currCPage=this.previous||window.baseCPage,this.previous=null,window.currCPage&&window.currCPage!==this&&CBase.prototype.Show.call(window.currCPage,!0,!0,!0)):(window.currCPage&&window.currCPage!==this&&(window.currCPage.activeChild&&window.currCPage.activeChild.Activate(!1),CBase.prototype.Show.call(window.currCPage,!1,!0,!0)),CBase.prototype.Show.call(this,!0,!0,!0),this.previous=previous||null,window.currCPage=this)},CPage.prototype.onClick=function(){return!1},CPage.prototype.EventHandler=function(){},CButtonPanel.prototype=Object.create(CBase.prototype),CButtonPanel.prototype.constructor=CButtonPanel,CButtonPanel.prototype.Init=function(path,handle){this.path=path,handle&&handle.nodeName?CBase.prototype.Init.call(this,handle):CBase.prototype.Init.call(this,element("div",{className:"cbpanel-main"}))},CButtonPanel.prototype.Add=function(code,icon,text,callback,hidden){var html=null,self=this,func=function(){self.isActive&&"function"==typeof callback&&(gSTB.HideVirtualKeyboard(),callback(code))};text&&(html=element("div",{className:"cbpanel-text",onclick:func}),html.innerHTML=text);var item=element("div",{className:"cbpanel-item",data:{code:code,onclick:func}},[element("img",{className:"cbpanel-icon",onclick:func,src:this.path+"/"+icon}),html]);return item.$name=html,this.Hidden(item,hidden||!1),elchild(this.handleInner,item),item},CButtonPanel.prototype.Hidden=function(item,state){item&&item.nodeName&&item.data.hidden!==state&&(item.data.hidden=state,item.style.display=state?"none":"table-cell")},CButtonPanel.prototype.Rename=function(item,name){item&&item.nodeName&&(item.$name.innerHTML=name)},CButtonPanel.prototype.Activate=function(active){this.isActive=active!==!1},CButtonPanel.prototype.EventHandler=function(event){if(event.stopped!==!0&&this.isActive)for(var data,i=0,items=this.handleInner.children,length=items.length;length>i;i++)if(data=items[i].data,!data.hidden&&data.code===event.code&&"function"==typeof data.onclick)return void(data.onclick()&&event.preventDefault())},CButtonPanel.prototype.onClick=function(){return!1};var CMODAL_IMG_PATH=PATH_IMG_SYSTEM+"buttons/";CModal.prototype=Object.create(CPage.prototype),CModal.prototype.constructor=CModal,CModal.prototype.Init=function(body){CPage.prototype.Init.call(this,element("div",{className:this.baseClass},element("div",{className:"cmodal-cell"},body)));var owner=this.parent&&this.parent.handle&&this.parent.handle.nodeName?this.parent.handle:document.body;this.parent instanceof CModal&&this.parent.parent&&(owner=this.parent.parent.handle),owner.appendChild(this.handle)},CModal.prototype.Free=function(){this.handle&&this.handle.parentNode&&this.handle.parentNode.removeChild(this.handle),elclear(this.handle)},CModal.prototype.Show=function(visible,manageFocus){CBase.prototype.Show.call(this,visible,manageFocus!==!1),currCPage=visible===!1?this.parent:this},CModal.prototype.FocusPrev=function(event,manageVK){if(this.focusList.length>0){--this.focusPos<0&&(this.focusPos=this.focusList.length-1);var el=this.focusList[this.focusPos];manageVK!==!1&&gSTB.HideVirtualKeyboard(),el.focus(),event&&"INPUT"===el.tagName&&"text"===el.type&&(event.preventDefault(),manageVK!==!1&&gSTB.ShowVirtualKeyboard())}},CModal.prototype.FocusNext=function(event,manageVK){if(this.focusList.length>0){++this.focusPos>=this.focusList.length&&(this.focusPos=0);var el=this.focusList[this.focusPos];manageVK!==!1&&gSTB.HideVirtualKeyboard(),el.focus(),event&&"INPUT"===el.tagName&&"text"===el.type&&(event.preventDefault(),manageVK!==!1&&gSTB.ShowVirtualKeyboard())}},CModalBox.prototype=Object.create(CModal.prototype),CModalBox.prototype.constructor=CModalBox,CModalBox.prototype.SetData=function(place,data){return elclear(place),data instanceof Node||Array.isArray(data)?elchild(place,data):place.innerHTML=data,data&&data.nodeName&&(data.style.display="block"),place.style.display=data?"block":"none",place},CModalBox.prototype.SetHeader=function(data){return this.SetData(this.header,data||"")},CModalBox.prototype.SetContent=function(data){return this.SetData(this.content,data||"")},CModalBox.prototype.SetFooter=function(data){return this.SetData(this.footer,data||"")},CModalBox.prototype.Init=function(){CModal.prototype.Init.call(this,element("div",{className:"cmodal-body"},[this.header,this.content,this.footer]))},CModalHint.prototype=Object.create(CModalBox.prototype),CModalHint.prototype.constructor=CModalHint,CModalAlert.prototype=Object.create(CModalBox.prototype),CModalAlert.prototype.constructor=CModalAlert,CModalConfirm.prototype=Object.create(CModalAlert.prototype),CModalConfirm.prototype.constructor=CModalConfirm,CCheckBox.prototype=Object.create(CBase.prototype),CCheckBox.prototype.constructor=CCheckBox,CCheckBox.DefaultAttributes={checkbox:{type:"checkbox",className:"ccheck-box-input"},label:{className:"ccheck-box-label"},wrapper:{className:"ccheck-box-wrapper",tabIndex:"1"}},CCheckBox.prototype.onInit=function(){void 0!==this.parameters.element&&"INPUT"===this.parameters.element.nodeName&&"checkbox"===this.parameters.element.type&&(this.parameters.element.parentNode.removeChild(this.parameters.element),this.checkbox=this.parameters.element,elattr(this.checkbox,extend(CCheckBox.DefaultAttributes.checkbox,this.parameters.attributes.checkbox,!0))),void 0===this.checkbox&&(this.checkbox=this.generateCheckbox()),this.wrapper=this.generateWrapper(this.checkbox),this.wrapper.className+=" "+this.style,this.parameters.checked===!0&&this.Check(!0,!0),elchild(this.handleInner,this.wrapper)},CCheckBox.prototype.generateCheckbox=function(){var self=this,attrs=extend(CCheckBox.DefaultAttributes.checkbox,this.parameters.attributes.checkbox,!0);return void 0===attrs.id&&(attrs.id=CCheckBox.GenerateId()),attrs.onchange=function(){self.checked=this.checked,self.trigger("onChange",arguments)},attrs.onclick=function(){self.Check(!self.IsChecked())},element("input",attrs)},CCheckBox.prototype.generateWrapper=function(checkbox,label){var self=this;if(void 0===this.checkbox)throw"Checkbox must be created before label";return this.label=element("label",extend({htmlFor:this.checkbox.id},CCheckBox.DefaultAttributes.label)),this.label.onclick=function(){self.Check(!self.IsChecked())},element("div",CCheckBox.DefaultAttributes.wrapper,[checkbox,label||this.label])},CCheckBox.GenerateId=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},CCheckBox.prototype.Check=function(checked,block_event){this.checked=this.checkbox.checked=checked===!0,block_event!==!0&&this.trigger("onChange")},CCheckBox.prototype.IsChecked=function(){return this.checkbox.checked===!0},CCheckBox.prototype.EventHandler=function(event){switch(event.code){case KEYS.LEFT:case KEYS.RIGHT:this.Check(event.code===KEYS.LEFT),event.stopped=!0}},CCheckBox.prototype.focus=function(){this.wrapper.focus()},Events.inject(CCheckBox);var CINPUT_IMG_PATH=PATH_IMG_PUBLIC;CInput.prototype=Object.create(CBase.prototype),CInput.prototype.constructor=CInput,CInput.prototype.GenerateHandle=function(){var i,icon,attrs,changed,self=this;if(this.row=element("tr"),void 0!==this.parameters.hint&&(this.DefaultHint=this.attributes.hint.value=this.parameters.hint,this.hint=element("input",extend(this.attributes.input,this.attributes.hint,!1))),void 0===this.parameters.input?(void 0!==this.parameters.value&&(this.attributes.input.value=this.parameters.value,this.SetDefault(this.parameters.value)),elchild(this.row,element("td",this.attributes["text-wrapper"],[this.input=element("input",this.attributes.input),this.hint||""]))):(this.input=this.parameters.input,this.input.parentNode.removeChild(this.input),this.input.className+=this.attributes.input.className,elchild(this.row,element("td",{},element("div",this.attributes["text-wrapper"],[this.input,this.hint||""]))),""!==this.input.value&&(this.ShowHint(!1),this.SetDefault(this.input.value))),this.input.oninput=function(e){changed=!1,self.trigger("onChange",e),""!==self.GetValue()?self.ShowHint(!1):(self.SetHint(self.DefaultHint),self.ShowHint(!0))},this.input.onblur=function(){""!==self.GetValue()?self.ShowHint(changed):(self.SetHint(self.DefaultHint),self.ShowHint(!0))},void 0!==this.parameters.icons)for(i=0;i<this.parameters.icons.length;i++)icon=this.parameters.icons[i],attrs=extend({},this.attributes.icon),attrs.className+=" "+(icon.style||""),this.AddIcon(icon,attrs);return element("table",this.attributes.wrapper,this.row)},CInput.prototype.SetAutocomplete=function(autocomplete){this.autocomplete=autocomplete},CInput.prototype.onInit=function(){},CInput.prototype.ShowIcon=function(name,show){void 0!==this.icons[name]&&(this.icons[name].parentNode.style.display=show===!0?"table-cell":"none")},CInput.prototype.ApplyHint=function(){this.SetValue(this.GetHint())},CInput.prototype.AddIcon=function(icon,attrs){var self=this,iconFile=null,attributes=extend(icon.attributes,{});iconFile=void 0!==icon.src?icon.src:icon.name?icon.name+".png":null,"f4.png"===iconFile?iconFile&&(attributes.src=(this.parameters.icons_path||PATH_IMG_SYSTEM+"buttons/")+iconFile):iconFile&&(attributes.src=(this.parameters.icons_path||CINPUT_IMG_PATH)+iconFile),element("td",attrs||this.attributes.icon,this.icons[icon.name]=element("img",attributes)),"left"===icon.type?this.row.insertBefore(this.icons[icon.name].parentNode,this.row.firstChild):this.row.appendChild(this.icons[icon.name].parentNode),"function"==typeof icon.click&&(this.icons[icon.name].onclick=function(event){icon.click.call(self,event)})},CInput.prototype.RemoveIcon=function(icon_name){void 0!==this.icons[icon_name]&&this.row.removeChild(this.icons[icon_name].parentNode)},CInput.prototype.SetValue=function(value,siltent){this.input.value=value,this.ShowHint(""===value),siltent!==!0&&(this.trigger("onChange"),this.input.oninput())},CInput.prototype.GetValue=function(){return this.input.value},CInput.prototype.SetHint=function(hint){return void 0!==this.hint?this.hint.value=hint:void 0},CInput.prototype.GetHint=function(){return void 0!==this.hint?this.hint.value:void 0},CInput.prototype.ShowHint=function(show){void 0!==this.hint&&(this.hint.style.display=show===!0?"block":"none")},CInput.prototype.Fold=function(fold,manage_focus,stop_event){fold===!0?(-1===this.handle.className.indexOf("folded")&&(this.handle.className+=" "+this.FoldedClass,stop_event!==!0&&this.trigger("onFold"),manage_focus===!0&&this.blur()),gSTB.HideVirtualKeyboard()):(this.handle.className=this.handle.className.replace(this.FoldedClass,""),stop_event!==!0&&this.trigger("onUnfold"),manage_focus===!0&&(this.focus(),gSTB.ShowVirtualKeyboard()))},CInput.prototype.Reset=function(){this.Fold(this.parameters.folded===!0,!0),this.SetValue(this.GetDefault(),!0)},CInput.prototype.focus=function(){this.input.focus()},CInput.prototype.blur=function(){this.input.blur()},CInput.prototype.select=function(){this.input.select()},CInput.prototype.IsFolded=function(){return-1!==this.handle.className.indexOf(this.FoldedClass)},CInput.prototype.IsFocused=function(){return this.input===document.activeElement},CInput.prototype.EventHandler=function(){},Events.inject(CInput),CFilterInput.prototype=Object.create(CInput.prototype),CFilterInput.prototype.constructor=CFilterInput,CFilterInput.prototype.EventHandler=function(event){eventPrepare(event,!0,"CFilterInput");var event_res=!1;if(this.trigger("onEvent",event)[0]===!0)return!0;switch(event.code){case KEYS.F4:this.Fold(!this.IsFolded(),!0),event_res=this.trigger("onKey")[0];break;case KEYS.EXIT:if(!this.IsFolded())return this.Fold(!0,!0),this.trigger("onExit"),!0;break;case KEYS.OK:this.IsFolded()||(event_res=this.trigger("onEnter")[0],event.preventDefault());break;case KEYS.CHANNEL_NEXT:case KEYS.CHANNEL_PREV:event.preventDefault()}return this.IsFolded()!==!0||event_res===!0?!0:void 0},CScrollList.prototype=Object.create(CBase.prototype),CScrollList.prototype.constructor=CScrollList,CScrollList.prototype.Init=function(handle){CBase.prototype.Init.call(this,handle);var self=this;this.handleInner.onmousewheel=function(event){var direction=event.wheelDeltaY>0,found=self.Next(null,direction);return found&&(self.MoveNext(direction?-1:1),self.Focused(found,!0)),event.stopPropagation(),!1}},CScrollList.prototype.Add=function(body,attrs){attrs=attrs||{};var item=element("a",this.defaultParams,body);this.renderMode===this.RENDER_MODE_BULK?this.fragment.appendChild(item):this.handleInner.appendChild(item),attrs.hidden&&this.Hidden(item,!0),attrs.marked&&this.Marked(item,!0),attrs.disabled&&this.Disabled(item,!0),attrs.focused&&this.Focused(item,!0,attrs.manageFocus);for(var name in attrs)attrs.hasOwnProperty(name)&&(item[name]=attrs[name]);return item},CScrollList.prototype.Render=function(){this.fragment.childNodes.length>0&&this.handleInner.appendChild(this.fragment)},CScrollList.prototype.Clear=function(){this.handleInner.innerHTML=null,this.activeItem=null,this.states={}},CScrollList.prototype.Reset=function(item){item&&item.nodeName&&(this.Hidden(item,this.defaultParams.hidden),this.Marked(item,this.defaultParams.marked),this.Disabled(item,this.defaultParams.disabled),this.Focused(item,this.defaultParams.focused),item!==this.activeItem||item.focused||(this.activeItem=null))},CScrollList.prototype.DeleteAll=function(items){var self=this,curPos=null;Array.isArray(items)&&items.length>0&&(null!==document.activeElement&&document.activeElement.parentNode===this.handleInner&&document.activeElement.blur(),-1===items.indexOf(this.Current())?curPos=this.Current():(curPos=this.Next({marked:!1,hidden:!1,disabled:!1}),(null===curPos||curPos===this.Current())&&(curPos=this.Next({marked:!1,hidden:!1,disabled:!1},!0))),items.forEach(function(item){self.Delete(item)}),null!==curPos&&(this.Focused(curPos,!0),this.SetPosition(curPos,!0)))},CScrollList.prototype.Delete=function(item){if(item&&item.nodeName&&item.parentNode===this.handleInner){for(var name in this.states)if(this.states.hasOwnProperty(name)){var index=this.states[name].indexOf(item);-1!==index&&this.states[name].splice(index,1)}item===this.activeItem&&(this.activeItem=null),this.handleInner.removeChild(item)}},CScrollList.prototype.Current=function(){return this.activeItem},CScrollList.prototype.Length=function(){return this.handleInner.children.length+this.fragment.childNodes.length},CScrollList.prototype.SetState=function(item,option,state){if(state=Boolean(state),item[option]!==state){this.states[option]||(this.states[option]=[]);var index=this.states[option].indexOf(item);state?-1===index&&this.states[option].push(item):-1!==index&&this.states[option].splice(index,1);var oldVal=item[option];return item[option]=state,state?item.classList.add(option):item.classList.remove(option),"function"==typeof this.onStateChange&&this.onStateChange(item,option,oldVal,state),!0}return!1},CScrollList.prototype.Hidden=function(item,state){if(state=Boolean(state),item&&item.nodeName){var changed=this.SetState(item,"hidden",state);return changed&&state&&(item.focused&&(this.activeItem=null),this.SetState(item,"marked",!1),this.SetState(item,"focused",!1)),changed}return!1},CScrollList.prototype.Marked=function(item,state){var self=this;return state=Boolean(state),item&&item.nodeName&&!item.disabled&&!item.hidden?(this.multipleSelection===!1&&(this.states.marked||[]).forEach(function(marked){self.SetState(marked,"marked",!1)}),this.SetState(item,"marked",state)):!1},CScrollList.prototype.Disabled=function(item,state){if(state=Boolean(state),item&&item.nodeName){var changed=this.SetState(item,"disabled",state);return changed&&state&&(item.focused&&(this.activeItem=null),this.SetState(item,"marked",!1),this.SetState(item,"focused",!1)),changed}return!1},CScrollList.prototype.Focused=function(item,state,manageFocus){var changed=!1,prevent=!1;return state=state!==!1,void 0===manageFocus&&(manageFocus=this.manageFocus),item&&item.nodeName&&!item.disabled&&!item.hidden&&state!==item.focused&&(state?item!==this.activeItem&&("function"==typeof this.onFocus&&(prevent=this.onFocus(item,this.activeItem)),prevent||(changed=this.SetState(item,"focused",state),this.Focused(this.activeItem,!1,manageFocus),this.activeItem=item,manageFocus!==!1&&this.activeItem.focus())):(changed=this.SetState(item,"focused",state),manageFocus!==!1&&this.activeItem.blur(),this.activeItem=null)),changed},CScrollList.prototype.Activate=function(state,manageFocus){if(void 0===manageFocus&&(manageFocus=this.manageFocus),CBase.prototype.Activate.call(this,state),this.isActive){if(this.activeItem=this.activeItem||this.FindOne(),null===this.activeItem)return!1;this.SetState(this.activeItem,"focused",!0),this.SetPosition(this.activeItem),manageFocus!==!1&&this.activeItem.focus()}else this.activeItem&&this.activeItem.blur();return!0},CScrollList.prototype.Each=function(callback){Array.prototype.forEach.call(this.handleInner.children,callback)},CScrollList.prototype.Find=function(filter,limit,reverse){var match,found=[],items=this.handleInner.children,itlen=items.length,citem=null;filter=filter||this.defaultFilter;for(var i=0;itlen>i;i++){citem=items[reverse?itlen-i-1:i],match=!0;for(var attr in filter)filter.hasOwnProperty(attr)&&(match=match&&citem[attr]===filter[attr]);if(match&&(found.push(citem),limit&&found.length>=limit))break}return found},CScrollList.prototype.FindOne=function(filter,reverse){return this.Find(filter,1,reverse).pop()||null},CScrollList.prototype.Next=function(filter,reverse,nskip,toend){var match,suitable=this.activeItem,pointer=this.activeItem,skipcount=0;if(nskip=nskip||0,pointer)for(filter=filter||this.defaultFilter;pointer=reverse?pointer.previousSibling:pointer.nextSibling;){match=!0;for(var attr in filter)filter.hasOwnProperty(attr)&&(match=match&&pointer[attr]===filter[attr]);if(pointer.hidden||skipcount++,match&&(toend!==!1&&(suitable=pointer),0===nskip||nskip>0&&skipcount>=nskip))return pointer}return suitable},CScrollList.prototype.SetPosition=function(item,makeFocused,manageFocus){var index,page;makeFocused&&(void 0===manageFocus&&(manageFocus=this.manageFocus),this.Focused(item||this.FindOne(),!0,manageFocus)),null!==this.activeItem&&(index=this.activeItem.offsetTop/this.itemHeight,page=Math.floor(index/this.itemsPerPage),1===this.scrollMode?this.handleInner.scrollTop=(index-Math.floor((this.itemsPerPage-1)/2))*this.itemHeight:2===this.scrollMode&&(this.handleInner.scrollTop=this.itemsPerPage*this.itemHeight*page))},CScrollList.prototype.EventHandler=function(event,filter,manageFocus){var found=null;if(void 0===manageFocus&&(manageFocus=this.manageFocus),event.stopped!==!0){switch(event.code){case KEYS.PAGE_UP:case KEYS.PAGE_DOWN:found=this.Next(filter,event.code!==KEYS.PAGE_DOWN,this.itemsPerPage),this.handleInner.scrollTop=this.handleInner.scrollTop+(event.code===KEYS.PAGE_UP?-1:1)*this.itemsPerPage*this.itemHeight;break;case KEYS.LEFT:case KEYS.RIGHT:case KEYS.HOME:case KEYS.END:found=this.FindOne(filter,event.code===KEYS.RIGHT||event.code===KEYS.END);break;case KEYS.UP:case KEYS.DOWN:found=this.Next(filter,event.code===KEYS.UP),this.MoveNext(event.code===KEYS.UP?-1:1);break;case KEYS.OK:return this.activeItem&&this.activeItem.onclick(),void event.preventDefault();default:return}event.preventDefault(),this.Focused(found||this.FindOne(filter),!0,manageFocus)}},CScrollList.prototype.MoveNext=function(direction){null!==this.activeItem&&(1===this.scrollMode?this.handleInner.scrollTop=this.activeItem.offsetTop-Math.floor((this.itemsPerPage-1)/2)*this.itemHeight+direction*this.itemHeight:2===this.scrollMode&&(-1===direction?this.activeItem.offsetTop===this.handleInner.scrollTop&&(this.handleInner.scrollTop=this.handleInner.scrollTop-this.itemsPerPage*this.itemHeight):this.activeItem.offsetTop-this.handleInner.scrollTop===(this.itemsPerPage-1)*this.itemHeight&&(this.handleInner.scrollTop=this.handleInner.scrollTop+this.itemsPerPage*this.itemHeight)))},CScrollList.prototype.onFocus=null,CScrollList.prototype.onStateChange=null,Object.defineProperty(CScrollList.prototype,"itemsPerPage",{get:function(){return this._itemsPerPage?this._itemsPerPage:this._itemsPerPage=Math.round(this.handleInner.offsetHeight/this.handleInner.firstChild.offsetHeight)}}),Object.defineProperty(CScrollList.prototype,"itemHeight",{get:function(){return this.handleInner.firstChild?this.handleInner.firstChild.offsetHeight:0}}),CSimpleSelect.prototype=Object.create(CBase.prototype),CSimpleSelect.prototype.constructor=CSimpleSelect,CSimpleSelect.prototype.GenerateHandle=function(){var wrapper,content_wrapper,self=this;return void 0!==this.parameters.content&&"div"===this.parameters.content.tagName.toLowerCase()?(this.content=this.parameters.content,this.content.parentNode.removeChild(this.content),void 0!==this.content.className&&(this.attributes.content.className+=" "+this.content.className),this.content=element("div",this.attributes.content,this.content||"")):(void 0!==this.parameters.content&&"div"!==this.parameters.content.tagName.toLowerCase()&&(this.content=this.parameters.content),this.content=element("div",this.attributes.content,this.content||"")),content_wrapper=element("div",this.attributes.content_wrapper,[this.content,this.hint=element("div",this.attributes.hint)]),this.parameters.leftArrow?(this.leftArrow=this.parameters.leftArrow,this.leftArrow.parentNode.removeChild(this.leftArrow),this.leftArrow=element("div",this.attributes.left_arrow,this.leftArrow)):this.leftArrow=element("div",this.attributes.left_arrow,this.leftArrow||element("p")),this.parameters.rightArrow?(this.rightArrow=this.parameters.rightArrow,this.rightArrow.parentNode.removeChild(this.rightArrow),this.rightArrow=element("div",this.attributes.right_arrow,this.rightArrow)):this.rightArrow=element("div",this.attributes.right_arrow,this.rightArrow||element("p")),wrapper=element("div",this.attributes.wrapper,element("div",{className:"content-wrapper",onfocus:function(){}},[this.leftArrow,content_wrapper,this.rightArrow])),wrapper.className+=" "+this.style,void 0!==this.parameters.width&&(wrapper.style.width=this.parameters.width),this.leftArrow.onclick=function(event){self.disabled||(self.Previous(),event.stopPropagation(),event.preventDefault())},this.rightArrow.onclick=function(event){self.disabled||(self.Next(),event.stopPropagation(),event.preventDefault())},wrapper},CSimpleSelect.prototype.onInit=function(){var self=this;elchild(this.parentNode,this.handle),this.handle.component=this,this.handle.onblur=function(){self.trigger("onBlur")},this.handle.onfocus=function(){self.trigger("onFocus")}},CSimpleSelect.prototype.EventHandler=function(event){if(eventPrepare(event,!0,"CSimpleSelect"),this.disabled!==!0)switch(event.stopped=!0,event.code){case KEYS.LEFT:this.Previous();break;case KEYS.RIGHT:this.Next();break;default:event.stopped=!1}},CSimpleSelect.prototype.SetContent=function(content){this.content.innerHTML="",this.content.innerHTML=content},CSimpleSelect.prototype.DisableElement=function(element,disable){disable===!0?-1===element.className.indexOf("disabled")&&(element.className+=" disabled"):element.className=element.className.replace(" disabled","")},CSimpleSelect.prototype.SetHint=function(hint){this.hint.innerHTML=hint},CSimpleSelect.prototype.Next=function(){},CSimpleSelect.prototype.Previous=function(){this.autocomplete=""},CSimpleSelect.prototype.focus=function(){this.handle.focus()},CSimpleSelect.prototype.blur=function(){this.handle.blur()},CSimpleSelect.prototype.IsFocused=function(){return document.activeElement===this.handle},CSimpleSelect.prototype.Disable=function(disable){this.DisableElement(this.handle,this.disabled=disable===!0)},Events.inject(CSimpleSelect),CSelectBox.prototype=Object.create(CSimpleSelect.prototype),CSelectBox.prototype.constructor=CSelectBox,CSelectDropdown.prototype=Object.create(CScrollList.prototype),CSelectDropdown.prototype.constructor=CSelectDropdown,CSelectDropdown.parameters=["scrollMode","select","container"],CSelectDropdown.prototype.Refresh=function(){var el,i,self=this,data=this.select.GetData();for(this.Clear(),i=0;i<data.length,el=data[i];i++)"object"==typeof el&&(el=el[this.select.GetNameField()]),this.Add(element("div",extend(this.attributes.element,{innerHTML:el})),{onclick:function(){self.select.SetIndex(self.activeItem.index),self.Marked(self.activeItem,!0),self.Show(!1,self.manageFocus)},index:i})},CSelectDropdown.prototype.onShow=function(){this.UpdateGeometry();var item=this.handleInner.children[this.select.GetIndex()];this.SetPosition(item,!0,!1),this.Focused(item,!0),this.Marked(item,!0)},CSelectDropdown.prototype.UpdateGeometry=function(){var containerRect,inputRect=this.base.getBoundingClientRect(),top=this.base.offsetTop+inputRect.height,height=WINDOW_HEIGHT;void 0!==this.container&&(containerRect=this.container.getBoundingClientRect(),height=containerRect.top+containerRect.height),inputRect.top+this.itemHeight*this.itemsPerPage>height&&(top=this.base.offsetTop-this.itemHeight*this.itemsPerPage),1===this.scrollMode&&(top-=this.itemHeight*Math.abs(Math.floor(this.itemsPerPage/2*-1))),this.handle.style.top=top+"px",this.handle.style.left=this.base.offsetLeft+"px",this.handle.style.width=inputRect.width-2*parseInt(document.defaultView.getComputedStyle(this.handle,"")["border-left-width"])+"px"},Events.inject(CSelectDropdown),CIntervalBox.prototype=Object.create(CSimpleSelect.prototype),CIntervalBox.prototype.constructor=CIntervalBox,CLog=function(parent,options){var self=this;CBase.call(this,parent||null),this.newest=!1,CLog.parameters.forEach(function(option){void 0!==options[option]&&(self[option]=options[option])}),this.bind(options.events||{}),this.Init(element("div",{className:"clog"},this.$log=element("ul",{})))},CLog.parameters=["time","autofocus","parentNode","events","defaultType","newest","isVisible"],CLog.prototype=Object.create(CBase.prototype),CLog.prototype.constructor=CLog,CLog.prototype.onInit=function(){elchild(this.parentNode,this.handle)},CLog.prototype.onShow=function(){this.autofocus===!0&&0!==this.$log.childElementCount&&this.$log.lastElementChild.focus(),this.trigger("onShow")},CLog.prototype.onHide=function(){this.trigger("onHide")},CLog.prototype.Add=function(message,type){if(this.newest===!1||this.newest===!0&&this._lastMessage!==message){this._lastMessage=message;var currTime=new Date,$data=[element("span",{className:"message"},message)];this.time===!0&&$data.push(element("span",{className:"time"},("0"+currTime.getHours()).slice(-2)+":"+("0"+currTime.getMinutes()).slice(-2)+":"+("0"+currTime.getSeconds()).slice(-2))),elchild(this.$log,element("li",{className:type||this.defaultType,tabIndex:"1"},$data)),this.autofocus===!0&&this.$log.lastElementChild.focus(),this.trigger("onAdd")}},Events.inject(CLog);var MODAL_IMG_PATH=PATH_IMG_SYSTEM+"buttons/",CUpdateModal=function(parent,options){var self=this;CModalBox.call(this,parent||null),this.isVisible=!1,this.name="CUpdateModal",this.baseClass="cmodal-main cupdate-modal",this.$status=element("td",{className:"right"}),this.OK_func=null,this.Info_func=null,this.image_info={},CUpdateModal.parameters.forEach(function(option){void 0!==options[option]&&(self[option]=options[option])}),this.bind(this.events),this.bpanel=new CButtonPanel,this.bpanel.Init(MODAL_IMG_PATH),this.Exit_btn=this.bpanel.Add(KEYS.EXIT,"exit.png",_("Cancel"),function(){self.Update.Clear(),self.Show(!1)},this.auto===!0),this.Info_btn=this.bpanel.Add(KEYS.INFO,"info.png",_("Show log"),function(){self.Info_func()},this.log!==!0),this.OK_btn=this.bpanel.Add(KEYS.OK,"ok.png",_("Update"),function(){self.OK_func()},!0),this.ProgressBar=new CProgressBar(this,element("div")),this.SetHeader(this.header_text),this.SetFooter(this.bpanel.handle),this.EventHandler=function(event){eventPrepare(event),void 0!==self.select&&"function"==typeof self.select.EventHandler&&self.select.EventHandler(event),self.bpanel.EventHandler(event)},this.Init()};CUpdateModal.parameters=["update_url","check","auto","images","log","select","header_text","info","events","warning"],CUpdateModal.prototype=Object.create(CModalBox.prototype),CUpdateModal.prototype.constructor=CUpdateModal,CUpdateModal.prototype.onHide=function(){this.trigger("onHide")},CUpdateModal.prototype.onShow=function(){this.trigger("onShow")},CUpdateModal.prototype.onInit=function(){var self=this;this.Update=new Update({onReady:function(){self.image_info=self.Update.GetImageInfo(),self.image_description=self.image_info.description,self.auto===!0?self.UpdateStart():self.ImageSelect(),self.trigger("onReady")},onCheck:function(data){self._addLogMessage(data.logMessage),self.$status.innerHTML=data.statusMessage,self.$status.className="right",self.trigger("onCheck",data)},onError:function(data){self._addLogMessage(data.logMessage,"error"),self.bpanel.Hidden(self.OK_btn,!1),self.bpanel.Hidden(self.Exit_btn,!1),self.bpanel.Rename(self.OK_btn,_("Retry")),self.bpanel.Rename(self.Exit_btn,_("Exit")),self.$status.innerHTML=data.errorMessage,self.$status.classList.add("error"),self.trigger("onError",data)},onProgress:function(data){self._addLogMessage(data.logMessage),self.$status.innerHTML=data.statusMessage,self.ProgressBar.SetProgress(data.percent),self.trigger("onProgress",data)},onStart:function(){self.trigger("onStart"),self.UpdateStart(),CModalBox.prototype.Show.call(self,!0)}}),this.log===!0&&(this.log=new CLog(document.body,{autofocus:!0,time:!0,newest:!0,defaultType:"success",isVisible:!1,events:{onShow:function(){self.$status.parentNode.style.display="none"},onHide:function(){self.$status.parentNode.style.display=""}}})),this.curr_info=this.Update.GetCurrentImageInfo(),"string"==typeof this.update_url?this.check=!0:Array.isArray(this.images)&&(this.check=!1,this.image_description=cutTextWithEllipsis(this.images[0].descr.split("").join("​"),200),this.select===!0&&this.images.length>1?(this.select=new CSelectBox(this,{parent:this.new_version=element("div"),data:this.images,nameField:"title",idField:"url",events:{onChange:function(){self.$curr_update_descr.innerHTML=cutTextWithEllipsis(this.GetSelected().descr.split("").join("​"),200),self.update_url=this.GetValue()}}}),this.update_url=this.select.GetValue()):(this.new_version=this.images[0].title,this.update_url=this.images[0].url))},CUpdateModal.prototype._addLogMessage=function(message,type){void 0!==this.log&&this.log.Add(message,type)
},CUpdateModal.prototype._addLog=function(elements){var self=this;"undefined"!=typeof this.log&&(elements.push(element("tr",{className:"row"},[element("td",{className:"log",colSpan:2},this.log.handle)])),this.Info_func=function(){self.log.Show(!self.log.isVisible),this.bpanel.Rename(this.Info_btn,_(self.log.isVisible?"Hide log":"Show log"))},this.bpanel.Rename(this.Info_btn,_(self.log.isVisible?"Hide log":"Show log")),this.bpanel.Hidden(this.Info_btn,!1))},CUpdateModal.prototype.Show=function(show){return this.auto===!0?void this.Update.Start(this.update_url):(this.check===!0?this.CheckStatus():this.ImageSelect(),this.log&&this.log.isVisible&&this.log.Show(!1),void CModalBox.prototype.Show.call(this,show))},CUpdateModal.prototype.CheckStatus=function(){this.layer=this.CheckStatus;var self=this,elements=[element("tr",{className:"row"},[element("td",{className:"left"},_("Status")+":"),this.$status=element("td",{className:"right"})])];this._addLog(elements),this.SetHeader(_("Check image")),this.SetContent(element("table",{className:"cmodal-update status"},elements)),self.Update.CheckUpdate(self.update_url),this.OK_func=function(){self.$status.innerHtml=status,self.$status.className="right",self.bpanel.Hidden(this.OK_btn,!0),self.bpanel.Rename(this.Exit_btn,_("Cancel")),self.Update.CheckUpdate(self.update_url),self.trigger("onCheckStatus")}},CUpdateModal.prototype.ImageSelect=function(){this.layer=this.ImageSelect;var $new_version,self=this,elements=[element("tr",{className:"row"},[element("td",{className:"left"},_("Current version")+":"),element("td",{className:"right",innerHTML:this.curr_info.version+" <span class='grey'>("+this.curr_info.date.toDateString()+")</span>"})]),element("tr",{className:"row"},[element("td",{className:"left"},_("Description")+":"),element("td",{className:"right"},element("div",{className:"ellipsis",innerHTML:this.curr_info.description||""}))]),element("tr",{className:"row padding"},[element("td",{className:"left"},_("New version")+":"),element("td",{className:"right"},$new_version=element("div"))]),element("tr",{className:"row"},[element("td",{className:"left"},_("Description")+":"),element("td",{className:"right"},self.$curr_update_descr=element("div",{className:"ellipsis",innerHTML:this.image_description||""}))])];this.warning!==!1&&elements.unshift(element("tr",{className:"row"},[element("td",{className:"center",colSpan:2,innerHTML:_("<span class='alert'>Warning!</span> Automatic device reboot after updating")})])),this.bpanel.Hidden(this.Info_btn,this.info!==!0),this._addLog(elements),this.SetContent(element("table",{className:"cmodal-update"},elements)),void 0!==this.new_version?"string"==typeof this.new_version?$new_version.innerHTML=this.new_version:elchild($new_version,this.new_version):$new_version.innerHTML=this.image_info.version+" <span class='grey'>("+this.image_info.date.toDateString()+")</span>",this.SetHeader(this.header_text||""),this.info===!0&&(this.Info_func=function(){self.ShowInfoWindow()},this.bpanel.Rename(this.Info_btn,_("Change log"))),this.OK_func=function(){self.Update.Start(this.update_url)},this.bpanel.Hidden(this.OK_btn,!1),this.bpanel.Hidden(this.Exit_btn,!1),this._binded!==!0&&(this.bind("onShow",function(){this.layer===this.ImageSelect&&this.select&&this.select.focus&&this.select.focus()}),this._binded=!0)},CUpdateModal.prototype.UpdateStart=function(){this.layer=this.UpdateStart;var self=this,elements=[element("tr",{className:"row"},[element("td",{className:"left"},_("Current version")+":"),element("td",{className:"right",innerHTML:this.curr_info.version+" <span class='grey'>("+this.curr_info.date.toDateString()+")</span>"})]),element("tr",{className:"row"},[element("td",{className:"left"},_("Updating to version")+":"),element("td",{className:"right",innerHTML:this.image_info.version+" <span class='grey'>("+this.image_info.date.toDateString()+")</span>"})]),element("tr",{className:"row"},[element("td",{className:"left"},_("Update status")+":"),this.$status])];this.bpanel.Hidden(this.Info_btn,!0),this.bpanel.Hidden(self.Exit_btn,!0),this._addLog(elements),elements.push(element("tr",{className:"row"},[element("td",{className:"center",colSpan:2},this.ProgressBar.handle)])),this.SetContent(element("table",{className:"cmodal-update"},elements)),this.bpanel.Hidden(this.OK_btn,!0),this.bpanel.Hidden(this.Exit_btn,!0),this.trigger("onShowUpdateStart"),this.OK_func=function(){self.Update.Start(self.update_url),self.$status.innerHtml="",self.$status.classList.remove("error"),self.bpanel.Hidden(this.OK_btn,!0),self.bpanel.Hidden(this.Exit_btn,!0)}},CUpdateModal.prototype.ShowInfoWindow=function(){var $content,modal=new CModalBox(this),self=this;if(modal.SetHeader(_("Change log")),modal.baseClass="cmodal-main image-info-modal",modal.name="CModalImageInfo",modal.bpanel=new CButtonPanel,modal.bpanel.Init(PATH_IMG_SYSTEM+"buttons/"),modal.bpanel.Add(KEYS.EXIT,"exit.png",_("Close"),function(){modal.Show(!1),modal.Free()}),modal.EventHandler=function(event){switch(event.code){case KEYS.UP:$content.parentNode.scrollByLines(-2);break;case KEYS.DOWN:$content.parentNode.scrollByLines(2);break;case KEYS.PAGE_DOWN:$content.parentNode.scrollByPages(1);break;case KEYS.PAGE_UP:$content.parentNode.scrollByPages(-1)}modal.bpanel.EventHandler(event)},modal.SetFooter(modal.bpanel.handle),modal.SetContent(element("div",{className:"image-info-content"},$content=element("div",{className:"info"},_("Information not found")))),modal.Init(),void 0===this.image_info[this.update_url]&&this.update_url){var name=this.update_url.split("/").pop();return void ajax("GET",this.update_url.replace(name,"")+"info/pub/get.php?name="+name+"&lang="+getCurrentLanguage(),function(text,status){self.image_info[self.update_url]=200===status?text:_("Information not found"),$content.innerHTML=self.image_info[self.update_url],modal.Show(!0),$content.focus()})}$content.innerHTML=self.image_info[self.update_url],modal.Show(!0),$content.focus()},Events.inject(CUpdateModal);var TIME_ZONES=[{id:"Pacific/Midway",offset:"-11:00"},{id:"Pacific/Niue",offset:"-11:00"},{id:"Pacific/Pago_Pago",offset:"-11:00",name:"Pacific/Pago Pago"},{id:"Pacific/Samoa",offset:"-11:00"},{id:"US/Samoa",offset:"-11:00"},{id:"America/Adak",offset:"-10:00"},{id:"America/Atka",offset:"-10:00"},{id:"Pacific/Honolulu",offset:"-10:00"},{id:"Pacific/Johnston",offset:"-10:00"},{id:"Pacific/Rarotonga",offset:"-10:00"},{id:"Pacific/Tahiti",offset:"-10:00"},{id:"US/Aleutian",offset:"-10:00"},{id:"US/Hawaii",offset:"-10:00"},{id:"Pacific/Marquesas",offset:"-09:30"},{id:"America/Anchorage",offset:"-09:00"},{id:"America/Juneau",offset:"-09:00"},{id:"America/Nome",offset:"-09:00"},{id:"America/Sitka",offset:"-09:00"},{id:"America/Yakutat",offset:"-09:00"},{id:"Pacific/Gambier",offset:"-09:00"},{id:"US/Alaska",offset:"-09:00"},{id:"America/Dawson",offset:"-08:00"},{id:"America/Ensenada",offset:"-08:00"},{id:"America/Los_Angeles",offset:"-08:00",name:"America/Los Angeles"},{id:"America/Metlakatla",offset:"-08:00"},{id:"America/Santa_Isabel",offset:"-08:00",name:"America/Santa Isabel"},{id:"America/Tijuana",offset:"-08:00"},{id:"America/Vancouver",offset:"-08:00"},{id:"America/Whitehorse",offset:"-08:00"},{id:"Canada/Pacific",offset:"-08:00"},{id:"Canada/Yukon",offset:"-08:00"},{id:"Mexico/BajaNorte",offset:"-08:00"},{id:"Pacific/Pitcairn",offset:"-08:00"},{id:"US/Pacific",offset:"-08:00"},{id:"US/Pacific-New",offset:"-08:00"},{id:"America/Boise",offset:"-07:00"},{id:"America/Cambridge_Bay",offset:"-07:00",name:"America/Cambridge Bay"},{id:"America/Chihuahua",offset:"-07:00"},{id:"America/Creston",offset:"-07:00"},{id:"America/Dawson_Creek",offset:"-07:00",name:"America/Dawson Creek"},{id:"America/Denver",offset:"-07:00"},{id:"America/Edmonton",offset:"-07:00"},{id:"America/Hermosillo",offset:"-07:00"},{id:"America/Inuvik",offset:"-07:00"},{id:"America/Mazatlan",offset:"-07:00"},{id:"America/Ojinaga",offset:"-07:00"},{id:"America/Phoenix",offset:"-07:00"},{id:"America/Shiprock",offset:"-07:00"},{id:"America/Yellowknife",offset:"-07:00"},{id:"Canada/Mountain",offset:"-07:00"},{id:"Mexico/BajaSur",offset:"-07:00"},{id:"Navajo",offset:"-07:00"},{id:"US/Arizona",offset:"-07:00"},{id:"US/Mountain",offset:"-07:00"},{id:"America/Bahia_Banderas",offset:"-06:00",name:"America/Bahia Banderas"},{id:"America/Belize",offset:"-06:00"},{id:"America/Cancun",offset:"-06:00"},{id:"America/Chicago",offset:"-06:00"},{id:"America/Costa_Rica",offset:"-06:00",name:"America/Costa Rica"},{id:"America/El_Salvador",offset:"-06:00",name:"America/El Salvador"},{id:"America/Guatemala",offset:"-06:00"},{id:"America/Indiana/Knox",offset:"-06:00"},{id:"America/Indiana/Tell_City",offset:"-06:00",name:"Indiana/Tell City"},{id:"America/Managua",offset:"-06:00"},{id:"America/Matamoros",offset:"-06:00"},{id:"America/Menominee",offset:"-06:00"},{id:"America/Merida",offset:"-06:00"},{id:"America/Mexico_City",offset:"-06:00",name:"America/Mexico City"},{id:"America/Monterrey",offset:"-06:00"},{id:"America/North_Dakota/Beulah",offset:"-06:00",name:"North Dakota/Beulah"},{id:"America/North_Dakota/Center",offset:"-06:00",name:"North Dakota/Center"},{id:"America/North_Dakota/New_Salem",offset:"-06:00",name:"North Dakota/New Salem"},{id:"America/Rainy_River",offset:"-06:00",name:"America/Rainy River"},{id:"America/Rankin_Inlet",offset:"-06:00",name:"America/Rankin Inlet"},{id:"America/Regina",offset:"-06:00"},{id:"America/Resolute",offset:"-06:00"},{id:"America/Swift_Current",offset:"-06:00",name:"America/Swift Current"},{id:"America/Tegucigalpa",offset:"-06:00"},{id:"America/Winnipeg",offset:"-06:00"},{id:"Canada/Central",offset:"-06:00"},{id:"Canada/East-Saskatchewan",offset:"-06:00"},{id:"Canada/Saskatchewan",offset:"-06:00"},{id:"Chile/EasterIsland",offset:"-06:00"},{id:"Mexico/General",offset:"-06:00"},{id:"Pacific/Easter",offset:"-06:00"},{id:"Pacific/Galapagos",offset:"-06:00"},{id:"US/Central",offset:"-06:00"},{id:"US/Indiana-Starke",offset:"-06:00"},{id:"America/Atikokan",offset:"-05:00"},{id:"America/Bogota",offset:"-05:00"},{id:"America/Cayman",offset:"-05:00"},{id:"America/Coral_Harbour",offset:"-05:00",name:"America/Coral Harbour"},{id:"America/Detroit",offset:"-05:00"},{id:"America/Fort_Wayne",offset:"-05:00",name:"America/Fort Wayne"},{id:"America/Grand_Turk",offset:"-05:00",name:"America/Grand Turk"},{id:"America/Guayaquil",offset:"-05:00"},{id:"America/Havana",offset:"-05:00"},{id:"America/Indiana/Indianapolis",offset:"-05:00"},{id:"America/Indiana/Marengo",offset:"-05:00"},{id:"America/Indiana/Petersburg",offset:"-05:00"},{id:"America/Indiana/Vevay",offset:"-05:00"},{id:"America/Indiana/Vincennes",offset:"-05:00"},{id:"America/Indiana/Winamac",offset:"-05:00"},{id:"America/Indianapolis",offset:"-05:00"},{id:"America/Iqaluit",offset:"-05:00"},{id:"America/Jamaica",offset:"-05:00"},{id:"America/Kentucky/Louisville",offset:"-05:00"},{id:"America/Kentucky/Monticello",offset:"-05:00"},{id:"America/Lima",offset:"-05:00"},{id:"America/Louisville",offset:"-05:00"},{id:"America/Montreal",offset:"-05:00"},{id:"America/Nassau",offset:"-05:00"},{id:"America/New_York",offset:"-05:00",name:"America/New York"},{id:"America/Nipigon",offset:"-05:00"},{id:"America/Panama",offset:"-05:00"},{id:"America/Pangnirtung",offset:"-05:00"},{id:"America/Port-au-Prince",offset:"-05:00"},{id:"America/Porto_Acre",offset:"-05:00",name:"America/Porto Acre"},{id:"America/Rio_Branco",offset:"-05:00",name:"America/Rio Branco"},{id:"America/Thunder_Bay",offset:"-05:00",name:"America/Thunder Bay"},{id:"America/Toronto",offset:"-05:00"},{id:"Brazil/Acre",offset:"-05:00"},{id:"Canada/Eastern",offset:"-05:00"},{id:"Cuba",offset:"-05:00"},{id:"Jamaica",offset:"-05:00"},{id:"US/East-Indiana",offset:"-05:00"},{id:"US/Eastern",offset:"-05:00"},{id:"US/Michigan",offset:"-05:00"},{id:"America/Caracas",offset:"-04:30"},{id:"America/Anguilla",offset:"-04:00"},{id:"America/Antigua",offset:"-04:00"},{id:"America/Aruba",offset:"-04:00"},{id:"America/Asuncion",offset:"-04:00"},{id:"America/Barbados",offset:"-04:00"},{id:"America/Blanc-Sablon",offset:"-04:00"},{id:"America/Boa_Vista",offset:"-04:00",name:"America/Boa Vista"},{id:"America/Campo_Grande",offset:"-04:00",name:"America/Campo Grande"},{id:"America/Cuiaba",offset:"-04:00"},{id:"America/Curacao",offset:"-04:00"},{id:"America/Dominica",offset:"-04:00"},{id:"America/Eirunepe",offset:"-04:00"},{id:"America/Glace_Bay",offset:"-04:00",name:"America/Glace Bay"},{id:"America/Goose_Bay",offset:"-04:00",name:"America/Goose Bay"},{id:"America/Grenada",offset:"-04:00"},{id:"America/Guadeloupe",offset:"-04:00"},{id:"America/Guyana",offset:"-04:00"},{id:"America/Halifax",offset:"-04:00"},{id:"America/Kralendijk",offset:"-04:00"},{id:"America/La_Paz",offset:"-04:00",name:"America/La Paz"},{id:"America/Lower_Princes",offset:"-04:00",name:"America/Lower Princes"},{id:"America/Manaus",offset:"-04:00"},{id:"America/Marigot",offset:"-04:00"},{id:"America/Martinique",offset:"-04:00"},{id:"America/Moncton",offset:"-04:00"},{id:"America/Montserrat",offset:"-04:00"},{id:"America/Port_of_Spain",offset:"-04:00",name:"America/Port of Spain"},{id:"America/Porto_Velho",offset:"-04:00",name:"America/Porto Velho"},{id:"America/Puerto_Rico",offset:"-04:00",name:"America/Puerto Rico"},{id:"America/Santiago",offset:"-04:00"},{id:"America/Santo_Domingo",offset:"-04:00",name:"America/Santo Domingo"},{id:"America/Thule",offset:"-04:00"},{id:"America/Tortola",offset:"-04:00"},{id:"America/Virgin",offset:"-04:00"},{id:"Antarctica/Palmer",offset:"-04:00"},{id:"Atlantic/Bermuda",offset:"-04:00"},{id:"Brazil/West",offset:"-04:00"},{id:"Canada/Atlantic",offset:"-04:00"},{id:"Chile/Continental",offset:"-04:00"},{id:"Canada/Newfoundland",offset:"-03:30"},{id:"America/Araguaina",offset:"-03:00"},{id:"America/Argentina/Buenos_Aires",offset:"-03:00",name:"Argentina/Buenos Aires"},{id:"America/Argentina/Catamarca",offset:"-03:00"},{id:"America/Argentina/Cordoba",offset:"-03:00"},{id:"America/Argentina/Jujuy",offset:"-03:00"},{id:"America/Argentina/La_Rioja",offset:"-03:00",name:"Argentina/La Rioja"},{id:"America/Argentina/Mendoza",offset:"-03:00"},{id:"America/Argentina/Rio_Gallegos",offset:"-03:00",name:"Argentina/Rio Gallegos"},{id:"America/Argentina/Salta",offset:"-03:00"},{id:"America/Argentina/San_Juan",offset:"-03:00",name:"Argentina/San Juan"},{id:"America/Argentina/San_Luis",offset:"-03:00",name:"Argentina/San Luis"},{id:"America/Argentina/Tucuman",offset:"-03:00"},{id:"America/Argentina/Ushuaia",offset:"-03:00"},{id:"America/Bahia",offset:"-03:00"},{id:"America/Belem",offset:"-03:00"},{id:"America/Buenos_Aires",offset:"-03:00",name:"America/Buenos Aires"},{id:"America/Catamarca",offset:"-03:00"},{id:"America/Cayenne",offset:"-03:00"},{id:"America/Cordoba",offset:"-03:00"},{id:"America/Fortaleza",offset:"-03:00"},{id:"America/Godthab",offset:"-03:00"},{id:"America/Jujuy",offset:"-03:00"},{id:"America/Maceio",offset:"-03:00"},{id:"America/Mendoza",offset:"-03:00"},{id:"America/Miquelon",offset:"-03:00"},{id:"America/Montevideo",offset:"-03:00"},{id:"America/Paramaribo",offset:"-03:00"},{id:"America/Recife",offset:"-03:00"},{id:"America/Rosario",offset:"-03:00"},{id:"America/Santarem",offset:"-03:00"},{id:"America/Sao_Paulo",offset:"-03:00",name:"America/Sao Paulo"},{id:"Antarctica/Rothera",offset:"-03:00"},{id:"Atlantic/Stanley",offset:"-03:00"},{id:"Brazil/East",offset:"-03:00"},{id:"America/Noronha",offset:"-02:00"},{id:"Atlantic/South_Georgia",offset:"-02:00",name:"Atlantic/South Georgia"},{id:"Brazil/DeNoronha",offset:"-02:00"},{id:"America/Scoresbysund",offset:"-01:00"},{id:"Atlantic/Azores",offset:"-01:00"},{id:"Atlantic/Cape_Verde",offset:"-01:00",name:"Atlantic/Cape Verde"},{id:"Africa/Accra",offset:"+00:00"},{id:"Africa/Bamako",offset:"+00:00"},{id:"Africa/Banjul",offset:"+00:00"},{id:"Africa/Bissau",offset:"+00:00"},{id:"Africa/Casablanca",offset:"+00:00"},{id:"Africa/Conakry",offset:"+00:00"},{id:"Africa/Dakar",offset:"+00:00"},{id:"Africa/El_Aaiun",offset:"+00:00",name:"Africa/El Aaiun"},{id:"Africa/Freetown",offset:"+00:00"},{id:"Africa/Lome",offset:"+00:00"},{id:"Africa/Monrovia",offset:"+00:00"},{id:"Africa/Nouakchott",offset:"+00:00"},{id:"Africa/Ouagadougou",offset:"+00:00"},{id:"Africa/Sao_Tome",offset:"+00:00",name:"Africa/Sao Tome"},{id:"Africa/Timbuktu",offset:"+00:00"},{id:"America/Danmarkshavn",offset:"+00:00"},{id:"Atlantic/Canary",offset:"+00:00"},{id:"Atlantic/Faeroe",offset:"+00:00"},{id:"Atlantic/Faroe",offset:"+00:00"},{id:"Atlantic/Madeira",offset:"+00:00"},{id:"Atlantic/Reykjavik",offset:"+00:00"},{id:"Eire",offset:"+00:00"},{id:"Europe/Belfast",offset:"+00:00"},{id:"Europe/Dublin",offset:"+00:00"},{id:"Europe/Guernsey",offset:"+00:00"},{id:"Europe/Isle_of_Man",offset:"+00:00",name:"Europe/Isle of Man"},{id:"Europe/Jersey",offset:"+00:00"},{id:"Europe/Lisbon",offset:"+00:00"},{id:"Europe/London",offset:"+00:00"},{id:"Greenwich",offset:"+00:00"},{id:"Iceland",offset:"+00:00"},{id:"Portugal",offset:"+00:00"},{id:"Africa/Algiers",offset:"+01:00"},{id:"Africa/Bangui",offset:"+01:00"},{id:"Africa/Brazzaville",offset:"+01:00"},{id:"Africa/Ceuta",offset:"+01:00"},{id:"Africa/Douala",offset:"+01:00"},{id:"Africa/Kinshasa",offset:"+01:00"},{id:"Africa/Lagos",offset:"+01:00"},{id:"Africa/Libreville",offset:"+01:00"},{id:"Africa/Luanda",offset:"+01:00"},{id:"Africa/Malabo",offset:"+01:00"},{id:"Africa/Ndjamena",offset:"+01:00"},{id:"Africa/Niamey",offset:"+01:00"},{id:"Africa/Porto-Novo",offset:"+01:00"},{id:"Africa/Tunis",offset:"+01:00"},{id:"Africa/Windhoek",offset:"+01:00"},{id:"Arctic/Longyearbyen",offset:"+01:00"},{id:"Atlantic/Jan_Mayen",offset:"+01:00",name:"Atlantic/Jan Mayen"},{id:"Europe/Amsterdam",offset:"+01:00"},{id:"Europe/Andorra",offset:"+01:00"},{id:"Europe/Belgrade",offset:"+01:00"},{id:"Europe/Berlin",offset:"+01:00"},{id:"Europe/Bratislava",offset:"+01:00"},{id:"Europe/Brussels",offset:"+01:00"},{id:"Europe/Budapest",offset:"+01:00"},{id:"Europe/Copenhagen",offset:"+01:00"},{id:"Europe/Gibraltar",offset:"+01:00"},{id:"Europe/Ljubljana",offset:"+01:00"},{id:"Europe/Luxembourg",offset:"+01:00"},{id:"Europe/Madrid",offset:"+01:00"},{id:"Europe/Malta",offset:"+01:00"},{id:"Europe/Monaco",offset:"+01:00"},{id:"Europe/Oslo",offset:"+01:00"},{id:"Europe/Paris",offset:"+01:00"},{id:"Europe/Podgorica",offset:"+01:00"},{id:"Europe/Prague",offset:"+01:00"},{id:"Europe/Rome",offset:"+01:00"},{id:"Europe/San_Marino",offset:"+01:00",name:"Europe/San Marino"},{id:"Europe/Sarajevo",offset:"+01:00"},{id:"Europe/Skopje",offset:"+01:00"},{id:"Europe/Stockholm",offset:"+01:00"},{id:"Europe/Tirane",offset:"+01:00"},{id:"Europe/Vaduz",offset:"+01:00"},{id:"Europe/Vatican",offset:"+01:00"},{id:"Europe/Vienna",offset:"+01:00"},{id:"Europe/Warsaw",offset:"+01:00"},{id:"Europe/Zagreb",offset:"+01:00"},{id:"Europe/Zurich",offset:"+01:00"},{id:"Poland",offset:"+01:00"},{id:"Africa/Blantyre",offset:"+02:00"},{id:"Africa/Bujumbura",offset:"+02:00"},{id:"Africa/Cairo",offset:"+02:00"},{id:"Africa/Gaborone",offset:"+02:00"},{id:"Africa/Harare",offset:"+02:00"},{id:"Africa/Johannesburg",offset:"+02:00"},{id:"Africa/Kigali",offset:"+02:00"},{id:"Africa/Lubumbashi",offset:"+02:00"},{id:"Africa/Lusaka",offset:"+02:00"},{id:"Africa/Maputo",offset:"+02:00"},{id:"Africa/Maseru",offset:"+02:00"},{id:"Africa/Mbabane",offset:"+02:00"},{id:"Africa/Tripoli",offset:"+02:00"},{id:"Asia/Amman",offset:"+02:00"},{id:"Asia/Beirut",offset:"+02:00"},{id:"Asia/Damascus",offset:"+02:00"},{id:"Asia/Gaza",offset:"+02:00"},{id:"Asia/Hebron",offset:"+02:00"},{id:"Asia/Istanbul",offset:"+02:00"},{id:"Asia/Jerusalem",offset:"+02:00"},{id:"Asia/Nicosia",offset:"+02:00"},{id:"Asia/Tel_Aviv",offset:"+02:00",name:"Asia/Tel Aviv"},{id:"Egypt",offset:"+02:00"},{id:"Europe/Athens",offset:"+02:00"},{id:"Europe/Bucharest",offset:"+02:00"},{id:"Europe/Chisinau",offset:"+02:00"},{id:"Europe/Helsinki",offset:"+02:00"},{id:"Europe/Istanbul",offset:"+02:00"},{id:"Europe/Kiev",offset:"+02:00"},{id:"Europe/Mariehamn",offset:"+02:00"},{id:"Europe/Nicosia",offset:"+02:00"},{id:"Europe/Riga",offset:"+02:00"},{id:"Europe/Simferopol",offset:"+02:00"},{id:"Europe/Sofia",offset:"+02:00"},{id:"Europe/Tallinn",offset:"+02:00"},{id:"Europe/Tiraspol",offset:"+02:00"},{id:"Europe/Uzhgorod",offset:"+02:00"},{id:"Europe/Vilnius",offset:"+02:00"},{id:"Europe/Zaporozhye",offset:"+02:00"},{id:"Israel",offset:"+02:00"},{id:"Libya",offset:"+02:00"},{id:"Turkey",offset:"+02:00"},{id:"Africa/Addis_Ababa",offset:"+03:00",name:"Africa/Addis Ababa"},{id:"Africa/Asmara",offset:"+03:00"},{id:"Africa/Asmera",offset:"+03:00"},{id:"Africa/Dar_es_Salaam",offset:"+03:00",name:"Africa/Dar es Salaam"},{id:"Africa/Djibouti",offset:"+03:00"},{id:"Africa/Juba",offset:"+03:00"},{id:"Africa/Kampala",offset:"+03:00"},{id:"Africa/Khartoum",offset:"+03:00"},{id:"Africa/Mogadishu",offset:"+03:00"},{id:"Africa/Nairobi",offset:"+03:00"},{id:"Antarctica/Syowa",offset:"+03:00"},{id:"Asia/Aden",offset:"+03:00"},{id:"Asia/Baghdad",offset:"+03:00"},{id:"Asia/Bahrain",offset:"+03:00"},{id:"Asia/Kuwait",offset:"+03:00"},{id:"Asia/Qatar",offset:"+03:00"},{id:"Asia/Riyadh",offset:"+03:00"},{id:"Europe/Kaliningrad",offset:"+03:00"},{id:"Europe/Minsk",offset:"+03:00"},{id:"Indian/Antananarivo",offset:"+03:00"},{id:"Indian/Comoro",offset:"+03:00"},{id:"Indian/Mayotte",offset:"+03:00"},{id:"Asia/Tehran",offset:"+03:30"},{id:"Iran",offset:"+03:30"},{id:"Asia/Baku",offset:"+04:00"},{id:"Asia/Dubai",offset:"+04:00"},{id:"Asia/Muscat",offset:"+04:00"},{id:"Asia/Tbilisi",offset:"+04:00"},{id:"Asia/Yerevan",offset:"+04:00"},{id:"Europe/Moscow",offset:"+04:00"},{id:"Europe/Samara",offset:"+04:00"},{id:"Europe/Volgograd",offset:"+04:00"},{id:"Indian/Mahe",offset:"+04:00"},{id:"Indian/Mauritius",offset:"+04:00"},{id:"Indian/Reunion",offset:"+04:00"},{id:"Asia/Kabul",offset:"+04:30"},{id:"Antarctica/Davis",offset:"+05:00"},{id:"Antarctica/Mawson",offset:"+05:00"},{id:"Asia/Aqtau",offset:"+05:00"},{id:"Asia/Aqtobe",offset:"+05:00"},{id:"Asia/Ashgabat",offset:"+05:00"},{id:"Asia/Ashkhabad",offset:"+05:00"},{id:"Asia/Dushanbe",offset:"+05:00"},{id:"Asia/Karachi",offset:"+05:00"},{id:"Asia/Oral",offset:"+05:00"},{id:"Asia/Samarkand",offset:"+05:00"},{id:"Asia/Tashkent",offset:"+05:00"},{id:"Indian/Kerguelen",offset:"+05:00"},{id:"Indian/Maldives",offset:"+05:00"},{id:"Asia/Calcutta",offset:"+05:30"},{id:"Asia/Colombo",offset:"+05:30"},{id:"Asia/Kolkata",offset:"+05:30"},{id:"Asia/Kathmandu",offset:"+05:45"},{id:"Asia/Katmandu",offset:"+05:45"},{id:"Antarctica/Vostok",offset:"+06:00"},{id:"Asia/Almaty",offset:"+06:00"},{id:"Asia/Bishkek",offset:"+06:00"},{id:"Asia/Dacca",offset:"+06:00"},{id:"Asia/Dhaka",offset:"+06:00"},{id:"Asia/Qyzylorda",offset:"+06:00"},{id:"Asia/Thimbu",offset:"+06:00"},{id:"Asia/Thimphu",offset:"+06:00"},{id:"Asia/Yekaterinburg",offset:"+06:00"},{id:"Indian/Chagos",offset:"+06:00"},{id:"Asia/Rangoon",offset:"+06:30"},{id:"Indian/Cocos",offset:"+06:30"},{id:"Asia/Bangkok",offset:"+07:00"},{id:"Asia/Ho_Chi_Minh",offset:"+07:00",name:"Asia/Ho Chi Minh"},{id:"Asia/Hovd",offset:"+07:00"},{id:"Asia/Jakarta",offset:"+07:00"},{id:"Asia/Novokuznetsk",offset:"+07:00"},{id:"Asia/Novosibirsk",offset:"+07:00"},{id:"Asia/Omsk",offset:"+07:00"},{id:"Asia/Phnom_Penh",offset:"+07:00",name:"Asia/Phnom Penh"},{id:"Asia/Pontianak",offset:"+07:00"},{id:"Asia/Saigon",offset:"+07:00"},{id:"Asia/Vientiane",offset:"+07:00"},{id:"Indian/Christmas",offset:"+07:00"},{id:"Asia/Brunei",offset:"+08:00"},{id:"Asia/Choibalsan",offset:"+08:00"},{id:"Asia/Chongqing",offset:"+08:00"},{id:"Asia/Chungking",offset:"+08:00"},{id:"Asia/Harbin",offset:"+08:00"},{id:"Asia/Hong_Kong",offset:"+08:00",name:"Asia/Hong Kong"},{id:"Asia/Kashgar",offset:"+08:00"},{id:"Asia/Krasnoyarsk",offset:"+08:00"},{id:"Asia/Kuala_Lumpur",offset:"+08:00",name:"Asia/Kuala Lumpur"},{id:"Asia/Kuching",offset:"+08:00"},{id:"Asia/Macao",offset:"+08:00"},{id:"Asia/Macau",offset:"+08:00"},{id:"Asia/Makassar",offset:"+08:00"},{id:"Asia/Manila",offset:"+08:00"},{id:"Asia/Shanghai",offset:"+08:00"},{id:"Asia/Singapore",offset:"+08:00"},{id:"Asia/Taipei",offset:"+08:00"},{id:"Asia/Ujung_Pandang",offset:"+08:00",name:"Asia/Ujung Pandang"},{id:"Asia/Ulaanbaatar",offset:"+08:00"},{id:"Asia/Ulan_Bator",offset:"+08:00",name:"Asia/Ulan Bator"},{id:"Asia/Urumqi",offset:"+08:00"},{id:"Australia/Perth",offset:"+08:00"},{id:"Australia/West",offset:"+08:00"},{id:"Hongkong",offset:"+08:00"},{id:"Singapore",offset:"+08:00"},{id:"Australia/Eucla",offset:"+08:45"},{id:"Asia/Dili",offset:"+09:00"},{id:"Asia/Irkutsk",offset:"+09:00"},{id:"Asia/Jayapura",offset:"+09:00"},{id:"Asia/Pyongyang",offset:"+09:00"},{id:"Asia/Seoul",offset:"+09:00"},{id:"Asia/Tokyo",offset:"+09:00"},{id:"Japan",offset:"+09:00"},{id:"Pacific/Palau",offset:"+09:00"},{id:"Australia/Adelaide",offset:"+09:30"},{id:"Australia/Broken_Hill",offset:"+09:30",name:"Australia/Broken Hill"},{id:"Australia/Darwin",offset:"+09:30"},{id:"Australia/North",offset:"+09:30"},{id:"Australia/South",offset:"+09:30"},{id:"Australia/Yancowinna",offset:"+09:30"},{id:"Antarctica/DumontDUrville",offset:"+10:00"},{id:"Asia/Yakutsk",offset:"+10:00"},{id:"Australia/Brisbane",offset:"+10:00"},{id:"Australia/Canberra",offset:"+10:00"},{id:"Australia/Currie",offset:"+10:00"},{id:"Australia/Hobart",offset:"+10:00"},{id:"Australia/Lindeman",offset:"+10:00"},{id:"Australia/Melbourne",offset:"+10:00"},{id:"Australia/NSW",offset:"+10:00"},{id:"Australia/Queensland",offset:"+10:00"},{id:"Australia/Sydney",offset:"+10:00"},{id:"Australia/Tasmania",offset:"+10:00"},{id:"Australia/Victoria",offset:"+10:00"},{id:"Pacific/Chuuk",offset:"+10:00"},{id:"Pacific/Guam",offset:"+10:00"},{id:"Pacific/Port_Moresby",offset:"+10:00",name:"Pacific/Port Moresby"},{id:"Pacific/Saipan",offset:"+10:00"},{id:"Pacific/Truk",offset:"+10:00"},{id:"Pacific/Yap",offset:"+10:00"},{id:"Australia/LHI",offset:"+10:30"},{id:"Australia/Lord_Howe",offset:"+10:30",name:"Australia/Lord Howe"},{id:"Antarctica/Casey",offset:"+11:00"},{id:"Antarctica/Macquarie",offset:"+11:00"},{id:"Asia/Sakhalin",offset:"+11:00"},{id:"Asia/Vladivostok",offset:"+11:00"},{id:"Pacific/Efate",offset:"+11:00"},{id:"Pacific/Guadalcanal",offset:"+11:00"},{id:"Pacific/Kosrae",offset:"+11:00"},{id:"Pacific/Noumea",offset:"+11:00"},{id:"Pacific/Pohnpei",offset:"+11:00"},{id:"Pacific/Ponape",offset:"+11:00"},{id:"Pacific/Norfolk",offset:"+11:30"},{id:"Antarctica/McMurdo",offset:"+12:00"},{id:"Antarctica/South_Pole",offset:"+12:00",name:"Antarctica/South Pole"},{id:"Asia/Anadyr",offset:"+12:00"},{id:"Asia/Kamchatka",offset:"+12:00"},{id:"Asia/Magadan",offset:"+12:00"},{id:"Kwajalein",offset:"+12:00"},{id:"Pacific/Auckland",offset:"+12:00"},{id:"Pacific/Fiji",offset:"+12:00"},{id:"Pacific/Funafuti",offset:"+12:00"},{id:"Pacific/Kwajalein",offset:"+12:00"},{id:"Pacific/Majuro",offset:"+12:00"},{id:"Pacific/Nauru",offset:"+12:00"},{id:"Pacific/Tarawa",offset:"+12:00"},{id:"Pacific/Wake",offset:"+12:00"},{id:"Pacific/Wallis",offset:"+12:00"},{id:"Pacific/Chatham",offset:"+12:45"},{id:"Pacific/Apia",offset:"+13:00"},{id:"Pacific/Enderbury",offset:"+13:00"},{id:"Pacific/Fakaofo",offset:"+13:00"},{id:"Pacific/Tongatapu",offset:"+13:00"},{id:"Pacific/Kiritimati",offset:"+14:00"}],keyboards={ru:[["ru","en"],["en","ru"]],uk:[["uk","en"],["en","uk"]],en:[["en","en"]],de:[["de","en"],["en","de"]],es:[["es","en"],["en","es"]],codes:["ru","uk","en","de"],index:0},main_lang=getCurrentLanguage(),butDisable=!1,portals={},butUdDownDisable=!1,to_save="",back_function=function(){},save_function=function(){},back_element=[],back_index=0,wifi_load_variation=0,scroll_position=0,update_conf=!1,update_url="",reload={device:!1,portal:!1},timer={},checkInp=1,STB_MODE_STANDBY=!1,sett_changes=0,OK_key=null,AuraHD_ID="AuraHD",MODEL_TYPE=gSTB.GetDeviceModelExt(),STORAGE_INFO=[],layoutOrderChanged=!1,layoutsString="",reloadEnvironment=!1,saveError=!1,as={page:0,pages:{MAIN:0,LIST:1,INFO:2,ELEMENTS:3,WIFI:4,UPDATE:5},page_list:{0:"main_page",1:"list_page",2:"info_page",3:"elements_page",4:"wifi_page",5:"update_page"},list:0,lists:{main:0,lan:1}},list={main:[],lan:[],servers:[],lan_wired:[],lan_pppoe:[],lan_wifi:[],lanInfo:[],footers:[]},sett_changes=0,model=gSTB.RDir("Model"),currCPage,SettingsPage;currCPage=SettingsPage=new CPage;var stbEvent={onEvent:function(){},onMessage:function(from,message,data){this.trigger(message,{from:from,data:data})},onBroadcastMessage:function(from,message,data){echo(message,"onBroadcastMessage"),this.trigger("broadcast."+message,{from:from,data:data})},event:0};Events.inject(stbEvent),stbEvent.bind("broadcast.storage.mount",function(){echo("broadcast.storage.mount in portal"),"function"==typeof currCPage.onMountAction?currCPage.onMountAction(!0):(echo("default settings USB MOUNTED action"),UpdatePage.RefreshUsbDevices()),setTimeout(function(){new CModalHint(currCPage,_("USB storage is connected"),3e3)},0)}),stbEvent.bind("broadcast.storage.unmount",function(){echo("broadcast.storage.unmount in portal"),"function"==typeof currCPage.onMountAction?currCPage.onMountAction(!1):(echo("default settings USB UNMOUNTED action"),UpdatePage.RefreshUsbDevices())}),SettingsPage.onInit=function(){this.BCrumbHandler=document.querySelector(".page.main .cbcrumb"),this.BCrumbHandler.style.display="block",this.BCrumb=new CBreadCrumb,this.BCrumb.Init(PATH_IMG_SYSTEM+"settings/",this.BCrumbHandler,10,10),this.EventHandler=navigation.pressKey,stbStorage.getItem(getWindowKey(WINDOWS.SYSTEM_SETTINGS))||stbStorage.setItem(getWindowKey(WINDOWS.SYSTEM_SETTINGS),stbWebWindow.windowId()),this.bpanel=new CButtonPanel(this),this.bpanel.Init(PATH_IMG_SYSTEM+"buttons/",document.querySelector(".body .footer div.cbpanel-main")),this.bpanel.AdditionalBtn=this.bpanel.Add(KEYS.F1,"f1.png",_("More"),function(){navigation.f1_press()},!1),this.bpanel.VolumeUp=this.bpanel.Add(KEYS.VOLUME_UP,"volume_plus.png",_("Up"),function(){},!1),this.bpanel.VolumeDown=this.bpanel.Add(KEYS.VOLUME_DOWN,"volume_minus.png",_("Down"),function(){},!1),this.bpanel.SaveBtn=this.bpanel.Add(KEYS.OK,"ok.png",_("Save"),function(code){"function"==typeof navigation.elements[navigation.element].onchange&&navigation.elements[navigation.element].onchange();var event={code:code};switch(as.page){case as.pages.UPDATE:UpdatePage.EventHandler(event);break;case as.pages.ELEMENTS:navigation.save(),"advSet"===SettingsPage.BCrumb.Tip().iid?(advSet_load(),setTimeout(saved_ok_msg,4)):"servers_portals"!==SettingsPage.BCrumb.Tip().iid&&saved_ok_msg();break;case as.pages.INFO:event.preventDefault();break;default:navigation.elements[navigation.element].onclick(),event.preventDefault()}},!1),this.Show(!0)},window.onload=function(){echo("starting","Settings"),window.moveTo(0,0),window.resizeTo(EMULATION?window.outerWidth:screen.width,EMULATION?window.outerHeight:screen.height),window.oncontextmenu=EMULATION?null:function(){return!1},gSTB.EnableServiceButton(!0),gSTB.EnableVKButton(!0);var imageList=["back.png","exit.png","f1.png","f3.png","f4.png","info.png","menu.png","ok.png","refresh.png"].map(function(image){return PATH_IMG_SYSTEM+"buttons/"+image});imageList=imageList.concat(["device_info.png","folder.png","folder_lan.png","folder_network_info.png","folder_refresh.png","folder_servers.png","folder_serversset.png","folder_settings.png","folder_keyboard_layout.png","folder_sound.png","folder_tv.png","refresh.png","reset.png","signal1.png","signal2.png","signal3.png","signal4.png","switch.png","switch_act.png","settings.png","device_reset.png","user_clear.png"].map(function(image){return PATH_IMG_SYSTEM+"settings/"+image})),imageList=imageList.concat(["bottommenu_bg.png","exit_wrapper_bg.png","topmenu_bg.png"].map(function(image){return PATH_IMG_SYSTEM+"backgrounds/"+image})),imageList=imageList.concat(["bg_black_50.png"].map(function(image){return PATH_ROOT+"system/img/backgrounds/"+image})),imageLoader(imageList,function(){gettext.init({name:main_lang},function(){init_menu(),echo("ready","Settings"),document.body.style.display="block"})})};var UpdatePage={Init:function(){var self=this,update_types=[{value:0,title:_("HTTP")},{value:1,title:_("USB")}];
Update.CheckUpdateByMulticast()&&update_types.push({value:2,title:_("Multicast")}),Update.CheckUpdateByTFTP()&&update_types.push({value:3,title:_("TFTP")}),this.web_update_url=gSTB.GetDefaultUpdateUrl(),this.UpdateModal=new CUpdateModal(SettingsPage,{log:!0,select:!1,update_url:this.web_update_url,info:!1,header_text:_("Software update")}),this.name="UpdatePage",this.$page=document.getElementById("update_page"),this.$elements=this.$page.getElementsByClassName("type"),this.$page.getElementsByClassName("update_type_title")[0].innerHTML=_("Update method:"),this.$update_type=document.getElementById("update_type"),this.$type_select=new CSelectBox(SettingsPage,{content:this.$page.getElementsByClassName("update_type")[0],data:update_types,nameField:"title",idField:"value",style:"elements",events:{onChange:function(){switch(this.GetValue()){case 0:self.ShowWeb();break;case 1:self.ShowUsb();break;case 2:self.ShowMulticast();break;case 3:self.ShowTFTP()}}}}),Array.prototype.forEach.call(this.$page.getElementsByClassName("item"),function($item){$item.onmouseover=function($item){return function(){self.Navigation.SetActive($item)}}($item)}),this.$web_update_url=document.getElementById("web_update_url"),this.$input_web_url=this.$web_update_url.getElementsByClassName("update_url")[0],this.$usb_device=document.getElementById("usb_device"),this.$usb_device.getElementsByClassName("title")[0].innerHTML=_("Disk:"),this.$usb_device_select=new CSelectBox(SettingsPage,{content:this.$usb_device.getElementsByClassName("usb_device_select")[0],nameField:"title",idField:"value",style:"elements",data:[{value:-1,title:_("No disk found")}]}),this.$usb_update_url=document.getElementById("usb_update_url"),this.$usb_update_url.getElementsByClassName("title")[0].innerHTML=_("Path:"),this.$usb_device_update_url=this.$usb_update_url.getElementsByClassName("usb_device_update_url")[0],this.usb_update_url="/"+model.toLowerCase()+"/imageupdate",this.$usb_device_update_url.value=this.usb_update_url,this.RefreshUsbDevices(),this.ShowWeb()},RefreshUsbDevices:function(){getStorageInfo();var i,data=[];if(STORAGE_INFO.length>0)for(i=0;i<STORAGE_INFO.length;i++)data.push({value:STORAGE_INFO[i].mountPath,title:STORAGE_INFO[i].label});else data=[{value:-1,title:_("No disk found")}];this.$usb_device_select.SetData(data)},Navigation:{MoveUp:function(){var next=this.FindNext(-1);void 0!==next&&this.SetActive(next)},MoveDown:function(){var next=this.FindNext(1);void 0!==next&&this.SetActive(next)},SetActive:function(active){this.$active&&this.$active.classList.remove("active"),this.$active=active;var input=this.$active.getElementsByClassName("elements")[0];void 0===input?this.$active.focus():input.focus(),this.$active.classList.add("active")},FindNext:function(direction){for(var pointer=this.$active;pointer=1===direction?pointer.nextElementSibling:pointer.previousElementSibling;)if("none"!==pointer.style.display)return pointer}},onError:function(errorStr,logStr,status){new CModalHint(SettingsPage,errorStr,2e3),this.UpdateModal.Update.trigger("onError",{errorMessage:errorStr,logMessage:logStr,status:status})},EventHandler:function(event){switch(event.code){case KEYS.UP:this.Navigation.MoveUp(),event.preventDefault();break;case KEYS.DOWN:this.Navigation.MoveDown(),event.preventDefault();break;case KEYS.OK:this.validate_function()}"usb_device"===this.Navigation.$active.id?this.$usb_device_select.EventHandler(event):"update_type"===this.Navigation.$active.id&&this.$type_select.EventHandler(event)},Show:function(show){show===!1?load_main():((this.number||0==this.number)&&(back_element[back_index]=this.number,back_index++,back_element[back_index]=0),document.getElementById(as.page_list[as.page]).style.display="none",this.UpdateModal.update_url=this.$input_web_url.value=this.web_update_url,this.$page.style.display="block",as.page=as.pages.UPDATE,SettingsPage.BCrumb.Push("","refresh.png",_("Software update")),back_function=load_main,this.Navigation.SetActive(this.$update_type),this.GenerateFooter())},ShowWeb:function(){var self=this;this.ShowElements("web"),this.validate_function=function(){return URLC(self.UpdateModal.update_url=self.$input_web_url.value)?void self.UpdateModal.Show(!0):void this.onError(_("Incorrect URL"),"Incorrect URL",28)}},ShowUsb:function(){var self=this;this.ShowElements("usb"),this.validate_function=function(){return-1==self.$usb_device_select.GetValue()?void this.onError(_("USB device not found!"),"USB device not found!",29):(self.UpdateModal.update_url=self.$usb_device_select.GetValue()+self.$usb_device_update_url.value,void self.UpdateModal.Show(!0))}},ShowMulticast:function(){this.ShowElements("multicast"),this.validate_function=function(){new CModalConfirm(SettingsPage,_("Warning"),_("<span class='alert'>Warning!</span> The device will be rebooted and updated automatically."),_("Cancel"),function(){this.Show(!1)},_("Update"),function(){Update.StartMulticast(2e3)?new CModalHint(SettingsPage,_("Starting update..."),!1,!0):new CModalHint(SettingsPage,_("Some error occurred. Please, contact your operator."),!1)})}},ShowTFTP:function(){this.ShowElements("tftp"),this.validate_function=function(){new CModalConfirm(SettingsPage,_("Warning"),_("<span class='alert'>Warning!</span> The device will be rebooted and updated automatically."),_("Cancel"),function(){this.Show(!1)},_("Update"),function(){Update.StartTFTP(2e3)?new CModalHint(SettingsPage,_("Starting update..."),!1,!0):new CModalHint(SettingsPage,_("Some error occurred. Please, contact your operator."),!1)})}},ShowElements:function(elements){Array.prototype.forEach.call(this.$elements,function(element){element.style.display=element.classList.contains(elements)?"table":"none"})},GenerateFooter:function(){SettingsPage.bpanel.Rename(SettingsPage.bpanel.SaveBtn,_("Verify")),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!1)},RefreshPage:function(){this.UpdateModal=new CUpdateModal(SettingsPage,{log:!0,select:!1,update_url:this.web_update_url,info:!1,header_text:_("Software update")}),this.$page.getElementsByClassName("update_type_title")[0].innerHTML=_("Update method:"),this.$usb_device.getElementsByClassName("title")[0].innerHTML=_("Disk:"),this.$usb_update_url.getElementsByClassName("title")[0].innerHTML=_("Path:");var update_types=[{value:0,title:_("HTTP")},{value:1,title:_("USB")}];Update.CheckUpdateByMulticast()&&update_types.push({value:2,title:_("Multicast")}),Update.CheckUpdateByTFTP()&&update_types.push({value:3,title:_("TFTP")}),this.$type_select.SetData(update_types),0===STORAGE_INFO.length&&this.$usb_device_select.SetData([{value:-1,title:_("No disk found")}])}},navigation={element:0,sub_element:0,elements:[],pre_elements:[],oldClass:"",reloadPortalsLoader:!1,down:{480:4,576:5,720:5,1080:5},down_wifi:{480:7,576:9,720:9,1080:9},pressKey:function(event){if(eventPrepare(event,!1,"keypress.js pressKey")&&(echo("keypress.js pressKey"),echo(butDisable,"butDisable: "),!(document.activeElement.component instanceof CSimpleSelect&&(document.activeElement.component.EventHandler(event),event.stopped===!0)))){switch(event.code){case KEYS.OK:if("checkbox"===navigation.elements[navigation.element].type){if("function"==typeof navigation.elements[navigation.element].onchange&&navigation.elements[navigation.element].onchange(),0!==sett_changes)if(navigation.save(),"advSet"===SettingsPage.BCrumb.Tip().iid)advSet_load(),setTimeout(saved_ok_msg,4);else{if("keyboard_layout"===SettingsPage.BCrumb.Tip().iid)break;saved_ok_msg()}else layoutOrderChanged&&"keyboard_layout"===SettingsPage.BCrumb.Tip().iid&&navigation.save();event.preventDefault();break}if(0===as.page&&0===navigation.element){navigation.elements[navigation.element].onclick(),event.preventDefault();break}this.bpanel.EventHandler(event);break;case KEYS.F1:this.bpanel.EventHandler(event);break;case KEYS.EXIT:navigation.exit_press()}switch(as.page){case as.pages.UPDATE:UpdatePage.EventHandler(event);break;case as.pages.MAIN:var active=navigation.elements[navigation.element],itemHeight=active.offsetHeight;switch(event.code){case KEYS.UP:if(echo("UP"),event.preventDefault(),navigation.element-2<0)break;navigation.elements[navigation.element].className=navigation.oldClass,navigation.element-=2,Math.floor(navigation.element/2)*itemHeight<active.parentNode.scrollTop&&(active.parentNode.scrollTop=active.parentNode.scrollTop-navigation.down[WINDOW_HEIGHT]*itemHeight),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus();break;case KEYS.DOWN:if(event.preventDefault(),navigation.element+2>=navigation.elements.length)break;navigation.elements[navigation.element].className=navigation.oldClass,navigation.element+=2,active.offsetTop-active.parentNode.scrollTop>=(navigation.down[WINDOW_HEIGHT]-1)*itemHeight&&(active.parentNode.scrollTop=active.parentNode.scrollTop+navigation.down[WINDOW_HEIGHT]*itemHeight),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus();break;case KEYS.LEFT:navigation.elements[navigation.element].className=navigation.oldClass,navigation.element-=1,navigation.element<=0&&(navigation.element=0),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),event.preventDefault();break;case KEYS.RIGHT:navigation.elements[navigation.element].className=navigation.oldClass,navigation.element+=1,navigation.element>=navigation.elements.length&&(navigation.element=navigation.elements.length-1),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),event.preventDefault();break;case KEYS.PAGE_DOWN:navigation.elements[navigation.element].className=navigation.oldClass,navigation.element+=2*navigation.down[WINDOW_HEIGHT],navigation.element>=navigation.elements.length&&(navigation.element=navigation.elements.length-1),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),event.preventDefault();break;case KEYS.PAGE_UP:navigation.elements[navigation.element].className=navigation.oldClass,navigation.element-=2*navigation.down[WINDOW_HEIGHT],navigation.element<0&&(navigation.element=0),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),event.preventDefault()}break;case as.pages.LIST:if(void 0===navigation.elements[0])break;switch(event.code){case KEYS.UP:if(event.preventDefault(),navigation.element-1<0)break;navigation.elements[navigation.element].className=navigation.oldClass,navigation.element-=1,navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus();break;case KEYS.DOWN:if(event.preventDefault(),navigation.element+1>=navigation.elements.length)break;navigation.elements[navigation.element].className=navigation.oldClass,navigation.element+=1,navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus();break;case KEYS.PAGE_DOWN:navigation.elements[navigation.element].className=navigation.oldClass,navigation.element+=navigation.down_wifi[WINDOW_HEIGHT],navigation.element>=navigation.elements.length&&(navigation.element=navigation.elements.length-1),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),event.preventDefault();break;case KEYS.PAGE_UP:navigation.elements[navigation.element].className=navigation.oldClass,navigation.element-=navigation.down_wifi[WINDOW_HEIGHT],navigation.element<0&&(navigation.element=0),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),event.preventDefault()}break;case as.pages.ELEMENTS:if(void 0===navigation.elements[0])break;navigation.element||(navigation.element=0);var active=navigation.pre_elements[navigation.element],itemHeight=active.offsetHeight;switch(event.code){case KEYS.UP:if(event.preventDefault(),butUdDownDisable)break;if(navigation.element-1<0)break;var prev=navigation.pre_elements[navigation.element-1];if(prev&&"none"===prev.style.display)break;navigation.sub_element=0,navigation.pre_elements[navigation.element].className=navigation.oldClass,navigation.element-=1,navigation.element*itemHeight<active.parentNode.scrollTop&&(active.parentNode.scrollTop=active.parentNode.scrollTop-navigation.down[WINDOW_HEIGHT]*itemHeight),navigation.oldClass=navigation.pre_elements[navigation.element].className,navigation.pre_elements[navigation.element].className+=" active",navigation.pre_elements[navigation.element].focus(),navigation.elements[navigation.element].focus(),"keyboard_layout"===SettingsPage.BCrumb.Tip().iid&&(navigation.element!==navigation.elements.length-1&&(SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,!1),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,!1)),0===navigation.element&&(SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,!0),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,!1)));break;case KEYS.DOWN:event.preventDefault();var next=navigation.pre_elements[navigation.element+1];if(butUdDownDisable)break;if(navigation.element+1>=navigation.elements.length||void 0!==next&&"none"===next.style.display)break;navigation.sub_element=0,navigation.pre_elements[navigation.element].className=navigation.oldClass,navigation.element+=1,active.offsetTop-active.parentNode.scrollTop>=(navigation.down[WINDOW_HEIGHT]-1)*itemHeight&&(active.parentNode.scrollTop=active.parentNode.scrollTop+navigation.down[WINDOW_HEIGHT]*itemHeight),navigation.oldClass=navigation.pre_elements[navigation.element].className,navigation.pre_elements[navigation.element].className+=" active",navigation.pre_elements[navigation.element].focus(),navigation.elements[navigation.element].focus(),"keyboard_layout"===SettingsPage.BCrumb.Tip().iid&&(0!==navigation.element&&(SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,!1),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,!1)),navigation.element===navigation.elements.length-1&&(SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,!1),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,!0)));break;case KEYS.LEFT:switch(navigation.elements[navigation.element].tagName.toLowerCase()){case"input":if(new RegExp("check").test(navigation.elements[navigation.element].className)){event.preventDefault(),check_input_left();break}if(new RegExp("arrow").test(navigation.elements[navigation.element].className)){event.preventDefault(),spec_input_left();break}if(new RegExp("sub_elements").test(navigation.elements[navigation.element].className)){event.preventDefault(),navigation.sub_element>0&&navigation.sub_element--,document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements"+navigation.element)[navigation.sub_element].focus();break}"checkbox"==navigation.elements[navigation.element].type&&(navigation.elements[navigation.element].checked=!0)}"function"==typeof navigation.elements[navigation.element].onchange&&navigation.elements[navigation.element].onchange();break;case KEYS.RIGHT:switch(navigation.elements[navigation.element].tagName.toLowerCase()){case"input":if(new RegExp("check").test(navigation.elements[navigation.element].className)){event.preventDefault(),check_input_right();break}if(new RegExp("arrow").test(navigation.elements[navigation.element].className)){event.preventDefault(),spec_input_right();break}if(new RegExp("sub_elements").test(navigation.elements[navigation.element].className)){event.preventDefault(),navigation.sub_element<3&&navigation.sub_element++,document.getElementById(as.page_list[as.page]).getElementsByClassName("sub_elements"+navigation.element)[navigation.sub_element].focus();break}"checkbox"==navigation.elements[navigation.element].type&&(navigation.elements[navigation.element].checked=!1)}"function"==typeof navigation.elements[navigation.element].onchange&&navigation.elements[navigation.element].onchange();break;case KEYS.PAGE_UP:case KEYS.PAGE_DOWN:navigation.pre_elements[navigation.element].className=navigation.oldClass,navigation.element+=navigation.down[WINDOW_HEIGHT]*(event.code===KEYS.PAGE_UP?-1:1),navigation.element<0?navigation.element=0:navigation.element>navigation.elements.length&&(navigation.element=navigation.elements.length-1),active.parentNode.scrollTop+=(event.code===KEYS.PAGE_UP?-1:1)*navigation.down[WINDOW_HEIGHT]*itemHeight,navigation.oldClass=navigation.pre_elements[navigation.element].className,navigation.pre_elements[navigation.element].className+=" active",navigation.pre_elements[navigation.element].focus(),navigation.elements[navigation.element].focus(),event.preventDefault();break;case KEYS.VOLUME_UP:if("keyboard_layout"===SettingsPage.BCrumb.Tip().iid){var parentDiv=document.getElementById("elements_page").firstChild,listRow=parentDiv.getElementsByClassName("item"),currentLayouts="";if(0!==navigation.element){parentDiv.insertBefore(listRow[navigation.element],listRow[navigation.element-1]),navigation.element-=1,navigation.elements=parentDiv.getElementsByClassName("elements"),navigation.elements[navigation.element].focus();for(var i=0;i<navigation.elements.length;i++)currentLayouts+=navigation.elements[i].code;echo(currentLayouts,"** ** currentLayouts 1 ** **"),currentLayouts!==layoutsString?(layoutOrderChanged=!0,SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!1)):(layoutOrderChanged=!1,0===sett_changes?SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!0):SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!1)),currentLayouts=""}navigation.element!==listRow.length-1&&(SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,!1),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,!1)),0===navigation.element&&(SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,!0),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,!1))}break;case KEYS.VOLUME_DOWN:if("keyboard_layout"===SettingsPage.BCrumb.Tip().iid){var parentDiv=document.getElementById("elements_page").firstChild,listRow=parentDiv.getElementsByClassName("item"),currentLayouts="";if(navigation.element!==listRow.length-1){listRow[navigation.element+1].parentNode.insertBefore(listRow[navigation.element],listRow[navigation.element+1].nextSibling),navigation.element+=1,navigation.elements=parentDiv.getElementsByClassName("elements"),navigation.elements[navigation.element].focus();for(var i=0;i<navigation.elements.length;i++)currentLayouts+=navigation.elements[i].code;echo(currentLayouts,"** ** currentLayouts 2 ** **"),currentLayouts!==layoutsString?(layoutOrderChanged=!0,SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!1)):(layoutOrderChanged=!1,0===sett_changes?SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!0):SettingsPage.bpanel.Hidden(SettingsPage.bpanel.SaveBtn,!1)),currentLayouts=""}0!==navigation.element&&(SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,!1),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,!1)),navigation.element===listRow.length-1&&(SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeUp,!1),SettingsPage.bpanel.Hidden(SettingsPage.bpanel.VolumeDown,!0))}break;case KEYS.CHANNEL_NEXT:case KEYS.CHANNEL_PREV:event.preventDefault()}break;case as.pages.WIFI:switch(event.code){case KEYS.UP:if(event.preventDefault(),navigation.element-1<0)break;navigation.elements[navigation.element].className=navigation.oldClass,navigation.element-=1,navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),navigation.wifi_auch.innerHTML=_("Authentication method:")+" "+read.result[navigation.element].auth,navigation.wifi_encrypt.innerHTML=_("Encryption:")+" "+read.result[navigation.element].enc;break;case KEYS.DOWN:if(event.preventDefault(),navigation.element+1>=navigation.elements.length)break;navigation.elements[navigation.element].className=navigation.oldClass,navigation.element+=1,navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),navigation.wifi_auch.innerHTML=_("Authentication method:")+" "+read.result[navigation.element].auth,navigation.wifi_encrypt.innerHTML=_("Encryption:")+" "+read.result[navigation.element].enc;break;case KEYS.PAGE_DOWN:navigation.elements[navigation.element].className=navigation.oldClass,navigation.element+=navigation.down[imgPath],navigation.element>=navigation.elements.length&&(navigation.element=navigation.elements.length-1),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),navigation.wifi_auch.innerHTML=_("Authentication method:")+" "+read.result[navigation.element].auth,navigation.wifi_encrypt.innerHTML=_("Encryption:")+" "+read.result[navigation.element].enc,event.preventDefault();break;case KEYS.PAGE_UP:navigation.elements[navigation.element].className=navigation.oldClass,navigation.element-=navigation.down[imgPath],navigation.element<0&&(navigation.element=0),navigation.oldClass=navigation.elements[navigation.element].className,navigation.elements[navigation.element].className+=" active",navigation.elements[navigation.element].focus(),navigation.wifi_auch.innerHTML=_("Authentication method:")+" "+read.result[navigation.element].auth,navigation.wifi_encrypt.innerHTML=_("Encryption:")+" "+read.result[navigation.element].enc,event.preventDefault()}break;case as.pages.INFO:switch(event.code){case KEYS.PAGE_DOWN:break;case KEYS.PAGE_UP:}break;default:event.preventDefault()}}},exit:function(){if(reload.device)return void new CModalConfirm(SettingsPage,_("Confirm"),_("You have changed some settings.<br>Device reboot is required to apply new settings.<br>Reboot now?"),_("Cancel"),function(){stbStorage.removeItem(getWindowKey(WINDOWS.SYSTEM_SETTINGS)),stbWebWindow.close()},_("Ok"),reboot_confirm);if(reload.portal)return void new CModalConfirm(SettingsPage,_("Confirmation"),_("You have changes some settings.<br>Reboot portal is required to apply settings.<br>Reboot now?"),_("Cancel"),function(){stbStorage.removeItem(getWindowKey(WINDOWS.SYSTEM_SETTINGS)),stbWebWindow.close()},_("Ok"),reload_confirm);var portalsLoaderWinId=stbStorage.getItem(getWindowKey(WINDOWS.PORTALS_LOADER));navigation.reloadPortalsLoader&&portalsLoaderWinId&&(echo("reload portals loader page"),gSTB.LoadURL(PATH_SYSTEM+"pages/loader/index.html")),stbStorage.removeItem(getWindowKey(WINDOWS.SYSTEM_SETTINGS)),stbWebWindow.close()},exit_press:function(){if(as.page===as.pages.MAIN){if(reloadEnvironment){var portalWinId=parseInt(getWindowIdByName(WINDOWS.PORTAL));portalWinId&&stbWebWindow.messageSend(portalWinId,"environment.reload","")}navigation.exit()}else 0!==sett_changes&&void 0!==sett_changes||layoutOrderChanged?myConfirm(_("Some settings have been changed"),function(){navigation.save(),navigation.back(),"advSet"===SettingsPage.BCrumb.Tip().iid?setTimeout(saved_ok_msg,4):saved_ok_msg()},function(){"advSet"===SettingsPage.BCrumb.Tip().iid?gettext.init({name:main_lang},function(){advSet_load.new_lang=null,navigation.back()}):setTimeout(navigation.back,0)}):(clearTimeout(timer.checkLR),clearTimeout(timer.backClass),navigation.back())},back:function(){sett_changes=0,layoutOrderChanged=!1,as.page!=as.pages.MAIN&&"servers_additional_portals"!==SettingsPage.BCrumb.Tip().iid&&(back_element[back_index]=0,back_index--,navigation.element=back_element[back_index]),"advSet"!==SettingsPage.BCrumb.Tip().iid&&SettingsPage.BCrumb.Pop(),back_function()},save:function(){save_function(),saveError?saveError=!1:(sett_changes=0,reloadEnvironment=!0)},f1_press:function(){("servers_portals"!==SettingsPage.BCrumb.Tip().iid||new RegExp(AuraHD_ID).test(MODEL_TYPE))&&(0!==sett_changes&&void 0!==sett_changes?myConfirm(_("Some settings have been changed"),function(){navigation.save(),navigation.switch_load_page(),"advSet"===SettingsPage.BCrumb.Tip().iid?setTimeout(saved_ok_msg,4):saved_ok_msg()},function(){"advSet"===SettingsPage.BCrumb.Tip().iid&&(advSet_load.new_lang=null,advSet_load()),navigation.switch_load_page()}):navigation.switch_load_page())},switch_load_page:function(){switch(SettingsPage.BCrumb.Tip().iid){case"video":video_additionally_load();break;case"audio":audio_additionally_load();break;case"advSet":advSet_additionally_load();break;case"servers_portals":servers_additional_portals_load()}}};